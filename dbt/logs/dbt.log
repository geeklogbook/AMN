[0m01:10:44.497313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fa12eaf00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fa192dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fa2ea6db0>]}


============================== 01:10:44.534580 | 82e91968-3421-49b1-ae3e-707e2aa82752 ==============================
[0m01:10:44.534580 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:10:44.539575 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:10:44.590047 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'my_profile'
[0m01:10:44.620826 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.42649108, "process_in_blocks": "72", "process_kernel_time": 0.832458, "process_mem_max_rss": "87300", "process_out_blocks": "1464", "process_user_time": 6.53931}
[0m01:10:44.626744 [debug] [MainThread]: Command `dbt run` failed at 01:10:44.626160 after 0.43 seconds
[0m01:10:44.641252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fa1705520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fa11cca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fa11cc5f0>]}
[0m01:10:44.644588 [debug] [MainThread]: Flushing usage events
[0m01:10:45.592447 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:21:04.536603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc79252c620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc79030bda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc79030bdd0>]}


============================== 01:21:04.552645 | 041fb3b5-b713-436c-aed3-a919b98eaec6 ==============================
[0m01:21:04.552645 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:21:04.558422 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:21:04.580447 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'my_profile'
[0m01:21:04.589861 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.3491737, "process_in_blocks": "8056", "process_kernel_time": 0.319823, "process_mem_max_rss": "85812", "process_out_blocks": "0", "process_user_time": 3.727948}
[0m01:21:04.595791 [debug] [MainThread]: Command `dbt run` failed at 01:21:04.595310 after 0.36 seconds
[0m01:21:04.601073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc78f976b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc78fd675f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc78f68a7b0>]}
[0m01:21:04.604607 [debug] [MainThread]: Flushing usage events
[0m01:21:05.520562 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:27:15.167818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9b3b3a390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9b1d39dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9b1d39df0>]}


============================== 01:27:15.194724 | 47a09854-25ff-4065-af27-bd274a1ca0f2 ==============================
[0m01:27:15.194724 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:27:15.231231 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:27:15.262396 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'my_profile'
[0m01:27:15.289537 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.73893803, "process_in_blocks": "0", "process_kernel_time": 0.43905, "process_mem_max_rss": "86004", "process_out_blocks": "0", "process_user_time": 4.729776}
[0m01:27:15.309590 [debug] [MainThread]: Command `dbt run` failed at 01:27:15.309080 after 0.76 seconds
[0m01:27:15.312722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9b23d6e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9b1d3b9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9b1c58ce0>]}
[0m01:27:15.326017 [debug] [MainThread]: Flushing usage events
[0m01:27:16.081507 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:42:11.507422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8a5294620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8a2a96210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8a4444320>]}


============================== 01:42:11.513258 | 84f7636b-5936-4699-9c8a-5485b2d20ff5 ==============================
[0m01:42:11.513258 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:42:11.515257 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:42:11.523664 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'my_profile'
[0m01:42:11.526714 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.14184962, "process_in_blocks": "8032", "process_kernel_time": 0.158733, "process_mem_max_rss": "86240", "process_out_blocks": "0", "process_user_time": 1.825439}
[0m01:42:11.528395 [debug] [MainThread]: Command `dbt run` failed at 01:42:11.528207 after 0.14 seconds
[0m01:42:11.529964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8a25059d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8a2ace240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8a26a6060>]}
[0m01:42:11.531825 [debug] [MainThread]: Flushing usage events
[0m01:42:12.268335 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:48:40.706664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f775c311520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f775d7e27b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f775cc7b8c0>]}


============================== 01:48:40.751021 | 275d3a72-76d1-4df9-91d1-3ec5a82dc9d4 ==============================
[0m01:48:40.751021 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:48:40.757450 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:48:40.784830 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'my_profile'
[0m01:48:40.796290 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.41660592, "process_in_blocks": "24", "process_kernel_time": 0.708716, "process_mem_max_rss": "87348", "process_out_blocks": "1464", "process_user_time": 6.228719}
[0m01:48:40.807457 [debug] [MainThread]: Command `dbt run` failed at 01:48:40.806911 after 0.43 seconds
[0m01:48:40.814244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f775d7e27b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f775c4b5880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f775dbf38c0>]}
[0m01:48:40.818899 [debug] [MainThread]: Flushing usage events
[0m01:48:41.640509 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:58:46.666190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e1ed68d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e1ec073b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e1ed68770>]}


============================== 01:58:46.690594 | c48121db-4025-4ee3-a050-2fb2a09a1a23 ==============================
[0m01:58:46.690594 [info ] [MainThread]: Running with dbt=1.9.0
[0m01:58:46.699824 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:58:47.037189 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m01:58:47.051038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c48121db-4025-4ee3-a050-2fb2a09a1a23', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e1e8f2990>]}
[0m01:58:47.656718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c48121db-4025-4ee3-a050-2fb2a09a1a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e1e7dbdd0>]}
[0m01:58:48.030225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c48121db-4025-4ee3-a050-2fb2a09a1a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e1f418920>]}
[0m01:58:48.035741 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:58:48.334620 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m01:58:48.341731 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:58:48.344232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c48121db-4025-4ee3-a050-2fb2a09a1a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e1e7fa540>]}
[0m01:58:50.704305 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project
[0m01:58:50.722939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c48121db-4025-4ee3-a050-2fb2a09a1a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e1e9937a0>]}
[0m01:58:50.965777 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m01:58:50.979366 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m01:58:51.048900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c48121db-4025-4ee3-a050-2fb2a09a1a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e1ccc53a0>]}
[0m01:58:51.052385 [info ] [MainThread]: Found 429 macros
[0m01:58:51.055317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c48121db-4025-4ee3-a050-2fb2a09a1a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e1ce31e50>]}
[0m01:58:51.060527 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:58:51.065823 [debug] [MainThread]: Command end result
[0m01:58:51.136398 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m01:58:51.145327 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m01:58:51.156699 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m01:58:51.159154 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.8622975, "process_in_blocks": "0", "process_kernel_time": 1.004094, "process_mem_max_rss": "98948", "process_out_blocks": "136", "process_user_time": 8.735619}
[0m01:58:51.161153 [debug] [MainThread]: Command `dbt run` succeeded at 01:58:51.160917 after 4.86 seconds
[0m01:58:51.162745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e21585e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e1f3b59a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e208cc410>]}
[0m01:58:51.164270 [debug] [MainThread]: Flushing usage events
[0m01:58:51.868348 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:02:52.556169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe711ee780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe70c97b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe714fee10>]}


============================== 02:02:52.620708 | 19c4f0cf-f89e-48c7-aa63-9c0bbc717f23 ==============================
[0m02:02:52.620708 [info ] [MainThread]: Running with dbt=1.9.0
[0m02:02:52.632052 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:02:53.750944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19c4f0cf-f89e-48c7-aa63-9c0bbc717f23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe70a82510>]}
[0m02:02:54.034194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19c4f0cf-f89e-48c7-aa63-9c0bbc717f23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe713809e0>]}
[0m02:02:54.040124 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m02:02:54.354292 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m02:02:54.566437 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m02:02:54.577202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '19c4f0cf-f89e-48c7-aa63-9c0bbc717f23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe70fa44a0>]}
[0m02:02:56.757552 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project
[0m02:02:56.775825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19c4f0cf-f89e-48c7-aa63-9c0bbc717f23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe6f103290>]}
[0m02:02:56.915742 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m02:02:56.928705 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m02:02:56.983753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19c4f0cf-f89e-48c7-aa63-9c0bbc717f23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe6edd9370>]}
[0m02:02:56.986152 [info ] [MainThread]: Found 429 macros
[0m02:02:56.988618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19c4f0cf-f89e-48c7-aa63-9c0bbc717f23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe6f102f30>]}
[0m02:02:56.994480 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m02:02:56.997857 [debug] [MainThread]: Command end result
[0m02:02:57.080410 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m02:02:57.091558 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m02:02:57.106049 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m02:02:57.109808 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.8526435, "process_in_blocks": "0", "process_kernel_time": 0.820353, "process_mem_max_rss": "99968", "process_out_blocks": "1600", "process_user_time": 9.544112}
[0m02:02:57.112388 [debug] [MainThread]: Command `dbt run` succeeded at 02:02:57.112123 after 4.86 seconds
[0m02:02:57.114684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe70e52660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe7098e930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe6f16d430>]}
[0m02:02:57.116977 [debug] [MainThread]: Flushing usage events
[0m02:02:57.852205 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:15:06.551690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8bf6adb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8bfc1bc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8bf6adcd0>]}


============================== 02:15:06.567346 | 3300e413-6482-4c53-85bd-b589d861f683 ==============================
[0m02:15:06.567346 [info ] [MainThread]: Running with dbt=1.9.0
[0m02:15:06.572361 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:15:07.493019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3300e413-6482-4c53-85bd-b589d861f683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8c0f434a0>]}
[0m02:15:07.825329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3300e413-6482-4c53-85bd-b589d861f683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8bf6db7d0>]}
[0m02:15:07.832304 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m02:15:08.179321 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m02:15:08.356905 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m02:15:08.360382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3300e413-6482-4c53-85bd-b589d861f683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8bd7374a0>]}
[0m02:15:10.660994 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project
[0m02:15:10.678984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3300e413-6482-4c53-85bd-b589d861f683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8bd758fe0>]}
[0m02:15:10.799726 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m02:15:10.809809 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m02:15:10.845713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3300e413-6482-4c53-85bd-b589d861f683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8bd773fb0>]}
[0m02:15:10.848062 [info ] [MainThread]: Found 429 macros
[0m02:15:10.850531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3300e413-6482-4c53-85bd-b589d861f683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8bd73a5a0>]}
[0m02:15:10.856290 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m02:15:10.859165 [debug] [MainThread]: Command end result
[0m02:15:10.925162 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m02:15:10.935812 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m02:15:10.953391 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m02:15:10.957557 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.8278055, "process_in_blocks": "11248", "process_kernel_time": 0.809045, "process_mem_max_rss": "98932", "process_out_blocks": "0", "process_user_time": 10.183861}
[0m02:15:10.959952 [debug] [MainThread]: Command `dbt run` succeeded at 02:15:10.959682 after 4.83 seconds
[0m02:15:10.961844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8bfafa480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8bf2638c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8bfdffd40>]}
[0m02:15:10.963848 [debug] [MainThread]: Flushing usage events
[0m02:15:11.704844 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:10:19.797336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb203b65ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2043b6db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb203b65e80>]}


============================== 10:10:19.813010 | 76604bdf-f15c-441c-86a3-c3d2d6503099 ==============================
[0m10:10:19.813010 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:10:19.821624 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m10:10:21.831161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76604bdf-f15c-441c-86a3-c3d2d6503099', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2045e4fb0>]}
[0m10:10:22.456596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76604bdf-f15c-441c-86a3-c3d2d6503099', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2049dbe00>]}
[0m10:10:22.464886 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:10:23.116954 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m10:10:24.309687 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m10:10:24.322673 [debug] [MainThread]: Partial parsing: added file: amn_dbt://models/profit_and_margin.sql
[0m10:10:24.328510 [debug] [MainThread]: Partial parsing: added file: amn_dbt://models/least_profitability.sql
[0m10:10:25.796179 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.amn_dbt.profit_and_margin' (models/profit_and_margin.sql) depends on a node named 'Sales' which was not found
[0m10:10:25.807715 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.551073, "process_in_blocks": "101512", "process_kernel_time": 1.28442, "process_mem_max_rss": "99076", "process_out_blocks": "0", "process_user_time": 10.14178}
[0m10:10:25.814945 [debug] [MainThread]: Command `dbt run` failed at 10:10:25.814391 after 6.56 seconds
[0m10:10:25.818260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2046fc800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2021015e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2039cdbb0>]}
[0m10:10:25.828090 [debug] [MainThread]: Flushing usage events
[0m10:10:26.600691 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:20:30.507884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8b708e6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8b6c58ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8b6664860>]}


============================== 10:20:30.522193 | cadc75b1-48af-4dd4-a905-a29defe0f6c5 ==============================
[0m10:20:30.522193 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:20:30.528177 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:20:31.625811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cadc75b1-48af-4dd4-a905-a29defe0f6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8b6dbd5e0>]}
[0m10:20:31.934640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cadc75b1-48af-4dd4-a905-a29defe0f6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8b65255e0>]}
[0m10:20:31.951799 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:20:32.373358 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m10:20:32.649211 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:20:32.652926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cadc75b1-48af-4dd4-a905-a29defe0f6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8b4c2ec60>]}
[0m10:20:35.768210 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.amn_dbt.least_profitability' (models/least_profitability.sql) depends on a node named 'sales' which was not found
[0m10:20:35.772038 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.6733317, "process_in_blocks": "0", "process_kernel_time": 0.787291, "process_mem_max_rss": "101252", "process_out_blocks": "0", "process_user_time": 8.510722}
[0m10:20:35.775530 [debug] [MainThread]: Command `dbt run` failed at 10:20:35.775117 after 5.68 seconds
[0m10:20:35.777924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8b7114920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8b4bff500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8b64fd5e0>]}
[0m10:20:35.780152 [debug] [MainThread]: Flushing usage events
[0m10:20:36.673320 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:25:37.888656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4716ff30e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47153c4500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4715545460>]}


============================== 10:25:37.900928 | 1d503c36-6bfe-4e02-8a9d-1cac3a2e4bca ==============================
[0m10:25:37.900928 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:25:37.905715 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:25:38.771704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d503c36-6bfe-4e02-8a9d-1cac3a2e4bca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4716d27410>]}
[0m10:25:39.099309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d503c36-6bfe-4e02-8a9d-1cac3a2e4bca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4715f29730>]}
[0m10:25:39.104261 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:25:39.516315 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m10:25:39.807292 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:25:39.816782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1d503c36-6bfe-4e02-8a9d-1cac3a2e4bca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47155a4080>]}
[0m10:25:43.432473 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.amn_dbt.profit_and_margin' (models/profit_and_margin.sql) depends on a node named 'purchase_prices' which was not found
[0m10:25:43.437995 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.845397, "process_in_blocks": "0", "process_kernel_time": 0.568102, "process_mem_max_rss": "99176", "process_out_blocks": "0", "process_user_time": 9.288976}
[0m10:25:43.441546 [debug] [MainThread]: Command `dbt run` failed at 10:25:43.440902 after 5.85 seconds
[0m10:25:43.444748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f471563eff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f471368ed80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f471359ef00>]}
[0m10:25:43.449221 [debug] [MainThread]: Flushing usage events
[0m10:25:44.213394 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:34:56.707412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f638b6cc3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f638b0344a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f638b098aa0>]}


============================== 10:34:56.718431 | 6e4db555-fc4f-42ad-ae76-e70b0271d1f2 ==============================
[0m10:34:56.718431 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:34:56.725482 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:34:57.783193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e4db555-fc4f-42ad-ae76-e70b0271d1f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6389582ba0>]}
[0m10:34:58.182789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e4db555-fc4f-42ad-ae76-e70b0271d1f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f638b39f5c0>]}
[0m10:34:58.194689 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:34:58.511342 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m10:34:58.694603 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:34:58.702778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6e4db555-fc4f-42ad-ae76-e70b0271d1f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f638b39fe30>]}
[0m10:35:02.318738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e4db555-fc4f-42ad-ae76-e70b0271d1f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63891ef320>]}
[0m10:35:02.480313 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m10:35:02.489757 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m10:35:02.541162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e4db555-fc4f-42ad-ae76-e70b0271d1f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f638930cb30>]}
[0m10:35:02.543023 [info ] [MainThread]: Found 4 models, 429 macros
[0m10:35:02.545199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e4db555-fc4f-42ad-ae76-e70b0271d1f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6389165ee0>]}
[0m10:35:02.552557 [info ] [MainThread]: 
[0m10:35:02.554785 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:35:02.557054 [info ] [MainThread]: 
[0m10:35:02.560224 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:35:02.577684 [debug] [ThreadPool]: Acquiring new postgres connection 'list_amn_datawarehouse'
[0m10:35:02.672122 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse"
[0m10:35:02.674180 [debug] [ThreadPool]: On list_amn_datawarehouse: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse"} */

    select distinct nspname from pg_namespace
  
[0m10:35:02.675836 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:35:02.693935 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "postgresql-data" (172.20.0.3), port 5432 failed: FATAL:  database "amn_datawarehouse" does not exist

[0m10:35:02.705360 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse"} */

    select distinct nspname from pg_namespace
  
[0m10:35:02.707710 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m10:35:02.710564 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m10:35:02.712701 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m10:35:02.714471 [debug] [ThreadPool]: On list_amn_datawarehouse: No close available on handle
[0m10:35:02.716574 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:35:02.717852 [debug] [MainThread]: Connection 'list_amn_datawarehouse' was properly closed.
[0m10:35:02.719202 [info ] [MainThread]: 
[0m10:35:02.720940 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:35:02.724178 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "postgresql-data" (172.20.0.3), port 5432 failed: FATAL:  database "amn_datawarehouse" does not exist
  
[0m10:35:02.727980 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.4769588, "process_in_blocks": "6240", "process_kernel_time": 0.478932, "process_mem_max_rss": "110596", "process_out_blocks": "0", "process_user_time": 10.167342}
[0m10:35:02.731388 [debug] [MainThread]: Command `dbt run` failed at 10:35:02.730852 after 6.48 seconds
[0m10:35:02.733750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f638b614fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f638926aa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6389528f50>]}
[0m10:35:02.735552 [debug] [MainThread]: Flushing usage events
[0m10:35:03.461438 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:42:46.276424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f129fe36b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f129fe36ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f129fe36ba0>]}


============================== 10:42:46.312256 | 630faf40-0a27-4f83-863e-70d00842e482 ==============================
[0m10:42:46.312256 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:42:46.325060 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:42:47.246837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '630faf40-0a27-4f83-863e-70d00842e482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12a010fb90>]}
[0m10:42:47.629751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '630faf40-0a27-4f83-863e-70d00842e482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f129f25ab70>]}
[0m10:42:47.637042 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:42:48.005445 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m10:42:48.413570 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:42:48.415388 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:42:48.494424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '630faf40-0a27-4f83-863e-70d00842e482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f129da35520>]}
[0m10:42:48.764140 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m10:42:48.783002 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m10:42:48.839742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '630faf40-0a27-4f83-863e-70d00842e482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f129d7ec5c0>]}
[0m10:42:48.843076 [info ] [MainThread]: Found 4 models, 429 macros
[0m10:42:48.846496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '630faf40-0a27-4f83-863e-70d00842e482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f129d912570>]}
[0m10:42:48.855450 [info ] [MainThread]: 
[0m10:42:48.858980 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:42:48.862446 [info ] [MainThread]: 
[0m10:42:48.868774 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:42:48.897292 [debug] [ThreadPool]: Acquiring new postgres connection 'list_amn_datawarehouse'
[0m10:42:49.078784 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse"
[0m10:42:49.096010 [debug] [ThreadPool]: On list_amn_datawarehouse: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse"} */

    select distinct nspname from pg_namespace
  
[0m10:42:49.101850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:42:49.138997 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "postgresql-data" (172.20.0.3), port 5432 failed: FATAL:  database "amn_datawarehouse" does not exist

[0m10:42:49.166816 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse"} */

    select distinct nspname from pg_namespace
  
[0m10:42:49.173532 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m10:42:49.178575 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m10:42:49.185174 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m10:42:49.188753 [debug] [ThreadPool]: On list_amn_datawarehouse: No close available on handle
[0m10:42:49.194594 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:42:49.198579 [debug] [MainThread]: Connection 'list_amn_datawarehouse' was properly closed.
[0m10:42:49.201635 [info ] [MainThread]: 
[0m10:42:49.206433 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m10:42:49.211165 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "postgresql-data" (172.20.0.3), port 5432 failed: FATAL:  database "amn_datawarehouse" does not exist
  
[0m10:42:49.221606 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.3473456, "process_in_blocks": "0", "process_kernel_time": 0.600244, "process_mem_max_rss": "105188", "process_out_blocks": "0", "process_user_time": 7.092892}
[0m10:42:49.229084 [debug] [MainThread]: Command `dbt run` failed at 10:42:49.228477 after 3.36 seconds
[0m10:42:49.235862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f129f43f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f129d7e56d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f129d9125a0>]}
[0m10:42:49.245878 [debug] [MainThread]: Flushing usage events
[0m10:42:50.067675 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:47:00.243503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7be63e900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7bdb6c560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7bde08350>]}


============================== 10:47:00.260106 | 43d181a6-316b-4ae4-8935-9591a4dba7df ==============================
[0m10:47:00.260106 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:47:00.272585 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m10:47:01.508146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43d181a6-316b-4ae4-8935-9591a4dba7df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7bd8b2d80>]}
[0m10:47:01.908324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43d181a6-316b-4ae4-8935-9591a4dba7df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7bd7daf90>]}
[0m10:47:01.913071 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:47:02.203964 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m10:47:02.608120 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:47:02.610340 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:47:02.716000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43d181a6-316b-4ae4-8935-9591a4dba7df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7bbf65310>]}
[0m10:47:02.987374 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m10:47:03.005396 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m10:47:03.095742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43d181a6-316b-4ae4-8935-9591a4dba7df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7bbd188f0>]}
[0m10:47:03.099098 [info ] [MainThread]: Found 4 models, 429 macros
[0m10:47:03.103570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43d181a6-316b-4ae4-8935-9591a4dba7df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7bbf657f0>]}
[0m10:47:03.113445 [info ] [MainThread]: 
[0m10:47:03.118292 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:47:03.121802 [info ] [MainThread]: 
[0m10:47:03.126336 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:47:03.147574 [debug] [ThreadPool]: Acquiring new postgres connection 'list_amn_datawarehouse'
[0m10:47:03.264102 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse"
[0m10:47:03.266316 [debug] [ThreadPool]: On list_amn_datawarehouse: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse"} */

    select distinct nspname from pg_namespace
  
[0m10:47:03.268732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:47:03.284390 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "postgresql-data" (172.20.0.2), port 5432 failed: FATAL:  database "amn_datawarehouse" does not exist

[0m10:47:03.306889 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse"} */

    select distinct nspname from pg_namespace
  
[0m10:47:03.311737 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m10:47:03.315027 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m10:47:03.318288 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m10:47:03.321561 [debug] [ThreadPool]: On list_amn_datawarehouse: No close available on handle
[0m10:47:03.325209 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:47:03.328246 [debug] [MainThread]: Connection 'list_amn_datawarehouse' was properly closed.
[0m10:47:03.331705 [info ] [MainThread]: 
[0m10:47:03.335846 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m10:47:03.341486 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "postgresql-data" (172.20.0.2), port 5432 failed: FATAL:  database "amn_datawarehouse" does not exist
  
[0m10:47:03.347520 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.7316215, "process_in_blocks": "0", "process_kernel_time": 0.631597, "process_mem_max_rss": "105176", "process_out_blocks": "0", "process_user_time": 7.529041}
[0m10:47:03.353027 [debug] [MainThread]: Command `dbt run` failed at 10:47:03.352489 after 3.74 seconds
[0m10:47:03.357712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7bd88cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7bd8258b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7bbe43f80>]}
[0m10:47:03.362056 [debug] [MainThread]: Flushing usage events
[0m10:47:04.118425 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:53:16.915252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a523fbb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a52e03c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a52e03140>]}


============================== 10:53:16.938593 | 3638cc67-3285-4fe8-bc84-ca245d073196 ==============================
[0m10:53:16.938593 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:53:16.945137 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m10:53:18.106152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3638cc67-3285-4fe8-bc84-ca245d073196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a527048c0>]}
[0m10:53:18.439669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3638cc67-3285-4fe8-bc84-ca245d073196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a522dad80>]}
[0m10:53:18.457122 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:53:18.835389 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m10:53:19.560964 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:53:19.564343 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:53:19.805560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3638cc67-3285-4fe8-bc84-ca245d073196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a508e8050>]}
[0m10:53:20.239118 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m10:53:20.279288 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m10:53:20.376410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3638cc67-3285-4fe8-bc84-ca245d073196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a50669850>]}
[0m10:53:20.380026 [info ] [MainThread]: Found 4 models, 429 macros
[0m10:53:20.385821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3638cc67-3285-4fe8-bc84-ca245d073196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a50715070>]}
[0m10:53:20.397397 [info ] [MainThread]: 
[0m10:53:20.407091 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:53:20.414319 [info ] [MainThread]: 
[0m10:53:20.439929 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:53:20.497232 [debug] [ThreadPool]: Acquiring new postgres connection 'list_amn_datawarehouse'
[0m10:53:20.810579 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse"
[0m10:53:20.812775 [debug] [ThreadPool]: On list_amn_datawarehouse: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse"} */

    select distinct nspname from pg_namespace
  
[0m10:53:20.814696 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:24.143113 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "postgresql-data" to address: Name or service not known

[0m10:53:27.441785 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse"} */

    select distinct nspname from pg_namespace
  
[0m10:53:27.446538 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m10:53:27.450215 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m10:53:27.453146 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m10:53:27.456284 [debug] [ThreadPool]: On list_amn_datawarehouse: No close available on handle
[0m10:53:27.461274 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:53:27.464153 [debug] [MainThread]: Connection 'list_amn_datawarehouse' was properly closed.
[0m10:53:27.466418 [info ] [MainThread]: 
[0m10:53:27.470529 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 7.03 seconds (7.03s).
[0m10:53:27.478181 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "postgresql-data" to address: Name or service not known
  
[0m10:53:27.484877 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.824073, "process_in_blocks": "1456", "process_kernel_time": 0.875476, "process_mem_max_rss": "103876", "process_out_blocks": "1600", "process_user_time": 9.99672}
[0m10:53:27.489678 [debug] [MainThread]: Command `dbt run` failed at 10:53:27.489025 after 10.83 seconds
[0m10:53:27.494165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a52374cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a52098f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a508e89e0>]}
[0m10:53:27.500592 [debug] [MainThread]: Flushing usage events
[0m10:53:28.263977 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:55:30.759770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae2bfe8440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae2bacbc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae2c24b440>]}


============================== 10:55:30.779094 | 09f23bce-7fe5-4ca8-8a95-e5a324a7e663 ==============================
[0m10:55:30.779094 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:55:30.788233 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:55:31.642196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09f23bce-7fe5-4ca8-8a95-e5a324a7e663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae2bd41df0>]}
[0m10:55:31.928673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09f23bce-7fe5-4ca8-8a95-e5a324a7e663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae2b9b6300>]}
[0m10:55:31.937067 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:55:32.290626 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m10:55:32.680761 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:55:32.682839 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:55:32.755254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09f23bce-7fe5-4ca8-8a95-e5a324a7e663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae29f0e630>]}
[0m10:55:32.970337 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m10:55:32.983180 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m10:55:33.026628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09f23bce-7fe5-4ca8-8a95-e5a324a7e663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae29bf8470>]}
[0m10:55:33.029488 [info ] [MainThread]: Found 4 models, 429 macros
[0m10:55:33.032359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09f23bce-7fe5-4ca8-8a95-e5a324a7e663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae2c3e05c0>]}
[0m10:55:33.039961 [info ] [MainThread]: 
[0m10:55:33.042640 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:55:33.045488 [info ] [MainThread]: 
[0m10:55:33.050192 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:55:33.071681 [debug] [ThreadPool]: Acquiring new postgres connection 'list_amn_datawarehouse'
[0m10:55:33.202551 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse"
[0m10:55:33.204057 [debug] [ThreadPool]: On list_amn_datawarehouse: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse"} */

    select distinct nspname from pg_namespace
  
[0m10:55:33.205705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:55:33.233001 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.027 seconds
[0m10:55:33.238440 [debug] [ThreadPool]: On list_amn_datawarehouse: Close
[0m10:55:33.245287 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_amn_datawarehouse, now list_amn_datawarehouse_public)
[0m10:55:33.266413 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m10:55:33.268776 [debug] [ThreadPool]: On list_amn_datawarehouse_public: BEGIN
[0m10:55:33.271194 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:55:33.290906 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m10:55:33.293713 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m10:55:33.296212 [debug] [ThreadPool]: On list_amn_datawarehouse_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse_public"} */
select
      'amn_datawarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:55:33.306260 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m10:55:33.312308 [debug] [ThreadPool]: On list_amn_datawarehouse_public: ROLLBACK
[0m10:55:33.314706 [debug] [ThreadPool]: On list_amn_datawarehouse_public: Close
[0m10:55:33.333653 [debug] [MainThread]: Using postgres connection "master"
[0m10:55:33.335538 [debug] [MainThread]: On master: BEGIN
[0m10:55:33.337155 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:55:33.351527 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m10:55:33.354002 [debug] [MainThread]: Using postgres connection "master"
[0m10:55:33.356586 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:55:33.364457 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m10:55:33.368155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09f23bce-7fe5-4ca8-8a95-e5a324a7e663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae28f99a90>]}
[0m10:55:33.370443 [debug] [MainThread]: On master: ROLLBACK
[0m10:55:33.372353 [debug] [MainThread]: Using postgres connection "master"
[0m10:55:33.373876 [debug] [MainThread]: On master: BEGIN
[0m10:55:33.376177 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:55:33.379093 [debug] [MainThread]: On master: COMMIT
[0m10:55:33.382044 [debug] [MainThread]: Using postgres connection "master"
[0m10:55:33.384348 [debug] [MainThread]: On master: COMMIT
[0m10:55:33.387730 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:55:33.390406 [debug] [MainThread]: On master: Close
[0m10:55:33.395600 [debug] [Thread-1 (]: Began running node model.amn_dbt.purchase_prices
[0m10:55:33.398781 [info ] [Thread-1 (]: 1 of 4 START sql table model public.purchase_prices ............................ [RUN]
[0m10:55:33.401882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_amn_datawarehouse_public, now model.amn_dbt.purchase_prices)
[0m10:55:33.403907 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.purchase_prices
[0m10:55:33.421591 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.purchase_prices"
[0m10:55:33.444093 [debug] [Thread-1 (]: Began executing node model.amn_dbt.purchase_prices
[0m10:55:33.531152 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.purchase_prices"
[0m10:55:33.545832 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m10:55:33.547426 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: BEGIN
[0m10:55:33.549151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:55:33.560967 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m10:55:33.563008 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m10:55:33.564900 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */

  
    

  create  table "amn_datawarehouse"."public"."purchase_prices__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    Brand,
    PurchasePrice
FROM public.purchase_prices;
  );
  
[0m10:55:33.567563 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 15: FROM public.purchase_prices;
                                    ^

[0m10:55:33.569777 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: ROLLBACK
[0m10:55:33.571969 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: Close
[0m10:55:33.589928 [debug] [Thread-1 (]: Database Error in model purchase_prices (models/purchase_prices.sql)
  syntax error at or near ";"
  LINE 15: FROM public.purchase_prices;
                                      ^
  compiled code at target/run/amn_dbt/models/purchase_prices.sql
[0m10:55:33.594633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09f23bce-7fe5-4ca8-8a95-e5a324a7e663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae2b669040>]}
[0m10:55:33.598764 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.purchase_prices ................... [[31mERROR[0m in 0.19s]
[0m10:55:33.602577 [debug] [Thread-1 (]: Finished running node model.amn_dbt.purchase_prices
[0m10:55:33.605451 [debug] [Thread-1 (]: Began running node model.amn_dbt.sales
[0m10:55:33.607421 [debug] [Thread-4 (]: Marking all children of 'model.amn_dbt.purchase_prices' to be skipped because of status 'error'.  Reason: Database Error in model purchase_prices (models/purchase_prices.sql)
  syntax error at or near ";"
  LINE 15: FROM public.purchase_prices;
                                      ^
  compiled code at target/run/amn_dbt/models/purchase_prices.sql.
[0m10:55:33.609972 [info ] [Thread-1 (]: 2 of 4 START sql table model public.sales ...................................... [RUN]
[0m10:55:33.618371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.amn_dbt.purchase_prices, now model.amn_dbt.sales)
[0m10:55:33.620645 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.sales
[0m10:55:33.625811 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.sales"
[0m10:55:33.640452 [debug] [Thread-1 (]: Began executing node model.amn_dbt.sales
[0m10:55:33.650222 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.sales"
[0m10:55:33.665487 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m10:55:33.667973 [debug] [Thread-1 (]: On model.amn_dbt.sales: BEGIN
[0m10:55:33.670325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:55:33.686224 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m10:55:33.688587 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m10:55:33.690898 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */

  
    

  create  table "amn_datawarehouse"."public"."sales__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    InventoryId,
    Store,
    Description AS SalesDescription, 
    SalesPrice,
    Brand
FROM public.sales;
  );
  
[0m10:55:33.693698 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 18: FROM public.sales;
                          ^

[0m10:55:33.696431 [debug] [Thread-1 (]: On model.amn_dbt.sales: ROLLBACK
[0m10:55:33.700379 [debug] [Thread-1 (]: On model.amn_dbt.sales: Close
[0m10:55:33.707279 [debug] [Thread-1 (]: Database Error in model sales (models/sales.sql)
  syntax error at or near ";"
  LINE 18: FROM public.sales;
                            ^
  compiled code at target/run/amn_dbt/models/sales.sql
[0m10:55:33.709406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09f23bce-7fe5-4ca8-8a95-e5a324a7e663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae284c3710>]}
[0m10:55:33.712265 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.sales ............................. [[31mERROR[0m in 0.09s]
[0m10:55:33.717270 [debug] [Thread-1 (]: Finished running node model.amn_dbt.sales
[0m10:55:33.720481 [debug] [Thread-4 (]: Marking all children of 'model.amn_dbt.sales' to be skipped because of status 'error'.  Reason: Database Error in model sales (models/sales.sql)
  syntax error at or near ";"
  LINE 18: FROM public.sales;
                            ^
  compiled code at target/run/amn_dbt/models/sales.sql.
[0m10:55:33.723507 [debug] [Thread-1 (]: Began running node model.amn_dbt.profit_and_margin
[0m10:55:33.725689 [info ] [Thread-1 (]: 3 of 4 SKIP relation public.profit_and_margin .................................. [[33mSKIP[0m]
[0m10:55:33.728357 [debug] [Thread-1 (]: Finished running node model.amn_dbt.profit_and_margin
[0m10:55:33.733684 [debug] [Thread-1 (]: Began running node model.amn_dbt.least_profitability
[0m10:55:33.735802 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.least_profitability ................................ [[33mSKIP[0m]
[0m10:55:33.738325 [debug] [Thread-1 (]: Finished running node model.amn_dbt.least_profitability
[0m10:55:33.742834 [debug] [MainThread]: Using postgres connection "master"
[0m10:55:33.745118 [debug] [MainThread]: On master: BEGIN
[0m10:55:33.748917 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:55:33.765314 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m10:55:33.768402 [debug] [MainThread]: On master: COMMIT
[0m10:55:33.771671 [debug] [MainThread]: Using postgres connection "master"
[0m10:55:33.773907 [debug] [MainThread]: On master: COMMIT
[0m10:55:33.776349 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:55:33.778359 [debug] [MainThread]: On master: Close
[0m10:55:33.782395 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:55:33.785034 [debug] [MainThread]: Connection 'model.amn_dbt.sales' was properly closed.
[0m10:55:33.786831 [info ] [MainThread]: 
[0m10:55:33.788743 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m10:55:33.792641 [debug] [MainThread]: Command end result
[0m10:55:33.875330 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m10:55:33.888372 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m10:55:33.914866 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m10:55:33.917158 [info ] [MainThread]: 
[0m10:55:33.919427 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m10:55:33.921774 [info ] [MainThread]: 
[0m10:55:33.925217 [error] [MainThread]:   Database Error in model purchase_prices (models/purchase_prices.sql)
  syntax error at or near ";"
  LINE 15: FROM public.purchase_prices;
                                      ^
  compiled code at target/run/amn_dbt/models/purchase_prices.sql
[0m10:55:33.928435 [info ] [MainThread]: 
[0m10:55:33.932939 [error] [MainThread]:   Database Error in model sales (models/sales.sql)
  syntax error at or near ";"
  LINE 18: FROM public.sales;
                            ^
  compiled code at target/run/amn_dbt/models/sales.sql
[0m10:55:33.935971 [info ] [MainThread]: 
[0m10:55:33.939254 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=2 TOTAL=4
[0m10:55:33.943526 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.494322, "process_in_blocks": "376", "process_kernel_time": 0.576149, "process_mem_max_rss": "108324", "process_out_blocks": "0", "process_user_time": 6.238306}
[0m10:55:33.946911 [debug] [MainThread]: Command `dbt run` failed at 10:55:33.946373 after 3.50 seconds
[0m10:55:33.950028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae2be6f200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae2bc8ea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae2b76ce90>]}
[0m10:55:33.952114 [debug] [MainThread]: Flushing usage events
[0m10:55:34.687440 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:58:43.704297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f394f7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f394dca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f394dcd0>]}


============================== 10:58:43.735249 | 9860d757-04a6-4881-8799-d252c14b81fe ==============================
[0m10:58:43.735249 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:58:43.738430 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:58:44.673223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9860d757-04a6-4881-8799-d252c14b81fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f4371af0>]}
[0m10:58:45.037438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9860d757-04a6-4881-8799-d252c14b81fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f38b2ff0>]}
[0m10:58:45.043405 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:58:45.510696 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m10:58:45.769351 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m10:58:45.772425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9860d757-04a6-4881-8799-d252c14b81fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f3dbbd10>]}
[0m10:58:48.550239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9860d757-04a6-4881-8799-d252c14b81fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f1c03140>]}
[0m10:58:48.702261 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m10:58:48.719292 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m10:58:48.797314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9860d757-04a6-4881-8799-d252c14b81fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f1d98b30>]}
[0m10:58:48.800982 [info ] [MainThread]: Found 4 models, 429 macros
[0m10:58:48.806563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9860d757-04a6-4881-8799-d252c14b81fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f1cb72c0>]}
[0m10:58:48.819547 [info ] [MainThread]: 
[0m10:58:48.822535 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:58:48.835776 [info ] [MainThread]: 
[0m10:58:48.911332 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:58:48.942379 [debug] [ThreadPool]: Acquiring new postgres connection 'list_amn_datawarehouse'
[0m10:58:49.051713 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse"
[0m10:58:49.053539 [debug] [ThreadPool]: On list_amn_datawarehouse: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse"} */

    select distinct nspname from pg_namespace
  
[0m10:58:49.055171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:58:49.075009 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.020 seconds
[0m10:58:49.078904 [debug] [ThreadPool]: On list_amn_datawarehouse: Close
[0m10:58:49.083083 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_amn_datawarehouse, now list_amn_datawarehouse_public)
[0m10:58:49.096951 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m10:58:49.099029 [debug] [ThreadPool]: On list_amn_datawarehouse_public: BEGIN
[0m10:58:49.101114 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:58:49.118988 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m10:58:49.121538 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m10:58:49.123937 [debug] [ThreadPool]: On list_amn_datawarehouse_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse_public"} */
select
      'amn_datawarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:58:49.133850 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m10:58:49.139861 [debug] [ThreadPool]: On list_amn_datawarehouse_public: ROLLBACK
[0m10:58:49.142424 [debug] [ThreadPool]: On list_amn_datawarehouse_public: Close
[0m10:58:49.153519 [debug] [MainThread]: Using postgres connection "master"
[0m10:58:49.155693 [debug] [MainThread]: On master: BEGIN
[0m10:58:49.157354 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:58:49.170624 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m10:58:49.173403 [debug] [MainThread]: Using postgres connection "master"
[0m10:58:49.176890 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:58:49.185382 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m10:58:49.191681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9860d757-04a6-4881-8799-d252c14b81fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f1cb48f0>]}
[0m10:58:49.193811 [debug] [MainThread]: On master: ROLLBACK
[0m10:58:49.195780 [debug] [MainThread]: Using postgres connection "master"
[0m10:58:49.197498 [debug] [MainThread]: On master: BEGIN
[0m10:58:49.199637 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:58:49.201880 [debug] [MainThread]: On master: COMMIT
[0m10:58:49.207717 [debug] [MainThread]: Using postgres connection "master"
[0m10:58:49.210508 [debug] [MainThread]: On master: COMMIT
[0m10:58:49.213186 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:58:49.215354 [debug] [MainThread]: On master: Close
[0m10:58:49.220367 [debug] [Thread-1 (]: Began running node model.amn_dbt.purchase_prices
[0m10:58:49.224549 [info ] [Thread-1 (]: 1 of 4 START sql table model public.purchase_prices ............................ [RUN]
[0m10:58:49.227066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_amn_datawarehouse_public, now model.amn_dbt.purchase_prices)
[0m10:58:49.229513 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.purchase_prices
[0m10:58:49.246333 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.purchase_prices"
[0m10:58:49.256398 [debug] [Thread-1 (]: Began executing node model.amn_dbt.purchase_prices
[0m10:58:49.341784 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.purchase_prices"
[0m10:58:49.352319 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m10:58:49.354762 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: BEGIN
[0m10:58:49.357538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:58:49.371507 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m10:58:49.373628 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m10:58:49.375831 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */

  
    

  create  table "amn_datawarehouse"."public"."purchase_prices__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    Brand,
    PurchasePrice
FROM public.purchase_prices;
  );
  
[0m10:58:49.378623 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 15: FROM public.purchase_prices;
                                    ^

[0m10:58:49.380876 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: ROLLBACK
[0m10:58:49.383399 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: Close
[0m10:58:49.392953 [debug] [Thread-1 (]: Database Error in model purchase_prices (models/purchase_prices.sql)
  syntax error at or near ";"
  LINE 15: FROM public.purchase_prices;
                                      ^
  compiled code at target/run/amn_dbt/models/purchase_prices.sql
[0m10:58:49.399427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9860d757-04a6-4881-8799-d252c14b81fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f00c8b90>]}
[0m10:58:49.401935 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.purchase_prices ................... [[31mERROR[0m in 0.17s]
[0m10:58:49.405744 [debug] [Thread-1 (]: Finished running node model.amn_dbt.purchase_prices
[0m10:58:49.407907 [debug] [Thread-1 (]: Began running node model.amn_dbt.sales
[0m10:58:49.409206 [debug] [Thread-4 (]: Marking all children of 'model.amn_dbt.purchase_prices' to be skipped because of status 'error'.  Reason: Database Error in model purchase_prices (models/purchase_prices.sql)
  syntax error at or near ";"
  LINE 15: FROM public.purchase_prices;
                                      ^
  compiled code at target/run/amn_dbt/models/purchase_prices.sql.
[0m10:58:49.411803 [info ] [Thread-1 (]: 2 of 4 START sql table model public.sales ...................................... [RUN]
[0m10:58:49.418825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.amn_dbt.purchase_prices, now model.amn_dbt.sales)
[0m10:58:49.421298 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.sales
[0m10:58:49.428680 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.sales"
[0m10:58:49.442051 [debug] [Thread-1 (]: Began executing node model.amn_dbt.sales
[0m10:58:49.452918 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.sales"
[0m10:58:49.466121 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m10:58:49.468230 [debug] [Thread-1 (]: On model.amn_dbt.sales: BEGIN
[0m10:58:49.470060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:58:49.489343 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m10:58:49.492531 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m10:58:49.495204 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */

  
    

  create  table "amn_datawarehouse"."public"."sales__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    InventoryId,
    Store,
    Description AS SalesDescription, 
    SalesPrice,
    Brand
FROM public.sales;
  );
  
[0m10:58:49.498310 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 18: FROM public.sales;
                          ^

[0m10:58:49.500641 [debug] [Thread-1 (]: On model.amn_dbt.sales: ROLLBACK
[0m10:58:49.502919 [debug] [Thread-1 (]: On model.amn_dbt.sales: Close
[0m10:58:49.512607 [debug] [Thread-1 (]: Database Error in model sales (models/sales.sql)
  syntax error at or near ";"
  LINE 18: FROM public.sales;
                            ^
  compiled code at target/run/amn_dbt/models/sales.sql
[0m10:58:49.515547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9860d757-04a6-4881-8799-d252c14b81fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78ea654e00>]}
[0m10:58:49.519091 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.sales ............................. [[31mERROR[0m in 0.10s]
[0m10:58:49.522522 [debug] [Thread-1 (]: Finished running node model.amn_dbt.sales
[0m10:58:49.526368 [debug] [Thread-4 (]: Marking all children of 'model.amn_dbt.sales' to be skipped because of status 'error'.  Reason: Database Error in model sales (models/sales.sql)
  syntax error at or near ";"
  LINE 18: FROM public.sales;
                            ^
  compiled code at target/run/amn_dbt/models/sales.sql.
[0m10:58:49.529732 [debug] [Thread-1 (]: Began running node model.amn_dbt.profit_and_margin
[0m10:58:49.531938 [info ] [Thread-1 (]: 3 of 4 SKIP relation public.profit_and_margin .................................. [[33mSKIP[0m]
[0m10:58:49.534681 [debug] [Thread-1 (]: Finished running node model.amn_dbt.profit_and_margin
[0m10:58:49.538439 [debug] [Thread-1 (]: Began running node model.amn_dbt.least_profitability
[0m10:58:49.541405 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.least_profitability ................................ [[33mSKIP[0m]
[0m10:58:49.545034 [debug] [Thread-1 (]: Finished running node model.amn_dbt.least_profitability
[0m10:58:49.548933 [debug] [MainThread]: Using postgres connection "master"
[0m10:58:49.550991 [debug] [MainThread]: On master: BEGIN
[0m10:58:49.552784 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:58:49.568602 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m10:58:49.571060 [debug] [MainThread]: On master: COMMIT
[0m10:58:49.574007 [debug] [MainThread]: Using postgres connection "master"
[0m10:58:49.576968 [debug] [MainThread]: On master: COMMIT
[0m10:58:49.579398 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:58:49.581390 [debug] [MainThread]: On master: Close
[0m10:58:49.583354 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:58:49.585224 [debug] [MainThread]: Connection 'model.amn_dbt.sales' was properly closed.
[0m10:58:49.587167 [info ] [MainThread]: 
[0m10:58:49.590125 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m10:58:49.595320 [debug] [MainThread]: Command end result
[0m10:58:49.766410 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m10:58:49.780185 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m10:58:49.805282 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m10:58:49.807114 [info ] [MainThread]: 
[0m10:58:49.809481 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m10:58:49.812045 [info ] [MainThread]: 
[0m10:58:49.815264 [error] [MainThread]:   Database Error in model purchase_prices (models/purchase_prices.sql)
  syntax error at or near ";"
  LINE 15: FROM public.purchase_prices;
                                      ^
  compiled code at target/run/amn_dbt/models/purchase_prices.sql
[0m10:58:49.818244 [info ] [MainThread]: 
[0m10:58:49.821216 [error] [MainThread]:   Database Error in model sales (models/sales.sql)
  syntax error at or near ";"
  LINE 18: FROM public.sales;
                            ^
  compiled code at target/run/amn_dbt/models/sales.sql
[0m10:58:49.824018 [info ] [MainThread]: 
[0m10:58:49.827261 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=2 TOTAL=4
[0m10:58:49.831137 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.5534167, "process_in_blocks": "0", "process_kernel_time": 0.503498, "process_mem_max_rss": "109412", "process_out_blocks": "0", "process_user_time": 9.334866}
[0m10:58:49.834471 [debug] [MainThread]: Command `dbt run` failed at 10:58:49.833862 after 6.56 seconds
[0m10:58:49.837338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f3d531d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f1c04d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f1c05580>]}
[0m10:58:49.840303 [debug] [MainThread]: Flushing usage events
[0m10:58:50.582234 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:02:06.401797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a6058c9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a5fdb13a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a603c8bc0>]}


============================== 11:02:06.419027 | 769c6a97-43a0-4643-90ac-cefa2fa8440e ==============================
[0m11:02:06.419027 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:02:06.423168 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:02:07.114328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '769c6a97-43a0-4643-90ac-cefa2fa8440e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a603caf60>]}
[0m11:02:07.509594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '769c6a97-43a0-4643-90ac-cefa2fa8440e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a605e7c20>]}
[0m11:02:07.527995 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:02:07.859028 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:02:08.204544 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:02:08.209983 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:02:08.297745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '769c6a97-43a0-4643-90ac-cefa2fa8440e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a5e12de50>]}
[0m11:02:08.563136 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m11:02:08.579827 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m11:02:08.635134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '769c6a97-43a0-4643-90ac-cefa2fa8440e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a5de1c7d0>]}
[0m11:02:08.637965 [info ] [MainThread]: Found 4 models, 429 macros
[0m11:02:08.640602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '769c6a97-43a0-4643-90ac-cefa2fa8440e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a5e0650d0>]}
[0m11:02:08.647957 [info ] [MainThread]: 
[0m11:02:08.651415 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:02:08.654536 [info ] [MainThread]: 
[0m11:02:08.658480 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:02:08.676697 [debug] [ThreadPool]: Acquiring new postgres connection 'list_amn_datawarehouse'
[0m11:02:08.784679 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse"
[0m11:02:08.786915 [debug] [ThreadPool]: On list_amn_datawarehouse: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse"} */

    select distinct nspname from pg_namespace
  
[0m11:02:08.788816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:08.814342 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.025 seconds
[0m11:02:08.819486 [debug] [ThreadPool]: On list_amn_datawarehouse: Close
[0m11:02:08.825037 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_amn_datawarehouse, now list_amn_datawarehouse_public)
[0m11:02:08.844364 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m11:02:08.846725 [debug] [ThreadPool]: On list_amn_datawarehouse_public: BEGIN
[0m11:02:08.849143 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:02:08.873718 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m11:02:08.877873 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m11:02:08.881158 [debug] [ThreadPool]: On list_amn_datawarehouse_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse_public"} */
select
      'amn_datawarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:02:08.893163 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m11:02:08.907676 [debug] [ThreadPool]: On list_amn_datawarehouse_public: ROLLBACK
[0m11:02:08.915013 [debug] [ThreadPool]: On list_amn_datawarehouse_public: Close
[0m11:02:08.940815 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:08.945486 [debug] [MainThread]: On master: BEGIN
[0m11:02:08.951179 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:02:08.973609 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m11:02:08.976858 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:08.988690 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:02:09.000815 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m11:02:09.008161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '769c6a97-43a0-4643-90ac-cefa2fa8440e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a5e065340>]}
[0m11:02:09.012727 [debug] [MainThread]: On master: ROLLBACK
[0m11:02:09.027124 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:09.030385 [debug] [MainThread]: On master: BEGIN
[0m11:02:09.042918 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m11:02:09.047693 [debug] [MainThread]: On master: COMMIT
[0m11:02:09.050753 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:09.054108 [debug] [MainThread]: On master: COMMIT
[0m11:02:09.057741 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:02:09.061289 [debug] [MainThread]: On master: Close
[0m11:02:09.077050 [debug] [Thread-1 (]: Began running node model.amn_dbt.purchase_prices
[0m11:02:09.080701 [info ] [Thread-1 (]: 1 of 4 START sql table model public.purchase_prices ............................ [RUN]
[0m11:02:09.093895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_amn_datawarehouse_public, now model.amn_dbt.purchase_prices)
[0m11:02:09.100214 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.purchase_prices
[0m11:02:09.138105 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.purchase_prices"
[0m11:02:09.159057 [debug] [Thread-1 (]: Began executing node model.amn_dbt.purchase_prices
[0m11:02:09.288600 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.purchase_prices"
[0m11:02:09.303419 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m11:02:09.306426 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: BEGIN
[0m11:02:09.309841 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:02:09.326148 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m11:02:09.329068 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m11:02:09.332006 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */

  
    

  create  table "amn_datawarehouse"."public"."purchase_prices__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    Brand,
    PurchasePrice
FROM public.purchase_prices;
  );
  
[0m11:02:09.335757 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 15: FROM public.purchase_prices;
                                    ^

[0m11:02:09.339054 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: ROLLBACK
[0m11:02:09.342971 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: Close
[0m11:02:09.362107 [debug] [Thread-1 (]: Database Error in model purchase_prices (models/purchase_prices.sql)
  syntax error at or near ";"
  LINE 15: FROM public.purchase_prices;
                                      ^
  compiled code at target/run/amn_dbt/models/purchase_prices.sql
[0m11:02:09.369777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '769c6a97-43a0-4643-90ac-cefa2fa8440e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a5ff63560>]}
[0m11:02:09.373778 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.purchase_prices ................... [[31mERROR[0m in 0.27s]
[0m11:02:09.379176 [debug] [Thread-1 (]: Finished running node model.amn_dbt.purchase_prices
[0m11:02:09.385121 [debug] [Thread-1 (]: Began running node model.amn_dbt.sales
[0m11:02:09.387350 [debug] [Thread-4 (]: Marking all children of 'model.amn_dbt.purchase_prices' to be skipped because of status 'error'.  Reason: Database Error in model purchase_prices (models/purchase_prices.sql)
  syntax error at or near ";"
  LINE 15: FROM public.purchase_prices;
                                      ^
  compiled code at target/run/amn_dbt/models/purchase_prices.sql.
[0m11:02:09.390361 [info ] [Thread-1 (]: 2 of 4 START sql table model public.sales ...................................... [RUN]
[0m11:02:09.397075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.amn_dbt.purchase_prices, now model.amn_dbt.sales)
[0m11:02:09.401445 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.sales
[0m11:02:09.412312 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.sales"
[0m11:02:09.431472 [debug] [Thread-1 (]: Began executing node model.amn_dbt.sales
[0m11:02:09.446799 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.sales"
[0m11:02:09.462215 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m11:02:09.465535 [debug] [Thread-1 (]: On model.amn_dbt.sales: BEGIN
[0m11:02:09.469188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:02:09.488293 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m11:02:09.491274 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m11:02:09.493837 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */

  
    

  create  table "amn_datawarehouse"."public"."sales__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    InventoryId,
    Store,
    Description AS SalesDescription, 
    SalesPrice,
    Brand
FROM public.sales;
  );
  
[0m11:02:09.497219 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 18: FROM public.sales;
                          ^

[0m11:02:09.501974 [debug] [Thread-1 (]: On model.amn_dbt.sales: ROLLBACK
[0m11:02:09.505449 [debug] [Thread-1 (]: On model.amn_dbt.sales: Close
[0m11:02:09.516261 [debug] [Thread-1 (]: Database Error in model sales (models/sales.sql)
  syntax error at or near ";"
  LINE 18: FROM public.sales;
                            ^
  compiled code at target/run/amn_dbt/models/sales.sql
[0m11:02:09.519868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '769c6a97-43a0-4643-90ac-cefa2fa8440e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a5d0df9e0>]}
[0m11:02:09.523426 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.sales ............................. [[31mERROR[0m in 0.12s]
[0m11:02:09.527223 [debug] [Thread-1 (]: Finished running node model.amn_dbt.sales
[0m11:02:09.530253 [debug] [Thread-4 (]: Marking all children of 'model.amn_dbt.sales' to be skipped because of status 'error'.  Reason: Database Error in model sales (models/sales.sql)
  syntax error at or near ";"
  LINE 18: FROM public.sales;
                            ^
  compiled code at target/run/amn_dbt/models/sales.sql.
[0m11:02:09.535442 [debug] [Thread-1 (]: Began running node model.amn_dbt.profit_and_margin
[0m11:02:09.537935 [info ] [Thread-1 (]: 3 of 4 SKIP relation public.profit_and_margin .................................. [[33mSKIP[0m]
[0m11:02:09.541241 [debug] [Thread-1 (]: Finished running node model.amn_dbt.profit_and_margin
[0m11:02:09.544579 [debug] [Thread-1 (]: Began running node model.amn_dbt.least_profitability
[0m11:02:09.547606 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.least_profitability ................................ [[33mSKIP[0m]
[0m11:02:09.551949 [debug] [Thread-1 (]: Finished running node model.amn_dbt.least_profitability
[0m11:02:09.557708 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:09.560296 [debug] [MainThread]: On master: BEGIN
[0m11:02:09.563035 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:02:09.583170 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m11:02:09.586996 [debug] [MainThread]: On master: COMMIT
[0m11:02:09.589837 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:09.592362 [debug] [MainThread]: On master: COMMIT
[0m11:02:09.595062 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:02:09.597075 [debug] [MainThread]: On master: Close
[0m11:02:09.600906 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:02:09.603449 [debug] [MainThread]: Connection 'model.amn_dbt.sales' was properly closed.
[0m11:02:09.605992 [info ] [MainThread]: 
[0m11:02:09.609076 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m11:02:09.613980 [debug] [MainThread]: Command end result
[0m11:02:09.720757 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m11:02:09.735395 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m11:02:09.773795 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m11:02:09.775963 [info ] [MainThread]: 
[0m11:02:09.778849 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m11:02:09.783606 [info ] [MainThread]: 
[0m11:02:09.787716 [error] [MainThread]:   Database Error in model purchase_prices (models/purchase_prices.sql)
  syntax error at or near ";"
  LINE 15: FROM public.purchase_prices;
                                      ^
  compiled code at target/run/amn_dbt/models/purchase_prices.sql
[0m11:02:09.791434 [info ] [MainThread]: 
[0m11:02:09.795014 [error] [MainThread]:   Database Error in model sales (models/sales.sql)
  syntax error at or near ";"
  LINE 18: FROM public.sales;
                            ^
  compiled code at target/run/amn_dbt/models/sales.sql
[0m11:02:09.798368 [info ] [MainThread]: 
[0m11:02:09.803587 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=2 TOTAL=4
[0m11:02:09.808950 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.8295257, "process_in_blocks": "0", "process_kernel_time": 0.630251, "process_mem_max_rss": "108316", "process_out_blocks": "0", "process_user_time": 7.25289}
[0m11:02:09.812183 [debug] [MainThread]: Command `dbt run` failed at 11:02:09.811809 after 3.83 seconds
[0m11:02:09.814737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a5ff91670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a60500b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a5d0748f0>]}
[0m11:02:09.818610 [debug] [MainThread]: Flushing usage events
[0m11:02:10.549775 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:06:23.091112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7431db6240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7431e4fb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74338484a0>]}


============================== 11:06:23.103528 | af83a425-7828-459e-a359-9a8b74e41adc ==============================
[0m11:06:23.103528 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:06:23.107401 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:06:23.820882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af83a425-7828-459e-a359-9a8b74e41adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f743187c5c0>]}
[0m11:06:24.112249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af83a425-7828-459e-a359-9a8b74e41adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f743185eea0>]}
[0m11:06:24.131370 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:06:24.477069 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:06:24.876348 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:06:24.878744 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:06:24.965355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af83a425-7828-459e-a359-9a8b74e41adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74317603b0>]}
[0m11:06:25.147741 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m11:06:25.163089 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m11:06:25.266436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af83a425-7828-459e-a359-9a8b74e41adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f742fcc4410>]}
[0m11:06:25.269629 [info ] [MainThread]: Found 4 models, 429 macros
[0m11:06:25.272874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af83a425-7828-459e-a359-9a8b74e41adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7431d55460>]}
[0m11:06:25.284080 [info ] [MainThread]: 
[0m11:06:25.287120 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:06:25.298704 [info ] [MainThread]: 
[0m11:06:25.302117 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:06:25.322166 [debug] [ThreadPool]: Acquiring new postgres connection 'list_amn_datawarehouse'
[0m11:06:25.438825 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse"
[0m11:06:25.440697 [debug] [ThreadPool]: On list_amn_datawarehouse: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse"} */

    select distinct nspname from pg_namespace
  
[0m11:06:25.442438 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:06:25.462459 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.020 seconds
[0m11:06:25.474043 [debug] [ThreadPool]: On list_amn_datawarehouse: Close
[0m11:06:25.483517 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_amn_datawarehouse, now list_amn_datawarehouse_public)
[0m11:06:25.534596 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m11:06:25.536848 [debug] [ThreadPool]: On list_amn_datawarehouse_public: BEGIN
[0m11:06:25.539316 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:06:25.567351 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m11:06:25.569539 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m11:06:25.571849 [debug] [ThreadPool]: On list_amn_datawarehouse_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse_public"} */
select
      'amn_datawarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:06:25.580034 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m11:06:25.585083 [debug] [ThreadPool]: On list_amn_datawarehouse_public: ROLLBACK
[0m11:06:25.587351 [debug] [ThreadPool]: On list_amn_datawarehouse_public: Close
[0m11:06:25.604436 [debug] [MainThread]: Using postgres connection "master"
[0m11:06:25.606564 [debug] [MainThread]: On master: BEGIN
[0m11:06:25.609063 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:06:25.631708 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m11:06:25.634059 [debug] [MainThread]: Using postgres connection "master"
[0m11:06:25.637914 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:06:25.646649 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m11:06:25.652998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af83a425-7828-459e-a359-9a8b74e41adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f742ff10cb0>]}
[0m11:06:25.659007 [debug] [MainThread]: On master: ROLLBACK
[0m11:06:25.663340 [debug] [MainThread]: Using postgres connection "master"
[0m11:06:25.665676 [debug] [MainThread]: On master: BEGIN
[0m11:06:25.668794 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:06:25.671124 [debug] [MainThread]: On master: COMMIT
[0m11:06:25.673798 [debug] [MainThread]: Using postgres connection "master"
[0m11:06:25.676619 [debug] [MainThread]: On master: COMMIT
[0m11:06:25.680518 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:06:25.684024 [debug] [MainThread]: On master: Close
[0m11:06:25.690089 [debug] [Thread-1 (]: Began running node model.amn_dbt.purchase_prices
[0m11:06:25.693972 [info ] [Thread-1 (]: 1 of 4 START sql table model public.purchase_prices ............................ [RUN]
[0m11:06:25.698565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_amn_datawarehouse_public, now model.amn_dbt.purchase_prices)
[0m11:06:25.702504 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.purchase_prices
[0m11:06:25.725547 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.purchase_prices"
[0m11:06:25.739745 [debug] [Thread-1 (]: Began executing node model.amn_dbt.purchase_prices
[0m11:06:25.841067 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.purchase_prices"
[0m11:06:25.848363 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m11:06:25.849782 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: BEGIN
[0m11:06:25.851139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:06:25.862397 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m11:06:25.864609 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m11:06:25.866371 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */

  
    

  create  table "amn_datawarehouse"."public"."purchase_prices__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    Brand,
    PurchasePrice
FROM public.purchase_prices;
  );
  
[0m11:06:25.868897 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 15: FROM public.purchase_prices;
                                    ^

[0m11:06:25.870749 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: ROLLBACK
[0m11:06:25.872703 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: Close
[0m11:06:25.882810 [debug] [Thread-1 (]: Database Error in model purchase_prices (models/purchase_prices.sql)
  syntax error at or near ";"
  LINE 15: FROM public.purchase_prices;
                                      ^
  compiled code at target/run/amn_dbt/models/purchase_prices.sql
[0m11:06:25.888979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af83a425-7828-459e-a359-9a8b74e41adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f742fd23c50>]}
[0m11:06:25.892031 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.purchase_prices ................... [[31mERROR[0m in 0.19s]
[0m11:06:25.896503 [debug] [Thread-1 (]: Finished running node model.amn_dbt.purchase_prices
[0m11:06:25.899336 [debug] [Thread-1 (]: Began running node model.amn_dbt.sales
[0m11:06:25.900874 [debug] [Thread-4 (]: Marking all children of 'model.amn_dbt.purchase_prices' to be skipped because of status 'error'.  Reason: Database Error in model purchase_prices (models/purchase_prices.sql)
  syntax error at or near ";"
  LINE 15: FROM public.purchase_prices;
                                      ^
  compiled code at target/run/amn_dbt/models/purchase_prices.sql.
[0m11:06:25.903179 [info ] [Thread-1 (]: 2 of 4 START sql table model public.sales ...................................... [RUN]
[0m11:06:25.908078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.amn_dbt.purchase_prices, now model.amn_dbt.sales)
[0m11:06:25.909613 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.sales
[0m11:06:25.916413 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.sales"
[0m11:06:25.925432 [debug] [Thread-1 (]: Began executing node model.amn_dbt.sales
[0m11:06:25.934620 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.sales"
[0m11:06:25.943024 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m11:06:25.946578 [debug] [Thread-1 (]: On model.amn_dbt.sales: BEGIN
[0m11:06:25.948802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:06:25.965042 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m11:06:25.967085 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m11:06:25.968780 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */

  
    

  create  table "amn_datawarehouse"."public"."sales__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    InventoryId,
    Store,
    Description AS SalesDescription, 
    SalesPrice,
    Brand
FROM public.sales;
  );
  
[0m11:06:25.971405 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 18: FROM public.sales;
                          ^

[0m11:06:25.973096 [debug] [Thread-1 (]: On model.amn_dbt.sales: ROLLBACK
[0m11:06:25.975016 [debug] [Thread-1 (]: On model.amn_dbt.sales: Close
[0m11:06:25.983690 [debug] [Thread-1 (]: Database Error in model sales (models/sales.sql)
  syntax error at or near ";"
  LINE 18: FROM public.sales;
                            ^
  compiled code at target/run/amn_dbt/models/sales.sql
[0m11:06:25.985629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af83a425-7828-459e-a359-9a8b74e41adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f742d58b740>]}
[0m11:06:25.987827 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.sales ............................. [[31mERROR[0m in 0.08s]
[0m11:06:25.990230 [debug] [Thread-1 (]: Finished running node model.amn_dbt.sales
[0m11:06:25.992541 [debug] [Thread-4 (]: Marking all children of 'model.amn_dbt.sales' to be skipped because of status 'error'.  Reason: Database Error in model sales (models/sales.sql)
  syntax error at or near ";"
  LINE 18: FROM public.sales;
                            ^
  compiled code at target/run/amn_dbt/models/sales.sql.
[0m11:06:25.996804 [debug] [Thread-1 (]: Began running node model.amn_dbt.profit_and_margin
[0m11:06:25.998950 [info ] [Thread-1 (]: 3 of 4 SKIP relation public.profit_and_margin .................................. [[33mSKIP[0m]
[0m11:06:26.000924 [debug] [Thread-1 (]: Finished running node model.amn_dbt.profit_and_margin
[0m11:06:26.003852 [debug] [Thread-1 (]: Began running node model.amn_dbt.least_profitability
[0m11:06:26.005545 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.least_profitability ................................ [[33mSKIP[0m]
[0m11:06:26.007416 [debug] [Thread-1 (]: Finished running node model.amn_dbt.least_profitability
[0m11:06:26.011217 [debug] [MainThread]: Using postgres connection "master"
[0m11:06:26.013980 [debug] [MainThread]: On master: BEGIN
[0m11:06:26.015645 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:06:26.026457 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m11:06:26.029310 [debug] [MainThread]: On master: COMMIT
[0m11:06:26.031645 [debug] [MainThread]: Using postgres connection "master"
[0m11:06:26.033356 [debug] [MainThread]: On master: COMMIT
[0m11:06:26.035236 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:06:26.037806 [debug] [MainThread]: On master: Close
[0m11:06:26.039538 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:06:26.041356 [debug] [MainThread]: Connection 'model.amn_dbt.sales' was properly closed.
[0m11:06:26.043138 [info ] [MainThread]: 
[0m11:06:26.046527 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m11:06:26.050287 [debug] [MainThread]: Command end result
[0m11:06:26.221179 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m11:06:26.237097 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m11:06:26.269706 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m11:06:26.272305 [info ] [MainThread]: 
[0m11:06:26.274947 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m11:06:26.278314 [info ] [MainThread]: 
[0m11:06:26.282768 [error] [MainThread]:   Database Error in model purchase_prices (models/purchase_prices.sql)
  syntax error at or near ";"
  LINE 15: FROM public.purchase_prices;
                                      ^
  compiled code at target/run/amn_dbt/models/purchase_prices.sql
[0m11:06:26.287308 [info ] [MainThread]: 
[0m11:06:26.290034 [error] [MainThread]:   Database Error in model sales (models/sales.sql)
  syntax error at or near ";"
  LINE 18: FROM public.sales;
                            ^
  compiled code at target/run/amn_dbt/models/sales.sql
[0m11:06:26.293825 [info ] [MainThread]: 
[0m11:06:26.298878 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=2 TOTAL=4
[0m11:06:26.303623 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.5771904, "process_in_blocks": "0", "process_kernel_time": 0.45274, "process_mem_max_rss": "107004", "process_out_blocks": "0", "process_user_time": 6.338364}
[0m11:06:26.306450 [debug] [MainThread]: Command `dbt run` failed at 11:06:26.306205 after 3.58 seconds
[0m11:06:26.308199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7431cba9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f743230cc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f743230c3b0>]}
[0m11:06:26.309783 [debug] [MainThread]: Flushing usage events
[0m11:06:27.057258 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:08:58.686074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8c16c17c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8c18f1550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8c18f1c10>]}


============================== 11:08:58.697238 | a4beaa1c-681a-4236-9c8e-e2084ebac678 ==============================
[0m11:08:58.697238 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:08:58.712248 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:08:59.688375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4beaa1c-681a-4236-9c8e-e2084ebac678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8c1b2fc80>]}
[0m11:08:59.939084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4beaa1c-681a-4236-9c8e-e2084ebac678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8c14df5c0>]}
[0m11:08:59.943202 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:09:00.330487 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:09:00.698556 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:09:00.701923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a4beaa1c-681a-4236-9c8e-e2084ebac678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8c1b2fd10>]}
[0m11:09:03.439800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4beaa1c-681a-4236-9c8e-e2084ebac678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8bf8f00e0>]}
[0m11:09:03.572205 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m11:09:03.582851 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m11:09:03.616465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4beaa1c-681a-4236-9c8e-e2084ebac678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8bf89af00>]}
[0m11:09:03.618336 [info ] [MainThread]: Found 4 models, 429 macros
[0m11:09:03.620363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4beaa1c-681a-4236-9c8e-e2084ebac678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8bf8f03e0>]}
[0m11:09:03.626627 [info ] [MainThread]: 
[0m11:09:03.628998 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:09:03.631720 [info ] [MainThread]: 
[0m11:09:03.634602 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:09:03.647603 [debug] [ThreadPool]: Acquiring new postgres connection 'list_amn_datawarehouse'
[0m11:09:03.764487 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse"
[0m11:09:03.767207 [debug] [ThreadPool]: On list_amn_datawarehouse: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse"} */

    select distinct nspname from pg_namespace
  
[0m11:09:03.769793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:03.774269 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m11:09:03.784006 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse"} */

    select distinct nspname from pg_namespace
  
[0m11:09:03.790623 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m11:09:03.793300 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m11:09:03.795611 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m11:09:03.797353 [debug] [ThreadPool]: On list_amn_datawarehouse: No close available on handle
[0m11:09:03.800934 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:09:03.804017 [debug] [MainThread]: Connection 'list_amn_datawarehouse' was properly closed.
[0m11:09:03.806386 [info ] [MainThread]: 
[0m11:09:03.813553 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m11:09:03.817583 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m11:09:03.823523 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.5207214, "process_in_blocks": "0", "process_kernel_time": 0.514119, "process_mem_max_rss": "105952", "process_out_blocks": "0", "process_user_time": 8.295124}
[0m11:09:03.826492 [debug] [MainThread]: Command `dbt run` failed at 11:09:03.826124 after 5.52 seconds
[0m11:09:03.829090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8c15dcd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8bf9b57c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8bf8f47d0>]}
[0m11:09:03.837586 [debug] [MainThread]: Flushing usage events
[0m11:09:04.637882 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:09:43.043886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ede0fc620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3edb3c0a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3edb959820>]}


============================== 11:09:43.048798 | 4369896f-0038-4ce0-a3bb-19655ec93595 ==============================
[0m11:09:43.048798 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:09:43.050888 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:09:43.307612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4369896f-0038-4ce0-a3bb-19655ec93595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3edb1dbdd0>]}
[0m11:09:43.399401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4369896f-0038-4ce0-a3bb-19655ec93595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3edb3c0b60>]}
[0m11:09:43.401662 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:09:43.531823 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:09:43.699511 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:09:43.701155 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:09:43.743572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4369896f-0038-4ce0-a3bb-19655ec93595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ed97dfaa0>]}
[0m11:09:43.870791 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m11:09:43.881430 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m11:09:43.914220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4369896f-0038-4ce0-a3bb-19655ec93595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ed973c470>]}
[0m11:09:43.916174 [info ] [MainThread]: Found 4 models, 429 macros
[0m11:09:43.918460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4369896f-0038-4ce0-a3bb-19655ec93595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ed998b9e0>]}
[0m11:09:43.924492 [info ] [MainThread]: 
[0m11:09:43.926934 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:09:43.929189 [info ] [MainThread]: 
[0m11:09:43.932067 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:09:43.943552 [debug] [ThreadPool]: Acquiring new postgres connection 'list_amn_datawarehouse'
[0m11:09:44.014645 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse"
[0m11:09:44.016414 [debug] [ThreadPool]: On list_amn_datawarehouse: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse"} */

    select distinct nspname from pg_namespace
  
[0m11:09:44.018156 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:44.020937 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m11:09:44.025709 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse"} */

    select distinct nspname from pg_namespace
  
[0m11:09:44.029013 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m11:09:44.030688 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m11:09:44.032186 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m11:09:44.033708 [debug] [ThreadPool]: On list_amn_datawarehouse: No close available on handle
[0m11:09:44.035846 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:09:44.037523 [debug] [MainThread]: Connection 'list_amn_datawarehouse' was properly closed.
[0m11:09:44.039839 [info ] [MainThread]: 
[0m11:09:44.043256 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m11:09:44.045724 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m11:09:44.049100 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1373494, "process_in_blocks": "0", "process_kernel_time": 0.237577, "process_mem_max_rss": "103044", "process_out_blocks": "0", "process_user_time": 2.534154}
[0m11:09:44.051670 [debug] [MainThread]: Command `dbt run` failed at 11:09:44.051451 after 1.14 seconds
[0m11:09:44.053439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3edbe19f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ed97a86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ed984bfb0>]}
[0m11:09:44.056400 [debug] [MainThread]: Flushing usage events
[0m11:09:44.767178 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:09:59.480935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4236b45910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4236d3ef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4236a0fda0>]}


============================== 11:09:59.486093 | 73f40157-a96f-4297-a4e0-be4e32ca44cf ==============================
[0m11:09:59.486093 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:09:59.488050 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:09:59.742583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73f40157-a96f-4297-a4e0-be4e32ca44cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42364cae40>]}
[0m11:09:59.833997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73f40157-a96f-4297-a4e0-be4e32ca44cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42365978c0>]}
[0m11:09:59.836307 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:09:59.959920 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:10:00.130607 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:10:00.132390 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:10:00.172807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73f40157-a96f-4297-a4e0-be4e32ca44cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f423647fda0>]}
[0m11:10:00.285164 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m11:10:00.293875 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m11:10:00.322563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73f40157-a96f-4297-a4e0-be4e32ca44cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4234954260>]}
[0m11:10:00.324272 [info ] [MainThread]: Found 4 models, 429 macros
[0m11:10:00.326256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73f40157-a96f-4297-a4e0-be4e32ca44cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4239c6a8d0>]}
[0m11:10:00.330425 [info ] [MainThread]: 
[0m11:10:00.332313 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:10:00.334075 [info ] [MainThread]: 
[0m11:10:00.336246 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:10:00.345803 [debug] [ThreadPool]: Acquiring new postgres connection 'list_amn_datawarehouse'
[0m11:10:00.404482 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse"
[0m11:10:00.407039 [debug] [ThreadPool]: On list_amn_datawarehouse: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse"} */

    select distinct nspname from pg_namespace
  
[0m11:10:00.408595 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:10:00.411868 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m11:10:00.414691 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse"} */

    select distinct nspname from pg_namespace
  
[0m11:10:00.416316 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m11:10:00.417976 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m11:10:00.419273 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m11:10:00.420773 [debug] [ThreadPool]: On list_amn_datawarehouse: No close available on handle
[0m11:10:00.422647 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:10:00.424021 [debug] [MainThread]: Connection 'list_amn_datawarehouse' was properly closed.
[0m11:10:00.425292 [info ] [MainThread]: 
[0m11:10:00.427944 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m11:10:00.430183 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m11:10:00.433130 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1043686, "process_in_blocks": "0", "process_kernel_time": 0.201304, "process_mem_max_rss": "102952", "process_out_blocks": "0", "process_user_time": 2.465983}
[0m11:10:00.434980 [debug] [MainThread]: Command `dbt run` failed at 11:10:00.434753 after 1.11 seconds
[0m11:10:00.436335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4236e46cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4234c8f200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42349d5250>]}
[0m11:10:00.437721 [debug] [MainThread]: Flushing usage events
[0m11:10:01.135647 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:49:18.458472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb64d50e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb64d50d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb643edbe0>]}


============================== 04:49:18.520740 | b32d0b08-834d-4060-b9a4-4034c8251185 ==============================
[0m04:49:18.520740 [info ] [MainThread]: Running with dbt=1.9.0
[0m04:49:18.535923 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m04:49:20.663693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b32d0b08-834d-4060-b9a4-4034c8251185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb6422a690>]}
[0m04:49:21.055219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b32d0b08-834d-4060-b9a4-4034c8251185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb64e6db80>]}
[0m04:49:21.060591 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m04:49:21.403851 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m04:49:21.824601 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m04:49:21.828212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b32d0b08-834d-4060-b9a4-4034c8251185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb627395b0>]}
[0m04:49:24.898635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b32d0b08-834d-4060-b9a4-4034c8251185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb62904ec0>]}
[0m04:49:25.048442 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m04:49:25.061113 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m04:49:25.125868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b32d0b08-834d-4060-b9a4-4034c8251185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb6269d7c0>]}
[0m04:49:25.128141 [info ] [MainThread]: Found 4 models, 429 macros
[0m04:49:25.131706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b32d0b08-834d-4060-b9a4-4034c8251185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb6266f500>]}
[0m04:49:25.138475 [info ] [MainThread]: 
[0m04:49:25.141858 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:49:25.144695 [info ] [MainThread]: 
[0m04:49:25.148887 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:49:25.169412 [debug] [ThreadPool]: Acquiring new postgres connection 'list_amn_datawarehouse'
[0m04:49:25.322259 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse"
[0m04:49:25.325935 [debug] [ThreadPool]: On list_amn_datawarehouse: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse"} */

    select distinct nspname from pg_namespace
  
[0m04:49:25.329498 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:49:25.388132 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.058 seconds
[0m04:49:25.402109 [debug] [ThreadPool]: On list_amn_datawarehouse: Close
[0m04:49:25.411373 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_amn_datawarehouse, now list_amn_datawarehouse_public)
[0m04:49:25.449906 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m04:49:25.453189 [debug] [ThreadPool]: On list_amn_datawarehouse_public: BEGIN
[0m04:49:25.455653 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:49:25.489019 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m04:49:25.496733 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m04:49:25.511232 [debug] [ThreadPool]: On list_amn_datawarehouse_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse_public"} */
select
      'amn_datawarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m04:49:25.539665 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.018 seconds
[0m04:49:25.556407 [debug] [ThreadPool]: On list_amn_datawarehouse_public: ROLLBACK
[0m04:49:25.560436 [debug] [ThreadPool]: On list_amn_datawarehouse_public: Close
[0m04:49:25.584486 [debug] [MainThread]: Using postgres connection "master"
[0m04:49:25.586431 [debug] [MainThread]: On master: BEGIN
[0m04:49:25.588389 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:49:25.605196 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m04:49:25.607870 [debug] [MainThread]: Using postgres connection "master"
[0m04:49:25.610491 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:49:25.619852 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m04:49:25.623611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b32d0b08-834d-4060-b9a4-4034c8251185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb6285a0c0>]}
[0m04:49:25.626524 [debug] [MainThread]: On master: ROLLBACK
[0m04:49:25.628895 [debug] [MainThread]: Using postgres connection "master"
[0m04:49:25.630545 [debug] [MainThread]: On master: BEGIN
[0m04:49:25.634065 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m04:49:25.637520 [debug] [MainThread]: On master: COMMIT
[0m04:49:25.641205 [debug] [MainThread]: Using postgres connection "master"
[0m04:49:25.643479 [debug] [MainThread]: On master: COMMIT
[0m04:49:25.645667 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:49:25.648350 [debug] [MainThread]: On master: Close
[0m04:49:25.656722 [debug] [Thread-1 (]: Began running node model.amn_dbt.purchase_prices
[0m04:49:25.659666 [info ] [Thread-1 (]: 1 of 4 START sql table model public.purchase_prices ............................ [RUN]
[0m04:49:25.662467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_amn_datawarehouse_public, now model.amn_dbt.purchase_prices)
[0m04:49:25.665293 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.purchase_prices
[0m04:49:25.693856 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.purchase_prices"
[0m04:49:25.710810 [debug] [Thread-1 (]: Began executing node model.amn_dbt.purchase_prices
[0m04:49:25.818424 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.purchase_prices"
[0m04:49:25.831847 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m04:49:25.834131 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: BEGIN
[0m04:49:25.838194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:49:25.854374 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m04:49:25.856760 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m04:49:25.859247 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */

  
    

  create  table "amn_datawarehouse"."public"."purchase_prices__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    Brand,
    PurchasePrice
FROM public.purchase_prices
  );
  
[0m04:49:25.862814 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.purchase_prices" does not exist
LINE 15: FROM public.purchase_prices
              ^

[0m04:49:25.865835 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: ROLLBACK
[0m04:49:25.869730 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: Close
[0m04:49:25.881678 [debug] [Thread-1 (]: Database Error in model purchase_prices (models/purchase_prices.sql)
  relation "public.purchase_prices" does not exist
  LINE 15: FROM public.purchase_prices
                ^
  compiled code at target/run/amn_dbt/models/purchase_prices.sql
[0m04:49:25.889045 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b32d0b08-834d-4060-b9a4-4034c8251185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb6266ef30>]}
[0m04:49:25.891955 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.purchase_prices ................... [[31mERROR[0m in 0.22s]
[0m04:49:25.895210 [debug] [Thread-1 (]: Finished running node model.amn_dbt.purchase_prices
[0m04:49:25.900548 [debug] [Thread-1 (]: Began running node model.amn_dbt.sales
[0m04:49:25.903329 [debug] [Thread-4 (]: Marking all children of 'model.amn_dbt.purchase_prices' to be skipped because of status 'error'.  Reason: Database Error in model purchase_prices (models/purchase_prices.sql)
  relation "public.purchase_prices" does not exist
  LINE 15: FROM public.purchase_prices
                ^
  compiled code at target/run/amn_dbt/models/purchase_prices.sql.
[0m04:49:25.905714 [info ] [Thread-1 (]: 2 of 4 START sql table model public.sales ...................................... [RUN]
[0m04:49:25.912045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.amn_dbt.purchase_prices, now model.amn_dbt.sales)
[0m04:49:25.914937 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.sales
[0m04:49:25.924586 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.sales"
[0m04:49:25.942548 [debug] [Thread-1 (]: Began executing node model.amn_dbt.sales
[0m04:49:25.960860 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.sales"
[0m04:49:25.978528 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m04:49:25.981267 [debug] [Thread-1 (]: On model.amn_dbt.sales: BEGIN
[0m04:49:25.985649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:49:26.008208 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m04:49:26.011281 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m04:49:26.013497 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */

  
    

  create  table "amn_datawarehouse"."public"."sales__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    InventoryId,
    Store,
    Description AS SalesDescription, 
    SalesPrice,
    Brand
FROM public.sales
  );
  
[0m04:49:26.022250 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.sales" does not exist
LINE 18: FROM public.sales
              ^

[0m04:49:26.024933 [debug] [Thread-1 (]: On model.amn_dbt.sales: ROLLBACK
[0m04:49:26.027590 [debug] [Thread-1 (]: On model.amn_dbt.sales: Close
[0m04:49:26.039720 [debug] [Thread-1 (]: Database Error in model sales (models/sales.sql)
  relation "public.sales" does not exist
  LINE 18: FROM public.sales
                ^
  compiled code at target/run/amn_dbt/models/sales.sql
[0m04:49:26.042798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b32d0b08-834d-4060-b9a4-4034c8251185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb6256c290>]}
[0m04:49:26.046028 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.sales ............................. [[31mERROR[0m in 0.13s]
[0m04:49:26.050294 [debug] [Thread-1 (]: Finished running node model.amn_dbt.sales
[0m04:49:26.056343 [debug] [Thread-4 (]: Marking all children of 'model.amn_dbt.sales' to be skipped because of status 'error'.  Reason: Database Error in model sales (models/sales.sql)
  relation "public.sales" does not exist
  LINE 18: FROM public.sales
                ^
  compiled code at target/run/amn_dbt/models/sales.sql.
[0m04:49:26.060607 [debug] [Thread-1 (]: Began running node model.amn_dbt.profit_and_margin
[0m04:49:26.063093 [info ] [Thread-1 (]: 3 of 4 SKIP relation public.profit_and_margin .................................. [[33mSKIP[0m]
[0m04:49:26.069348 [debug] [Thread-1 (]: Finished running node model.amn_dbt.profit_and_margin
[0m04:49:26.073677 [debug] [Thread-1 (]: Began running node model.amn_dbt.least_profitability
[0m04:49:26.076688 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.least_profitability ................................ [[33mSKIP[0m]
[0m04:49:26.080035 [debug] [Thread-1 (]: Finished running node model.amn_dbt.least_profitability
[0m04:49:26.088198 [debug] [MainThread]: Using postgres connection "master"
[0m04:49:26.090908 [debug] [MainThread]: On master: BEGIN
[0m04:49:26.092766 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:49:26.112248 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m04:49:26.115934 [debug] [MainThread]: On master: COMMIT
[0m04:49:26.120891 [debug] [MainThread]: Using postgres connection "master"
[0m04:49:26.123833 [debug] [MainThread]: On master: COMMIT
[0m04:49:26.126641 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:49:26.129119 [debug] [MainThread]: On master: Close
[0m04:49:26.132913 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:49:26.138490 [debug] [MainThread]: Connection 'model.amn_dbt.sales' was properly closed.
[0m04:49:26.142268 [info ] [MainThread]: 
[0m04:49:26.146186 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m04:49:26.156871 [debug] [MainThread]: Command end result
[0m04:49:26.407723 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m04:49:26.421906 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m04:49:26.453986 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m04:49:26.457106 [info ] [MainThread]: 
[0m04:49:26.460087 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m04:49:26.464244 [info ] [MainThread]: 
[0m04:49:26.470034 [error] [MainThread]:   Database Error in model purchase_prices (models/purchase_prices.sql)
  relation "public.purchase_prices" does not exist
  LINE 15: FROM public.purchase_prices
                ^
  compiled code at target/run/amn_dbt/models/purchase_prices.sql
[0m04:49:26.473865 [info ] [MainThread]: 
[0m04:49:26.477515 [error] [MainThread]:   Database Error in model sales (models/sales.sql)
  relation "public.sales" does not exist
  LINE 18: FROM public.sales
                ^
  compiled code at target/run/amn_dbt/models/sales.sql
[0m04:49:26.482739 [info ] [MainThread]: 
[0m04:49:26.488632 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=2 TOTAL=4
[0m04:49:26.493869 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.005503, "process_in_blocks": "8", "process_kernel_time": 2.936439, "process_mem_max_rss": "112780", "process_out_blocks": "1600", "process_user_time": 16.296736}
[0m04:49:26.498632 [debug] [MainThread]: Command `dbt run` failed at 04:49:26.497898 after 9.01 seconds
[0m04:49:26.502468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb64373830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb64cc40e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb64cc4ef0>]}
[0m04:49:26.506325 [debug] [MainThread]: Flushing usage events
[0m04:49:27.214418 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:57:09.045685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c62189490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c62529610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c61341be0>]}


============================== 04:57:09.085626 | 3f3fe738-5eaf-4c26-b511-644d05f03430 ==============================
[0m04:57:09.085626 [info ] [MainThread]: Running with dbt=1.9.0
[0m04:57:09.092900 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:57:10.945286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f3fe738-5eaf-4c26-b511-644d05f03430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c612615e0>]}
[0m04:57:11.312656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f3fe738-5eaf-4c26-b511-644d05f03430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c6115af90>]}
[0m04:57:11.320619 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m04:57:11.651683 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m04:57:12.215436 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:57:12.219137 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:57:12.410642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f3fe738-5eaf-4c26-b511-644d05f03430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c5f9fb6b0>]}
[0m04:57:12.708916 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m04:57:12.723408 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m04:57:12.780862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f3fe738-5eaf-4c26-b511-644d05f03430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c5f6ec530>]}
[0m04:57:12.783739 [info ] [MainThread]: Found 4 models, 429 macros
[0m04:57:12.787160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f3fe738-5eaf-4c26-b511-644d05f03430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c5f6e60c0>]}
[0m04:57:12.796316 [info ] [MainThread]: 
[0m04:57:12.802650 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:57:12.808220 [info ] [MainThread]: 
[0m04:57:12.812613 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:57:12.850523 [debug] [ThreadPool]: Acquiring new postgres connection 'list_amn_datawarehouse'
[0m04:57:13.088482 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse"
[0m04:57:13.091204 [debug] [ThreadPool]: On list_amn_datawarehouse: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse"} */

    select distinct nspname from pg_namespace
  
[0m04:57:13.093374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:57:13.129561 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.036 seconds
[0m04:57:13.137545 [debug] [ThreadPool]: On list_amn_datawarehouse: Close
[0m04:57:13.148511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_amn_datawarehouse, now list_amn_datawarehouse_public)
[0m04:57:13.179083 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m04:57:13.182129 [debug] [ThreadPool]: On list_amn_datawarehouse_public: BEGIN
[0m04:57:13.184765 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:57:13.204944 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m04:57:13.208213 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m04:57:13.211311 [debug] [ThreadPool]: On list_amn_datawarehouse_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse_public"} */
select
      'amn_datawarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m04:57:13.224055 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m04:57:13.229661 [debug] [ThreadPool]: On list_amn_datawarehouse_public: ROLLBACK
[0m04:57:13.232988 [debug] [ThreadPool]: On list_amn_datawarehouse_public: Close
[0m04:57:13.256972 [debug] [MainThread]: Using postgres connection "master"
[0m04:57:13.260531 [debug] [MainThread]: On master: BEGIN
[0m04:57:13.263498 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:57:13.284168 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m04:57:13.289259 [debug] [MainThread]: Using postgres connection "master"
[0m04:57:13.293442 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:57:13.312969 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m04:57:13.337937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f3fe738-5eaf-4c26-b511-644d05f03430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c5ea8cfe0>]}
[0m04:57:13.341759 [debug] [MainThread]: On master: ROLLBACK
[0m04:57:13.345981 [debug] [MainThread]: Using postgres connection "master"
[0m04:57:13.354772 [debug] [MainThread]: On master: BEGIN
[0m04:57:13.359762 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m04:57:13.363962 [debug] [MainThread]: On master: COMMIT
[0m04:57:13.374459 [debug] [MainThread]: Using postgres connection "master"
[0m04:57:13.378239 [debug] [MainThread]: On master: COMMIT
[0m04:57:13.399207 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m04:57:13.402695 [debug] [MainThread]: On master: Close
[0m04:57:13.411095 [debug] [Thread-1 (]: Began running node model.amn_dbt.purchase_prices
[0m04:57:13.414875 [info ] [Thread-1 (]: 1 of 4 START sql table model public.purchase_prices ............................ [RUN]
[0m04:57:13.427043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_amn_datawarehouse_public, now model.amn_dbt.purchase_prices)
[0m04:57:13.430224 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.purchase_prices
[0m04:57:13.478882 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.purchase_prices"
[0m04:57:13.599372 [debug] [Thread-1 (]: Began executing node model.amn_dbt.purchase_prices
[0m04:57:13.737951 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.purchase_prices"
[0m04:57:13.754663 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m04:57:13.757845 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: BEGIN
[0m04:57:13.761062 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:13.780121 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m04:57:13.783386 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m04:57:13.788646 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */

  
    

  create  table "amn_datawarehouse"."public"."purchase_prices__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    Brand,
    PurchasePrice
FROM public.purchase_prices
  );
  
[0m04:57:13.793249 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.purchase_prices" does not exist
LINE 15: FROM public.purchase_prices
              ^

[0m04:57:13.796838 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: ROLLBACK
[0m04:57:13.800811 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: Close
[0m04:57:13.817786 [debug] [Thread-1 (]: Database Error in model purchase_prices (models/purchase_prices.sql)
  relation "public.purchase_prices" does not exist
  LINE 15: FROM public.purchase_prices
                ^
  compiled code at target/run/amn_dbt/models/purchase_prices.sql
[0m04:57:13.829850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f3fe738-5eaf-4c26-b511-644d05f03430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c5f74f500>]}
[0m04:57:13.833648 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.purchase_prices ................... [[31mERROR[0m in 0.40s]
[0m04:57:13.838348 [debug] [Thread-1 (]: Finished running node model.amn_dbt.purchase_prices
[0m04:57:13.845117 [debug] [Thread-1 (]: Began running node model.amn_dbt.sales
[0m04:57:13.847271 [debug] [Thread-4 (]: Marking all children of 'model.amn_dbt.purchase_prices' to be skipped because of status 'error'.  Reason: Database Error in model purchase_prices (models/purchase_prices.sql)
  relation "public.purchase_prices" does not exist
  LINE 15: FROM public.purchase_prices
                ^
  compiled code at target/run/amn_dbt/models/purchase_prices.sql.
[0m04:57:13.850684 [info ] [Thread-1 (]: 2 of 4 START sql table model public.sales ...................................... [RUN]
[0m04:57:13.861011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.amn_dbt.purchase_prices, now model.amn_dbt.sales)
[0m04:57:13.864436 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.sales
[0m04:57:13.875323 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.sales"
[0m04:57:13.897372 [debug] [Thread-1 (]: Began executing node model.amn_dbt.sales
[0m04:57:13.917572 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.sales"
[0m04:57:13.943458 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m04:57:13.946616 [debug] [Thread-1 (]: On model.amn_dbt.sales: BEGIN
[0m04:57:13.949655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:13.979168 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m04:57:13.983146 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m04:57:13.986418 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */

  
    

  create  table "amn_datawarehouse"."public"."sales__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    InventoryId,
    Store,
    Description AS SalesDescription, 
    SalesPrice,
    Brand
FROM public.sales
  );
  
[0m04:57:13.995731 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.sales" does not exist
LINE 18: FROM public.sales
              ^

[0m04:57:14.000285 [debug] [Thread-1 (]: On model.amn_dbt.sales: ROLLBACK
[0m04:57:14.004930 [debug] [Thread-1 (]: On model.amn_dbt.sales: Close
[0m04:57:14.017613 [debug] [Thread-1 (]: Database Error in model sales (models/sales.sql)
  relation "public.sales" does not exist
  LINE 18: FROM public.sales
                ^
  compiled code at target/run/amn_dbt/models/sales.sql
[0m04:57:14.020546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f3fe738-5eaf-4c26-b511-644d05f03430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c5cfb3a70>]}
[0m04:57:14.026049 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.sales ............................. [[31mERROR[0m in 0.16s]
[0m04:57:14.030670 [debug] [Thread-1 (]: Finished running node model.amn_dbt.sales
[0m04:57:14.034589 [debug] [Thread-4 (]: Marking all children of 'model.amn_dbt.sales' to be skipped because of status 'error'.  Reason: Database Error in model sales (models/sales.sql)
  relation "public.sales" does not exist
  LINE 18: FROM public.sales
                ^
  compiled code at target/run/amn_dbt/models/sales.sql.
[0m04:57:14.040024 [debug] [Thread-1 (]: Began running node model.amn_dbt.profit_and_margin
[0m04:57:14.043992 [info ] [Thread-1 (]: 3 of 4 SKIP relation public.profit_and_margin .................................. [[33mSKIP[0m]
[0m04:57:14.047747 [debug] [Thread-1 (]: Finished running node model.amn_dbt.profit_and_margin
[0m04:57:14.053705 [debug] [Thread-1 (]: Began running node model.amn_dbt.least_profitability
[0m04:57:14.057892 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.least_profitability ................................ [[33mSKIP[0m]
[0m04:57:14.062574 [debug] [Thread-1 (]: Finished running node model.amn_dbt.least_profitability
[0m04:57:14.068438 [debug] [MainThread]: Using postgres connection "master"
[0m04:57:14.071024 [debug] [MainThread]: On master: BEGIN
[0m04:57:14.074837 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:57:14.098131 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m04:57:14.101048 [debug] [MainThread]: On master: COMMIT
[0m04:57:14.104294 [debug] [MainThread]: Using postgres connection "master"
[0m04:57:14.108381 [debug] [MainThread]: On master: COMMIT
[0m04:57:14.111747 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:57:14.114167 [debug] [MainThread]: On master: Close
[0m04:57:14.117126 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:57:14.119459 [debug] [MainThread]: Connection 'model.amn_dbt.sales' was properly closed.
[0m04:57:14.123540 [info ] [MainThread]: 
[0m04:57:14.128148 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.31 seconds (1.31s).
[0m04:57:14.134980 [debug] [MainThread]: Command end result
[0m04:57:14.279020 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m04:57:14.295156 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m04:57:14.330800 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m04:57:14.333163 [info ] [MainThread]: 
[0m04:57:14.336805 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m04:57:14.342887 [info ] [MainThread]: 
[0m04:57:14.347017 [error] [MainThread]:   Database Error in model purchase_prices (models/purchase_prices.sql)
  relation "public.purchase_prices" does not exist
  LINE 15: FROM public.purchase_prices
                ^
  compiled code at target/run/amn_dbt/models/purchase_prices.sql
[0m04:57:14.351184 [info ] [MainThread]: 
[0m04:57:14.355671 [error] [MainThread]:   Database Error in model sales (models/sales.sql)
  relation "public.sales" does not exist
  LINE 18: FROM public.sales
                ^
  compiled code at target/run/amn_dbt/models/sales.sql
[0m04:57:14.360345 [info ] [MainThread]: 
[0m04:57:14.363723 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=2 TOTAL=4
[0m04:57:14.369913 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.177446, "process_in_blocks": "1680", "process_kernel_time": 1.780804, "process_mem_max_rss": "107112", "process_out_blocks": "0", "process_user_time": 12.987593}
[0m04:57:14.376050 [debug] [MainThread]: Command `dbt run` failed at 04:57:14.375306 after 6.18 seconds
[0m04:57:14.378846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c61961fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c61963230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c6140bce0>]}
[0m04:57:14.381696 [debug] [MainThread]: Flushing usage events
[0m04:57:15.129287 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:58:13.213912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf51bf1010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf524e2540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf520d3410>]}


============================== 04:58:13.219452 | 08fdf8b4-6e45-4902-b3fe-5f8f2fac8a09 ==============================
[0m04:58:13.219452 [info ] [MainThread]: Running with dbt=1.9.0
[0m04:58:13.222019 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m04:58:13.487726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08fdf8b4-6e45-4902-b3fe-5f8f2fac8a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf51c63dd0>]}
[0m04:58:13.578936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08fdf8b4-6e45-4902-b3fe-5f8f2fac8a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf520d3470>]}
[0m04:58:13.581286 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m04:58:13.696585 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m04:58:13.877432 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:58:13.879395 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:58:13.924193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08fdf8b4-6e45-4902-b3fe-5f8f2fac8a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf50306b10>]}
[0m04:58:14.038991 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m04:58:14.049073 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m04:58:14.080975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08fdf8b4-6e45-4902-b3fe-5f8f2fac8a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf4fff4350>]}
[0m04:58:14.082713 [info ] [MainThread]: Found 4 models, 429 macros
[0m04:58:14.085018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08fdf8b4-6e45-4902-b3fe-5f8f2fac8a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf500de510>]}
[0m04:58:14.089277 [info ] [MainThread]: 
[0m04:58:14.091467 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:58:14.093595 [info ] [MainThread]: 
[0m04:58:14.096081 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:58:14.104671 [debug] [ThreadPool]: Acquiring new postgres connection 'list_amn_datawarehouse'
[0m04:58:14.165423 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse"
[0m04:58:14.167136 [debug] [ThreadPool]: On list_amn_datawarehouse: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse"} */

    select distinct nspname from pg_namespace
  
[0m04:58:14.168644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:58:14.181050 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.012 seconds
[0m04:58:14.184111 [debug] [ThreadPool]: On list_amn_datawarehouse: Close
[0m04:58:14.187527 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_amn_datawarehouse, now list_amn_datawarehouse_public)
[0m04:58:14.197086 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m04:58:14.198742 [debug] [ThreadPool]: On list_amn_datawarehouse_public: BEGIN
[0m04:58:14.200539 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:58:14.210551 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m04:58:14.212450 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m04:58:14.214148 [debug] [ThreadPool]: On list_amn_datawarehouse_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse_public"} */
select
      'amn_datawarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m04:58:14.219026 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m04:58:14.222163 [debug] [ThreadPool]: On list_amn_datawarehouse_public: ROLLBACK
[0m04:58:14.224052 [debug] [ThreadPool]: On list_amn_datawarehouse_public: Close
[0m04:58:14.232368 [debug] [MainThread]: Using postgres connection "master"
[0m04:58:14.234461 [debug] [MainThread]: On master: BEGIN
[0m04:58:14.236336 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:58:14.246769 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m04:58:14.248859 [debug] [MainThread]: Using postgres connection "master"
[0m04:58:14.250887 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:58:14.256503 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m04:58:14.259281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08fdf8b4-6e45-4902-b3fe-5f8f2fac8a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf51b1b320>]}
[0m04:58:14.260884 [debug] [MainThread]: On master: ROLLBACK
[0m04:58:14.262979 [debug] [MainThread]: Using postgres connection "master"
[0m04:58:14.264526 [debug] [MainThread]: On master: BEGIN
[0m04:58:14.266542 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m04:58:14.268296 [debug] [MainThread]: On master: COMMIT
[0m04:58:14.269800 [debug] [MainThread]: Using postgres connection "master"
[0m04:58:14.271120 [debug] [MainThread]: On master: COMMIT
[0m04:58:14.272823 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:58:14.274382 [debug] [MainThread]: On master: Close
[0m04:58:14.278924 [debug] [Thread-1 (]: Began running node model.amn_dbt.purchase_prices
[0m04:58:14.281512 [info ] [Thread-1 (]: 1 of 4 START sql table model public.purchase_prices ............................ [RUN]
[0m04:58:14.284498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_amn_datawarehouse_public, now model.amn_dbt.purchase_prices)
[0m04:58:14.286569 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.purchase_prices
[0m04:58:14.300211 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.purchase_prices"
[0m04:58:14.308985 [debug] [Thread-1 (]: Began executing node model.amn_dbt.purchase_prices
[0m04:58:14.386473 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.purchase_prices"
[0m04:58:14.398540 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m04:58:14.400290 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: BEGIN
[0m04:58:14.401689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:58:14.411697 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m04:58:14.413482 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m04:58:14.415263 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */

  
    

  create  table "amn_datawarehouse"."public"."purchase_prices__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    Brand,
    PurchasePrice
FROM public.purchase_prices
  );
  
[0m04:58:14.417720 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.purchase_prices" does not exist
LINE 15: FROM public.purchase_prices
              ^

[0m04:58:14.419494 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: ROLLBACK
[0m04:58:14.421535 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: Close
[0m04:58:14.428859 [debug] [Thread-1 (]: Database Error in model purchase_prices (models/purchase_prices.sql)
  relation "public.purchase_prices" does not exist
  LINE 15: FROM public.purchase_prices
                ^
  compiled code at target/run/amn_dbt/models/purchase_prices.sql
[0m04:58:14.432429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08fdf8b4-6e45-4902-b3fe-5f8f2fac8a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf500dd580>]}
[0m04:58:14.434677 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.purchase_prices ................... [[31mERROR[0m in 0.15s]
[0m04:58:14.437408 [debug] [Thread-1 (]: Finished running node model.amn_dbt.purchase_prices
[0m04:58:14.439072 [debug] [Thread-1 (]: Began running node model.amn_dbt.sales
[0m04:58:14.440226 [debug] [Thread-4 (]: Marking all children of 'model.amn_dbt.purchase_prices' to be skipped because of status 'error'.  Reason: Database Error in model purchase_prices (models/purchase_prices.sql)
  relation "public.purchase_prices" does not exist
  LINE 15: FROM public.purchase_prices
                ^
  compiled code at target/run/amn_dbt/models/purchase_prices.sql.
[0m04:58:14.442812 [info ] [Thread-1 (]: 2 of 4 START sql table model public.sales ...................................... [RUN]
[0m04:58:14.451227 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.amn_dbt.purchase_prices, now model.amn_dbt.sales)
[0m04:58:14.453359 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.sales
[0m04:58:14.457605 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.sales"
[0m04:58:14.467112 [debug] [Thread-1 (]: Began executing node model.amn_dbt.sales
[0m04:58:14.473714 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.sales"
[0m04:58:14.482655 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m04:58:14.484083 [debug] [Thread-1 (]: On model.amn_dbt.sales: BEGIN
[0m04:58:14.485378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:58:14.496153 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m04:58:14.497966 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m04:58:14.499741 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */

  
    

  create  table "amn_datawarehouse"."public"."sales__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    InventoryId,
    Store,
    Description AS SalesDescription, 
    SalesPrice,
    Brand
FROM public.sales
  );
  
[0m04:58:14.502854 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.sales" does not exist
LINE 18: FROM public.sales
              ^

[0m04:58:14.504874 [debug] [Thread-1 (]: On model.amn_dbt.sales: ROLLBACK
[0m04:58:14.507637 [debug] [Thread-1 (]: On model.amn_dbt.sales: Close
[0m04:58:14.513491 [debug] [Thread-1 (]: Database Error in model sales (models/sales.sql)
  relation "public.sales" does not exist
  LINE 18: FROM public.sales
                ^
  compiled code at target/run/amn_dbt/models/sales.sql
[0m04:58:14.515358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08fdf8b4-6e45-4902-b3fe-5f8f2fac8a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf4d8b7680>]}
[0m04:58:14.517581 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.sales ............................. [[31mERROR[0m in 0.06s]
[0m04:58:14.520114 [debug] [Thread-1 (]: Finished running node model.amn_dbt.sales
[0m04:58:14.522539 [debug] [Thread-4 (]: Marking all children of 'model.amn_dbt.sales' to be skipped because of status 'error'.  Reason: Database Error in model sales (models/sales.sql)
  relation "public.sales" does not exist
  LINE 18: FROM public.sales
                ^
  compiled code at target/run/amn_dbt/models/sales.sql.
[0m04:58:14.524820 [debug] [Thread-1 (]: Began running node model.amn_dbt.profit_and_margin
[0m04:58:14.526356 [info ] [Thread-1 (]: 3 of 4 SKIP relation public.profit_and_margin .................................. [[33mSKIP[0m]
[0m04:58:14.528785 [debug] [Thread-1 (]: Finished running node model.amn_dbt.profit_and_margin
[0m04:58:14.531527 [debug] [Thread-1 (]: Began running node model.amn_dbt.least_profitability
[0m04:58:14.534105 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.least_profitability ................................ [[33mSKIP[0m]
[0m04:58:14.536857 [debug] [Thread-1 (]: Finished running node model.amn_dbt.least_profitability
[0m04:58:14.540997 [debug] [MainThread]: Using postgres connection "master"
[0m04:58:14.543153 [debug] [MainThread]: On master: BEGIN
[0m04:58:14.544576 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:58:14.556860 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m04:58:14.560311 [debug] [MainThread]: On master: COMMIT
[0m04:58:14.562528 [debug] [MainThread]: Using postgres connection "master"
[0m04:58:14.564385 [debug] [MainThread]: On master: COMMIT
[0m04:58:14.565998 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:58:14.567884 [debug] [MainThread]: On master: Close
[0m04:58:14.569566 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:58:14.570925 [debug] [MainThread]: Connection 'model.amn_dbt.sales' was properly closed.
[0m04:58:14.572422 [info ] [MainThread]: 
[0m04:58:14.575659 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m04:58:14.579970 [debug] [MainThread]: Command end result
[0m04:58:14.633771 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m04:58:14.641903 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m04:58:14.658556 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m04:58:14.660363 [info ] [MainThread]: 
[0m04:58:14.663698 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m04:58:14.665943 [info ] [MainThread]: 
[0m04:58:14.668106 [error] [MainThread]:   Database Error in model purchase_prices (models/purchase_prices.sql)
  relation "public.purchase_prices" does not exist
  LINE 15: FROM public.purchase_prices
                ^
  compiled code at target/run/amn_dbt/models/purchase_prices.sql
[0m04:58:14.670601 [info ] [MainThread]: 
[0m04:58:14.673176 [error] [MainThread]:   Database Error in model sales (models/sales.sql)
  relation "public.sales" does not exist
  LINE 18: FROM public.sales
                ^
  compiled code at target/run/amn_dbt/models/sales.sql
[0m04:58:14.675415 [info ] [MainThread]: 
[0m04:58:14.679330 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=2 TOTAL=4
[0m04:58:14.684811 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6062788, "process_in_blocks": "1048", "process_kernel_time": 0.31641, "process_mem_max_rss": "106992", "process_out_blocks": "0", "process_user_time": 2.808141}
[0m04:58:14.686786 [debug] [MainThread]: Command `dbt run` failed at 04:58:14.686512 after 1.61 seconds
[0m04:58:14.688020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf526c4b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf50073e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf4f24d4f0>]}
[0m04:58:14.689325 [debug] [MainThread]: Flushing usage events
[0m04:58:15.425680 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:59:31.360774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29943d7500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2993cfb2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29946df590>]}


============================== 04:59:31.366091 | e245b242-c460-452e-9be9-5df7ef0e9894 ==============================
[0m04:59:31.366091 [info ] [MainThread]: Running with dbt=1.9.0
[0m04:59:31.368451 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:59:31.628892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e245b242-c460-452e-9be9-5df7ef0e9894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2994920740>]}
[0m04:59:31.720980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e245b242-c460-452e-9be9-5df7ef0e9894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299226f0b0>]}
[0m04:59:31.723451 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m04:59:31.848592 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m04:59:32.025943 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:59:32.027825 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:59:32.070134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e245b242-c460-452e-9be9-5df7ef0e9894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29921a8ef0>]}
[0m04:59:32.194696 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m04:59:32.211542 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m04:59:32.246672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e245b242-c460-452e-9be9-5df7ef0e9894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2991e84290>]}
[0m04:59:32.248903 [info ] [MainThread]: Found 4 models, 429 macros
[0m04:59:32.251335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e245b242-c460-452e-9be9-5df7ef0e9894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2991fdb9b0>]}
[0m04:59:32.257096 [info ] [MainThread]: 
[0m04:59:32.259779 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:59:32.262294 [info ] [MainThread]: 
[0m04:59:32.265300 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:59:32.280345 [debug] [ThreadPool]: Acquiring new postgres connection 'list_amn_datawarehouse'
[0m04:59:32.354838 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse"
[0m04:59:32.356704 [debug] [ThreadPool]: On list_amn_datawarehouse: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse"} */

    select distinct nspname from pg_namespace
  
[0m04:59:32.358474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:59:32.373723 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.015 seconds
[0m04:59:32.377475 [debug] [ThreadPool]: On list_amn_datawarehouse: Close
[0m04:59:32.382111 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_amn_datawarehouse, now list_amn_datawarehouse_public)
[0m04:59:32.397879 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m04:59:32.399767 [debug] [ThreadPool]: On list_amn_datawarehouse_public: BEGIN
[0m04:59:32.401790 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:59:32.413431 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m04:59:32.415886 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m04:59:32.418505 [debug] [ThreadPool]: On list_amn_datawarehouse_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse_public"} */
select
      'amn_datawarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m04:59:32.426421 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.005 seconds
[0m04:59:32.429699 [debug] [ThreadPool]: On list_amn_datawarehouse_public: ROLLBACK
[0m04:59:32.431770 [debug] [ThreadPool]: On list_amn_datawarehouse_public: Close
[0m04:59:32.442696 [debug] [MainThread]: Using postgres connection "master"
[0m04:59:32.444856 [debug] [MainThread]: On master: BEGIN
[0m04:59:32.446507 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:59:32.458427 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m04:59:32.460680 [debug] [MainThread]: Using postgres connection "master"
[0m04:59:32.463669 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:59:32.471393 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m04:59:32.477290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e245b242-c460-452e-9be9-5df7ef0e9894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29922e97c0>]}
[0m04:59:32.480249 [debug] [MainThread]: On master: ROLLBACK
[0m04:59:32.482412 [debug] [MainThread]: Using postgres connection "master"
[0m04:59:32.484333 [debug] [MainThread]: On master: BEGIN
[0m04:59:32.486572 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m04:59:32.488726 [debug] [MainThread]: On master: COMMIT
[0m04:59:32.490768 [debug] [MainThread]: Using postgres connection "master"
[0m04:59:32.493356 [debug] [MainThread]: On master: COMMIT
[0m04:59:32.496570 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m04:59:32.498536 [debug] [MainThread]: On master: Close
[0m04:59:32.503406 [debug] [Thread-1 (]: Began running node model.amn_dbt.purchase_prices
[0m04:59:32.505307 [info ] [Thread-1 (]: 1 of 4 START sql table model public.purchase_prices ............................ [RUN]
[0m04:59:32.507957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_amn_datawarehouse_public, now model.amn_dbt.purchase_prices)
[0m04:59:32.510736 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.purchase_prices
[0m04:59:32.524399 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.purchase_prices"
[0m04:59:32.539013 [debug] [Thread-1 (]: Began executing node model.amn_dbt.purchase_prices
[0m04:59:32.612035 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.purchase_prices"
[0m04:59:32.621186 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m04:59:32.622845 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: BEGIN
[0m04:59:32.624467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:59:32.636205 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m04:59:32.638614 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m04:59:32.641193 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */

  
    

  create  table "amn_datawarehouse"."public"."purchase_prices__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    Brand,
    PurchasePrice
FROM public.purchase_prices
  );
  
[0m04:59:32.645566 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "brand" does not exist
LINE 13:     Brand,
             ^

[0m04:59:32.648279 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: ROLLBACK
[0m04:59:32.650979 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: Close
[0m04:59:32.662072 [debug] [Thread-1 (]: Database Error in model purchase_prices (models/purchase_prices.sql)
  column "brand" does not exist
  LINE 13:     Brand,
               ^
  compiled code at target/run/amn_dbt/models/purchase_prices.sql
[0m04:59:32.666856 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e245b242-c460-452e-9be9-5df7ef0e9894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2991229340>]}
[0m04:59:32.669707 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.purchase_prices ................... [[31mERROR[0m in 0.16s]
[0m04:59:32.672826 [debug] [Thread-1 (]: Finished running node model.amn_dbt.purchase_prices
[0m04:59:32.675027 [debug] [Thread-1 (]: Began running node model.amn_dbt.sales
[0m04:59:32.676575 [debug] [Thread-4 (]: Marking all children of 'model.amn_dbt.purchase_prices' to be skipped because of status 'error'.  Reason: Database Error in model purchase_prices (models/purchase_prices.sql)
  column "brand" does not exist
  LINE 13:     Brand,
               ^
  compiled code at target/run/amn_dbt/models/purchase_prices.sql.
[0m04:59:32.678109 [info ] [Thread-1 (]: 2 of 4 START sql table model public.sales ...................................... [RUN]
[0m04:59:32.684722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.amn_dbt.purchase_prices, now model.amn_dbt.sales)
[0m04:59:32.687947 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.sales
[0m04:59:32.695172 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.sales"
[0m04:59:32.706583 [debug] [Thread-1 (]: Began executing node model.amn_dbt.sales
[0m04:59:32.716717 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.sales"
[0m04:59:32.732060 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m04:59:32.735520 [debug] [Thread-1 (]: On model.amn_dbt.sales: BEGIN
[0m04:59:32.738402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:59:32.758267 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m04:59:32.761663 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m04:59:32.764357 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */

  
    

  create  table "amn_datawarehouse"."public"."sales__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    InventoryId,
    Store,
    Description AS SalesDescription, 
    SalesPrice,
    Brand
FROM public.sales
  );
  
[0m04:59:32.767946 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "inventoryid" does not exist
LINE 13:     InventoryId,
             ^

[0m04:59:32.771539 [debug] [Thread-1 (]: On model.amn_dbt.sales: ROLLBACK
[0m04:59:32.773992 [debug] [Thread-1 (]: On model.amn_dbt.sales: Close
[0m04:59:32.782532 [debug] [Thread-1 (]: Database Error in model sales (models/sales.sql)
  column "inventoryid" does not exist
  LINE 13:     InventoryId,
               ^
  compiled code at target/run/amn_dbt/models/sales.sql
[0m04:59:32.785961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e245b242-c460-452e-9be9-5df7ef0e9894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299114bd40>]}
[0m04:59:32.789744 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.sales ............................. [[31mERROR[0m in 0.10s]
[0m04:59:32.794291 [debug] [Thread-1 (]: Finished running node model.amn_dbt.sales
[0m04:59:32.797291 [debug] [Thread-4 (]: Marking all children of 'model.amn_dbt.sales' to be skipped because of status 'error'.  Reason: Database Error in model sales (models/sales.sql)
  column "inventoryid" does not exist
  LINE 13:     InventoryId,
               ^
  compiled code at target/run/amn_dbt/models/sales.sql.
[0m04:59:32.801549 [debug] [Thread-1 (]: Began running node model.amn_dbt.profit_and_margin
[0m04:59:32.803707 [info ] [Thread-1 (]: 3 of 4 SKIP relation public.profit_and_margin .................................. [[33mSKIP[0m]
[0m04:59:32.806717 [debug] [Thread-1 (]: Finished running node model.amn_dbt.profit_and_margin
[0m04:59:32.810201 [debug] [Thread-1 (]: Began running node model.amn_dbt.least_profitability
[0m04:59:32.812284 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.least_profitability ................................ [[33mSKIP[0m]
[0m04:59:32.816537 [debug] [Thread-1 (]: Finished running node model.amn_dbt.least_profitability
[0m04:59:32.821107 [debug] [MainThread]: Using postgres connection "master"
[0m04:59:32.823635 [debug] [MainThread]: On master: BEGIN
[0m04:59:32.826525 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:59:32.842111 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m04:59:32.844525 [debug] [MainThread]: On master: COMMIT
[0m04:59:32.846603 [debug] [MainThread]: Using postgres connection "master"
[0m04:59:32.848601 [debug] [MainThread]: On master: COMMIT
[0m04:59:32.850867 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:59:32.852978 [debug] [MainThread]: On master: Close
[0m04:59:32.855665 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:59:32.858509 [debug] [MainThread]: Connection 'model.amn_dbt.sales' was properly closed.
[0m04:59:32.863964 [info ] [MainThread]: 
[0m04:59:32.866214 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m04:59:32.871255 [debug] [MainThread]: Command end result
[0m04:59:32.949304 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m04:59:32.959979 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m04:59:32.990125 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m04:59:32.993389 [info ] [MainThread]: 
[0m04:59:32.997998 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m04:59:33.001981 [info ] [MainThread]: 
[0m04:59:33.005917 [error] [MainThread]:   Database Error in model purchase_prices (models/purchase_prices.sql)
  column "brand" does not exist
  LINE 13:     Brand,
               ^
  compiled code at target/run/amn_dbt/models/purchase_prices.sql
[0m04:59:33.008908 [info ] [MainThread]: 
[0m04:59:33.012170 [error] [MainThread]:   Database Error in model sales (models/sales.sql)
  column "inventoryid" does not exist
  LINE 13:     InventoryId,
               ^
  compiled code at target/run/amn_dbt/models/sales.sql
[0m04:59:33.015644 [info ] [MainThread]: 
[0m04:59:33.019182 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=2 TOTAL=4
[0m04:59:33.023166 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7957262, "process_in_blocks": "0", "process_kernel_time": 0.318021, "process_mem_max_rss": "108864", "process_out_blocks": "0", "process_user_time": 3.021207}
[0m04:59:33.025641 [debug] [MainThread]: Command `dbt run` failed at 04:59:33.025352 after 1.80 seconds
[0m04:59:33.027431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29940e8620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2993a7fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2996204cb0>]}
[0m04:59:33.029904 [debug] [MainThread]: Flushing usage events
[0m04:59:33.879987 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:09:17.371582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac00ca720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9abdc605f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9abdf34bc0>]}


============================== 05:09:17.504134 | f4592684-f7f7-4fe7-8b22-f08978d41000 ==============================
[0m05:09:17.504134 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:09:17.554721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:09:19.304289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4592684-f7f7-4fe7-8b22-f08978d41000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9abe211580>]}
[0m05:09:19.536644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4592684-f7f7-4fe7-8b22-f08978d41000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9abc0fcaa0>]}
[0m05:09:19.539579 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:09:19.936140 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:09:20.503694 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:09:20.506759 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:09:20.702341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4592684-f7f7-4fe7-8b22-f08978d41000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9abe236630>]}
[0m05:09:21.021628 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m05:09:21.038769 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m05:09:21.143589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4592684-f7f7-4fe7-8b22-f08978d41000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9abbff8200>]}
[0m05:09:21.149187 [info ] [MainThread]: Found 4 models, 429 macros
[0m05:09:21.153555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4592684-f7f7-4fe7-8b22-f08978d41000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9abbfaa450>]}
[0m05:09:21.164395 [info ] [MainThread]: 
[0m05:09:21.169273 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:09:21.173049 [info ] [MainThread]: 
[0m05:09:21.176991 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:09:21.202999 [debug] [ThreadPool]: Acquiring new postgres connection 'list_amn_datawarehouse'
[0m05:09:21.323212 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse"
[0m05:09:21.325518 [debug] [ThreadPool]: On list_amn_datawarehouse: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse"} */

    select distinct nspname from pg_namespace
  
[0m05:09:21.327910 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:09:21.367494 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.040 seconds
[0m05:09:21.372143 [debug] [ThreadPool]: On list_amn_datawarehouse: Close
[0m05:09:21.377739 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_amn_datawarehouse, now list_amn_datawarehouse_public)
[0m05:09:21.409252 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m05:09:21.412025 [debug] [ThreadPool]: On list_amn_datawarehouse_public: BEGIN
[0m05:09:21.415013 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:09:21.435560 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m05:09:21.440201 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m05:09:21.444942 [debug] [ThreadPool]: On list_amn_datawarehouse_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse_public"} */
select
      'amn_datawarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m05:09:21.461299 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m05:09:21.472410 [debug] [ThreadPool]: On list_amn_datawarehouse_public: ROLLBACK
[0m05:09:21.476795 [debug] [ThreadPool]: On list_amn_datawarehouse_public: Close
[0m05:09:21.500672 [debug] [MainThread]: Using postgres connection "master"
[0m05:09:21.503077 [debug] [MainThread]: On master: BEGIN
[0m05:09:21.505328 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:09:21.523621 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m05:09:21.526249 [debug] [MainThread]: Using postgres connection "master"
[0m05:09:21.533174 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:09:21.553341 [debug] [MainThread]: SQL status: SELECT 0 in 0.016 seconds
[0m05:09:21.561975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4592684-f7f7-4fe7-8b22-f08978d41000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9abc0ff860>]}
[0m05:09:21.566189 [debug] [MainThread]: On master: ROLLBACK
[0m05:09:21.570799 [debug] [MainThread]: Using postgres connection "master"
[0m05:09:21.574753 [debug] [MainThread]: On master: BEGIN
[0m05:09:21.583273 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m05:09:21.587618 [debug] [MainThread]: On master: COMMIT
[0m05:09:21.591545 [debug] [MainThread]: Using postgres connection "master"
[0m05:09:21.594627 [debug] [MainThread]: On master: COMMIT
[0m05:09:21.603748 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m05:09:21.606707 [debug] [MainThread]: On master: Close
[0m05:09:21.616152 [debug] [Thread-1 (]: Began running node model.amn_dbt.purchase_prices
[0m05:09:21.619492 [info ] [Thread-1 (]: 1 of 4 START sql table model public.purchase_prices ............................ [RUN]
[0m05:09:21.622302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_amn_datawarehouse_public, now model.amn_dbt.purchase_prices)
[0m05:09:21.625096 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.purchase_prices
[0m05:09:21.647512 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.purchase_prices"
[0m05:09:21.661572 [debug] [Thread-1 (]: Began executing node model.amn_dbt.purchase_prices
[0m05:09:21.817101 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.purchase_prices"
[0m05:09:21.829309 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:09:21.833963 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: BEGIN
[0m05:09:21.835993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:09:21.853533 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m05:09:21.856924 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:09:21.860122 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */

  
    

  create  table "amn_datawarehouse"."public"."purchase_prices__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    Brand,
    PurchasePrice
FROM public.purchase_prices
  );
  
[0m05:09:21.872195 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.009 seconds
[0m05:09:21.889077 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:09:21.891848 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
alter table "amn_datawarehouse"."public"."purchase_prices" rename to "purchase_prices__dbt_backup"
[0m05:09:21.894674 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:09:21.903533 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:09:21.905597 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
alter table "amn_datawarehouse"."public"."purchase_prices__dbt_tmp" rename to "purchase_prices"
[0m05:09:21.908307 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:09:22.061819 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: COMMIT
[0m05:09:22.068342 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:09:22.070745 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: COMMIT
[0m05:09:22.079676 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m05:09:22.105901 [debug] [Thread-1 (]: Applying DROP to: "amn_datawarehouse"."public"."purchase_prices__dbt_backup"
[0m05:09:22.126407 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:09:22.130157 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
drop table if exists "amn_datawarehouse"."public"."purchase_prices__dbt_backup" cascade
[0m05:09:22.142211 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m05:09:22.153857 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: Close
[0m05:09:22.162306 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4592684-f7f7-4fe7-8b22-f08978d41000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9abf926690>]}
[0m05:09:22.167266 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.purchase_prices ....................... [[32mSELECT 0[0m in 0.53s]
[0m05:09:22.172735 [debug] [Thread-1 (]: Finished running node model.amn_dbt.purchase_prices
[0m05:09:22.177043 [debug] [Thread-1 (]: Began running node model.amn_dbt.sales
[0m05:09:22.186534 [info ] [Thread-1 (]: 2 of 4 START sql table model public.sales ...................................... [RUN]
[0m05:09:22.191204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.amn_dbt.purchase_prices, now model.amn_dbt.sales)
[0m05:09:22.194821 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.sales
[0m05:09:22.213132 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.sales"
[0m05:09:22.226683 [debug] [Thread-1 (]: Began executing node model.amn_dbt.sales
[0m05:09:22.239408 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.sales"
[0m05:09:22.252754 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:09:22.254775 [debug] [Thread-1 (]: On model.amn_dbt.sales: BEGIN
[0m05:09:22.256556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:09:22.271720 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m05:09:22.274274 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:09:22.276477 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */

  
    

  create  table "amn_datawarehouse"."public"."sales__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    InventoryId,
    Store,
    Description AS SalesDescription, 
    SalesPrice,
    Brand
FROM public.sales
  );
  
[0m05:09:22.285752 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m05:09:22.293769 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:09:22.296102 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */
alter table "amn_datawarehouse"."public"."sales" rename to "sales__dbt_backup"
[0m05:09:22.300043 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:09:22.308072 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:09:22.310376 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */
alter table "amn_datawarehouse"."public"."sales__dbt_tmp" rename to "sales"
[0m05:09:22.314021 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:09:22.320297 [debug] [Thread-1 (]: On model.amn_dbt.sales: COMMIT
[0m05:09:22.322759 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:09:22.324990 [debug] [Thread-1 (]: On model.amn_dbt.sales: COMMIT
[0m05:09:22.329787 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m05:09:22.340224 [debug] [Thread-1 (]: Applying DROP to: "amn_datawarehouse"."public"."sales__dbt_backup"
[0m05:09:22.342809 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:09:22.344584 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */
drop table if exists "amn_datawarehouse"."public"."sales__dbt_backup" cascade
[0m05:09:22.353093 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m05:09:22.366465 [debug] [Thread-1 (]: On model.amn_dbt.sales: Close
[0m05:09:22.370335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4592684-f7f7-4fe7-8b22-f08978d41000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9abb0f45f0>]}
[0m05:09:22.375398 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.sales ................................. [[32mSELECT 0[0m in 0.18s]
[0m05:09:22.383852 [debug] [Thread-1 (]: Finished running node model.amn_dbt.sales
[0m05:09:22.401367 [debug] [Thread-1 (]: Began running node model.amn_dbt.profit_and_margin
[0m05:09:22.404551 [info ] [Thread-1 (]: 3 of 4 START sql table model public.profit_and_margin .......................... [RUN]
[0m05:09:22.407719 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.amn_dbt.sales, now model.amn_dbt.profit_and_margin)
[0m05:09:22.410441 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.profit_and_margin
[0m05:09:22.434645 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.profit_and_margin"
[0m05:09:22.454884 [debug] [Thread-1 (]: Began executing node model.amn_dbt.profit_and_margin
[0m05:09:22.473125 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.profit_and_margin"
[0m05:09:22.487248 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m05:09:22.489890 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: BEGIN
[0m05:09:22.492147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:09:22.510605 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m05:09:22.515520 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m05:09:22.522396 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.profit_and_margin"} */

  
    

  create  table "amn_datawarehouse"."public"."profit_and_margin__dbt_tmp"
  
  
    as
  
  (
    WITH sales_data AS (
    SELECT 
        s.InventoryId,
        s.Store,
        s.SalesDescription, 
        s.SalesPrice,
        COALESCE(p.PurchasePrice, 0) AS PurchasePrice,
        (s.SalesPrice - COALESCE(p.PurchasePrice, 0)) AS Profit
    FROM 
        "amn_datawarehouse"."public"."sales" AS s 
    LEFT JOIN 
        "amn_datawarehouse"."public"."purchase_prices" AS p
        ON s.Brand = p.Brand
)
SELECT 
    InventoryId,
    Store,
    SalesDescription, 
    SalesPrice,
    PurchasePrice,
    Profit,
    (Profit / NULLIF(SalesPrice, 0)) * 100 AS ProfitMargin
FROM 
    sales_data;
  );
  
[0m05:09:22.526402 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 35:     sales_data;
                       ^

[0m05:09:22.529747 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: ROLLBACK
[0m05:09:22.536543 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: Close
[0m05:09:22.556493 [debug] [Thread-1 (]: Database Error in model profit_and_margin (models/profit_and_margin.sql)
  syntax error at or near ";"
  LINE 35:     sales_data;
                         ^
  compiled code at target/run/amn_dbt/models/profit_and_margin.sql
[0m05:09:22.559776 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4592684-f7f7-4fe7-8b22-f08978d41000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9abdfed730>]}
[0m05:09:22.563555 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.profit_and_margin ................. [[31mERROR[0m in 0.15s]
[0m05:09:22.568298 [debug] [Thread-1 (]: Finished running node model.amn_dbt.profit_and_margin
[0m05:09:22.571679 [debug] [Thread-4 (]: Marking all children of 'model.amn_dbt.profit_and_margin' to be skipped because of status 'error'.  Reason: Database Error in model profit_and_margin (models/profit_and_margin.sql)
  syntax error at or near ";"
  LINE 35:     sales_data;
                         ^
  compiled code at target/run/amn_dbt/models/profit_and_margin.sql.
[0m05:09:22.577450 [debug] [Thread-1 (]: Began running node model.amn_dbt.least_profitability
[0m05:09:22.581659 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.least_profitability ................................ [[33mSKIP[0m]
[0m05:09:22.586209 [debug] [Thread-1 (]: Finished running node model.amn_dbt.least_profitability
[0m05:09:22.592743 [debug] [MainThread]: Using postgres connection "master"
[0m05:09:22.596128 [debug] [MainThread]: On master: BEGIN
[0m05:09:22.602682 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:09:22.622555 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m05:09:22.625769 [debug] [MainThread]: On master: COMMIT
[0m05:09:22.628483 [debug] [MainThread]: Using postgres connection "master"
[0m05:09:22.633976 [debug] [MainThread]: On master: COMMIT
[0m05:09:22.637552 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m05:09:22.640597 [debug] [MainThread]: On master: Close
[0m05:09:22.643803 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:09:22.646573 [debug] [MainThread]: Connection 'model.amn_dbt.profit_and_margin' was properly closed.
[0m05:09:22.650472 [info ] [MainThread]: 
[0m05:09:22.654673 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.47 seconds (1.47s).
[0m05:09:22.661196 [debug] [MainThread]: Command end result
[0m05:09:22.857108 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m05:09:22.874940 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m05:09:22.914129 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m05:09:22.917141 [info ] [MainThread]: 
[0m05:09:22.921333 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m05:09:22.926503 [info ] [MainThread]: 
[0m05:09:22.934887 [error] [MainThread]:   Database Error in model profit_and_margin (models/profit_and_margin.sql)
  syntax error at or near ";"
  LINE 35:     sales_data;
                         ^
  compiled code at target/run/amn_dbt/models/profit_and_margin.sql
[0m05:09:22.939223 [info ] [MainThread]: 
[0m05:09:22.942363 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m05:09:22.950940 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.2505665, "process_in_blocks": "0", "process_kernel_time": 2.715141, "process_mem_max_rss": "107948", "process_out_blocks": "1600", "process_user_time": 13.994205}
[0m05:09:22.954438 [debug] [MainThread]: Command `dbt run` failed at 05:09:22.954111 after 6.25 seconds
[0m05:09:22.957009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9abda601a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9abe5d0e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9abdf36ff0>]}
[0m05:09:22.960176 [debug] [MainThread]: Flushing usage events
[0m05:09:23.698602 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:13:09.100911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82128babd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f821296e0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82136ba810>]}


============================== 05:13:09.135422 | ce861fdd-321d-4937-a56c-e7aacba3877a ==============================
[0m05:13:09.135422 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:13:09.147363 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:13:10.367922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce861fdd-321d-4937-a56c-e7aacba3877a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82122bb950>]}
[0m05:13:10.900225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce861fdd-321d-4937-a56c-e7aacba3877a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8212efc950>]}
[0m05:13:10.905419 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:13:11.604198 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:13:12.584011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:13:12.591246 [debug] [MainThread]: Partial parsing: updated file: amn_dbt://models/profit_and_margin.sql
[0m05:13:14.059596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce861fdd-321d-4937-a56c-e7aacba3877a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82128babd0>]}
[0m05:13:14.273928 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m05:13:14.290335 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m05:13:14.353846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce861fdd-321d-4937-a56c-e7aacba3877a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8210772c30>]}
[0m05:13:14.358973 [info ] [MainThread]: Found 4 models, 429 macros
[0m05:13:14.363235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce861fdd-321d-4937-a56c-e7aacba3877a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82108e5340>]}
[0m05:13:14.374883 [info ] [MainThread]: 
[0m05:13:14.379258 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:13:14.383386 [info ] [MainThread]: 
[0m05:13:14.387823 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:13:14.416385 [debug] [ThreadPool]: Acquiring new postgres connection 'list_amn_datawarehouse'
[0m05:13:14.558138 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse"
[0m05:13:14.560312 [debug] [ThreadPool]: On list_amn_datawarehouse: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse"} */

    select distinct nspname from pg_namespace
  
[0m05:13:14.562202 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:13:14.596017 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.033 seconds
[0m05:13:14.600807 [debug] [ThreadPool]: On list_amn_datawarehouse: Close
[0m05:13:14.608353 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_amn_datawarehouse, now list_amn_datawarehouse_public)
[0m05:13:14.629228 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m05:13:14.631585 [debug] [ThreadPool]: On list_amn_datawarehouse_public: BEGIN
[0m05:13:14.633580 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:13:14.654412 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m05:13:14.657934 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m05:13:14.662872 [debug] [ThreadPool]: On list_amn_datawarehouse_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse_public"} */
select
      'amn_datawarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m05:13:14.673441 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m05:13:14.680268 [debug] [ThreadPool]: On list_amn_datawarehouse_public: ROLLBACK
[0m05:13:14.682767 [debug] [ThreadPool]: On list_amn_datawarehouse_public: Close
[0m05:13:14.699993 [debug] [MainThread]: Using postgres connection "master"
[0m05:13:14.701986 [debug] [MainThread]: On master: BEGIN
[0m05:13:14.703839 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:13:14.722266 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m05:13:14.725719 [debug] [MainThread]: Using postgres connection "master"
[0m05:13:14.729582 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:13:14.747170 [debug] [MainThread]: SQL status: SELECT 0 in 0.012 seconds
[0m05:13:14.752797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce861fdd-321d-4937-a56c-e7aacba3877a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82106e9460>]}
[0m05:13:14.757081 [debug] [MainThread]: On master: ROLLBACK
[0m05:13:14.760288 [debug] [MainThread]: Using postgres connection "master"
[0m05:13:14.762683 [debug] [MainThread]: On master: BEGIN
[0m05:13:14.766389 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:13:14.770976 [debug] [MainThread]: On master: COMMIT
[0m05:13:14.774611 [debug] [MainThread]: Using postgres connection "master"
[0m05:13:14.779570 [debug] [MainThread]: On master: COMMIT
[0m05:13:14.782535 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m05:13:14.784693 [debug] [MainThread]: On master: Close
[0m05:13:14.796718 [debug] [Thread-1 (]: Began running node model.amn_dbt.purchase_prices
[0m05:13:14.801488 [info ] [Thread-1 (]: 1 of 4 START sql table model public.purchase_prices ............................ [RUN]
[0m05:13:14.805357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_amn_datawarehouse_public, now model.amn_dbt.purchase_prices)
[0m05:13:14.811805 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.purchase_prices
[0m05:13:14.847031 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.purchase_prices"
[0m05:13:14.864813 [debug] [Thread-1 (]: Began executing node model.amn_dbt.purchase_prices
[0m05:13:14.995471 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.purchase_prices"
[0m05:13:15.004706 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:13:15.007387 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: BEGIN
[0m05:13:15.010833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:13:15.025615 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m05:13:15.028209 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:13:15.031117 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */

  
    

  create  table "amn_datawarehouse"."public"."purchase_prices__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    Brand,
    PurchasePrice
FROM public.purchase_prices
  );
  
[0m05:13:15.037605 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m05:13:15.052659 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:13:15.055109 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
alter table "amn_datawarehouse"."public"."purchase_prices" rename to "purchase_prices__dbt_backup"
[0m05:13:15.060099 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:13:15.069086 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:13:15.071224 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
alter table "amn_datawarehouse"."public"."purchase_prices__dbt_tmp" rename to "purchase_prices"
[0m05:13:15.074945 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:13:15.128108 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: COMMIT
[0m05:13:15.130324 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:13:15.132055 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: COMMIT
[0m05:13:15.141055 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m05:13:15.157976 [debug] [Thread-1 (]: Applying DROP to: "amn_datawarehouse"."public"."purchase_prices__dbt_backup"
[0m05:13:15.169849 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:13:15.171737 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
drop table if exists "amn_datawarehouse"."public"."purchase_prices__dbt_backup" cascade
[0m05:13:15.178073 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m05:13:15.184814 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: Close
[0m05:13:15.189393 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce861fdd-321d-4937-a56c-e7aacba3877a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f821412e480>]}
[0m05:13:15.192331 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.purchase_prices ....................... [[32mSELECT 0[0m in 0.38s]
[0m05:13:15.197860 [debug] [Thread-1 (]: Finished running node model.amn_dbt.purchase_prices
[0m05:13:15.200287 [debug] [Thread-1 (]: Began running node model.amn_dbt.sales
[0m05:13:15.203652 [info ] [Thread-1 (]: 2 of 4 START sql table model public.sales ...................................... [RUN]
[0m05:13:15.206852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.amn_dbt.purchase_prices, now model.amn_dbt.sales)
[0m05:13:15.210392 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.sales
[0m05:13:15.219962 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.sales"
[0m05:13:15.234950 [debug] [Thread-1 (]: Began executing node model.amn_dbt.sales
[0m05:13:15.247831 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.sales"
[0m05:13:15.263551 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:13:15.267572 [debug] [Thread-1 (]: On model.amn_dbt.sales: BEGIN
[0m05:13:15.271435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:13:15.291818 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m05:13:15.302745 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:13:15.308609 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */

  
    

  create  table "amn_datawarehouse"."public"."sales__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    InventoryId,
    Store,
    Description AS SalesDescription, 
    SalesPrice,
    Brand
FROM public.sales
  );
  
[0m05:13:15.315841 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "description" does not exist
LINE 15:     Description AS SalesDescription, 
             ^

[0m05:13:15.321419 [debug] [Thread-1 (]: On model.amn_dbt.sales: ROLLBACK
[0m05:13:15.326533 [debug] [Thread-1 (]: On model.amn_dbt.sales: Close
[0m05:13:15.350069 [debug] [Thread-1 (]: Database Error in model sales (models/sales.sql)
  column "description" does not exist
  LINE 15:     Description AS SalesDescription, 
               ^
  compiled code at target/run/amn_dbt/models/sales.sql
[0m05:13:15.354189 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce861fdd-321d-4937-a56c-e7aacba3877a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8208f61790>]}
[0m05:13:15.360645 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.sales ............................. [[31mERROR[0m in 0.15s]
[0m05:13:15.367440 [debug] [Thread-1 (]: Finished running node model.amn_dbt.sales
[0m05:13:15.371544 [debug] [Thread-4 (]: Marking all children of 'model.amn_dbt.sales' to be skipped because of status 'error'.  Reason: Database Error in model sales (models/sales.sql)
  column "description" does not exist
  LINE 15:     Description AS SalesDescription, 
               ^
  compiled code at target/run/amn_dbt/models/sales.sql.
[0m05:13:15.380107 [debug] [Thread-1 (]: Began running node model.amn_dbt.profit_and_margin
[0m05:13:15.383777 [info ] [Thread-1 (]: 3 of 4 SKIP relation public.profit_and_margin .................................. [[33mSKIP[0m]
[0m05:13:15.387744 [debug] [Thread-1 (]: Finished running node model.amn_dbt.profit_and_margin
[0m05:13:15.394387 [debug] [Thread-1 (]: Began running node model.amn_dbt.least_profitability
[0m05:13:15.401036 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.least_profitability ................................ [[33mSKIP[0m]
[0m05:13:15.404767 [debug] [Thread-1 (]: Finished running node model.amn_dbt.least_profitability
[0m05:13:15.412053 [debug] [MainThread]: Using postgres connection "master"
[0m05:13:15.417140 [debug] [MainThread]: On master: BEGIN
[0m05:13:15.419262 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:13:15.444160 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m05:13:15.448216 [debug] [MainThread]: On master: COMMIT
[0m05:13:15.451490 [debug] [MainThread]: Using postgres connection "master"
[0m05:13:15.454842 [debug] [MainThread]: On master: COMMIT
[0m05:13:15.460367 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m05:13:15.466314 [debug] [MainThread]: On master: Close
[0m05:13:15.469912 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:13:15.472532 [debug] [MainThread]: Connection 'model.amn_dbt.sales' was properly closed.
[0m05:13:15.477445 [info ] [MainThread]: 
[0m05:13:15.483533 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.09 seconds (1.09s).
[0m05:13:15.491336 [debug] [MainThread]: Command end result
[0m05:13:15.662329 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m05:13:15.682159 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m05:13:15.724285 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m05:13:15.728331 [info ] [MainThread]: 
[0m05:13:15.734717 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m05:13:15.740997 [info ] [MainThread]: 
[0m05:13:15.748801 [error] [MainThread]:   Database Error in model sales (models/sales.sql)
  column "description" does not exist
  LINE 15:     Description AS SalesDescription, 
               ^
  compiled code at target/run/amn_dbt/models/sales.sql
[0m05:13:15.762782 [info ] [MainThread]: 
[0m05:13:15.767616 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 TOTAL=4
[0m05:13:15.776079 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.202735, "process_in_blocks": "1720", "process_kernel_time": 1.052374, "process_mem_max_rss": "110484", "process_out_blocks": "0", "process_user_time": 12.718695}
[0m05:13:15.782091 [debug] [MainThread]: Command `dbt run` failed at 05:13:15.781407 after 7.21 seconds
[0m05:13:15.787981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82126f3290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f821227bf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8210799280>]}
[0m05:13:15.796030 [debug] [MainThread]: Flushing usage events
[0m05:13:16.766439 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:30:07.891033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f967cf3ffe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f967cb683b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f967c866450>]}


============================== 05:30:07.917848 | 01eb43ff-5c61-4153-959c-5b4bc8b440bc ==============================
[0m05:30:07.917848 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:30:07.922676 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:30:08.744531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01eb43ff-5c61-4153-959c-5b4bc8b440bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f967ca93a40>]}
[0m05:30:09.026718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01eb43ff-5c61-4153-959c-5b4bc8b440bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f967e1341d0>]}
[0m05:30:09.033137 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:30:09.290100 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:30:09.905842 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:30:09.910217 [debug] [MainThread]: Partial parsing: updated file: amn_dbt://models/sales.sql
[0m05:30:10.648056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01eb43ff-5c61-4153-959c-5b4bc8b440bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f967aaac740>]}
[0m05:30:10.841076 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m05:30:10.857580 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m05:30:10.917582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01eb43ff-5c61-4153-959c-5b4bc8b440bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f967a6bea80>]}
[0m05:30:10.921199 [info ] [MainThread]: Found 4 models, 429 macros
[0m05:30:10.925696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01eb43ff-5c61-4153-959c-5b4bc8b440bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f967aaad5e0>]}
[0m05:30:10.936517 [info ] [MainThread]: 
[0m05:30:10.941072 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:30:10.947409 [info ] [MainThread]: 
[0m05:30:10.953374 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:30:10.981749 [debug] [ThreadPool]: Acquiring new postgres connection 'list_amn_datawarehouse'
[0m05:30:11.095611 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse"
[0m05:30:11.097865 [debug] [ThreadPool]: On list_amn_datawarehouse: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse"} */

    select distinct nspname from pg_namespace
  
[0m05:30:11.100075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:30:11.125247 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.025 seconds
[0m05:30:11.129743 [debug] [ThreadPool]: On list_amn_datawarehouse: Close
[0m05:30:11.134726 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_amn_datawarehouse, now list_amn_datawarehouse_public)
[0m05:30:11.150822 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m05:30:11.153304 [debug] [ThreadPool]: On list_amn_datawarehouse_public: BEGIN
[0m05:30:11.155424 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:30:11.170727 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m05:30:11.173628 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m05:30:11.176793 [debug] [ThreadPool]: On list_amn_datawarehouse_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse_public"} */
select
      'amn_datawarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m05:30:11.185864 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m05:30:11.190182 [debug] [ThreadPool]: On list_amn_datawarehouse_public: ROLLBACK
[0m05:30:11.193260 [debug] [ThreadPool]: On list_amn_datawarehouse_public: Close
[0m05:30:11.209667 [debug] [MainThread]: Using postgres connection "master"
[0m05:30:11.212353 [debug] [MainThread]: On master: BEGIN
[0m05:30:11.215091 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:30:11.231745 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m05:30:11.234094 [debug] [MainThread]: Using postgres connection "master"
[0m05:30:11.237037 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:30:11.246891 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m05:30:11.250811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01eb43ff-5c61-4153-959c-5b4bc8b440bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f967a6b3f80>]}
[0m05:30:11.253598 [debug] [MainThread]: On master: ROLLBACK
[0m05:30:11.256217 [debug] [MainThread]: Using postgres connection "master"
[0m05:30:11.258464 [debug] [MainThread]: On master: BEGIN
[0m05:30:11.261529 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:30:11.264925 [debug] [MainThread]: On master: COMMIT
[0m05:30:11.267838 [debug] [MainThread]: Using postgres connection "master"
[0m05:30:11.271201 [debug] [MainThread]: On master: COMMIT
[0m05:30:11.276292 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m05:30:11.278939 [debug] [MainThread]: On master: Close
[0m05:30:11.286305 [debug] [Thread-1 (]: Began running node model.amn_dbt.purchase_prices
[0m05:30:11.289650 [info ] [Thread-1 (]: 1 of 4 START sql table model public.purchase_prices ............................ [RUN]
[0m05:30:11.292809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_amn_datawarehouse_public, now model.amn_dbt.purchase_prices)
[0m05:30:11.296040 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.purchase_prices
[0m05:30:11.316867 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.purchase_prices"
[0m05:30:11.331584 [debug] [Thread-1 (]: Began executing node model.amn_dbt.purchase_prices
[0m05:30:11.423160 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.purchase_prices"
[0m05:30:11.436274 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:30:11.438351 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: BEGIN
[0m05:30:11.440197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:30:11.454385 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m05:30:11.456913 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:30:11.459449 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */

  
    

  create  table "amn_datawarehouse"."public"."purchase_prices__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    Brand,
    PurchasePrice
FROM public.purchase_prices
  );
  
[0m05:30:11.466163 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m05:30:11.480396 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:30:11.483024 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
alter table "amn_datawarehouse"."public"."purchase_prices" rename to "purchase_prices__dbt_backup"
[0m05:30:11.486939 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:30:11.494997 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:30:11.497835 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
alter table "amn_datawarehouse"."public"."purchase_prices__dbt_tmp" rename to "purchase_prices"
[0m05:30:11.501811 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:30:11.548848 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: COMMIT
[0m05:30:11.551355 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:30:11.553476 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: COMMIT
[0m05:30:11.563383 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m05:30:11.578042 [debug] [Thread-1 (]: Applying DROP to: "amn_datawarehouse"."public"."purchase_prices__dbt_backup"
[0m05:30:11.590327 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:30:11.592354 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
drop table if exists "amn_datawarehouse"."public"."purchase_prices__dbt_backup" cascade
[0m05:30:11.597427 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m05:30:11.603084 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: Close
[0m05:30:11.607460 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01eb43ff-5c61-4153-959c-5b4bc8b440bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f967cf8e1b0>]}
[0m05:30:11.609936 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.purchase_prices ....................... [[32mSELECT 0[0m in 0.31s]
[0m05:30:11.613412 [debug] [Thread-1 (]: Finished running node model.amn_dbt.purchase_prices
[0m05:30:11.615983 [debug] [Thread-1 (]: Began running node model.amn_dbt.sales
[0m05:30:11.618820 [info ] [Thread-1 (]: 2 of 4 START sql table model public.sales ...................................... [RUN]
[0m05:30:11.622204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.amn_dbt.purchase_prices, now model.amn_dbt.sales)
[0m05:30:11.624521 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.sales
[0m05:30:11.630527 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.sales"
[0m05:30:11.646151 [debug] [Thread-1 (]: Began executing node model.amn_dbt.sales
[0m05:30:11.655547 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.sales"
[0m05:30:11.668997 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:30:11.671416 [debug] [Thread-1 (]: On model.amn_dbt.sales: BEGIN
[0m05:30:11.675293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:30:11.691465 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m05:30:11.696019 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:30:11.701226 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */

  
    

  create  table "amn_datawarehouse"."public"."sales__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    inventoryid,
    store,
    salesdescription AS SalesDescription, 
    salesprice,
    brand
FROM public.sales;
  );
  
[0m05:30:11.705957 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 18: FROM public.sales;
                          ^

[0m05:30:11.709475 [debug] [Thread-1 (]: On model.amn_dbt.sales: ROLLBACK
[0m05:30:11.715001 [debug] [Thread-1 (]: On model.amn_dbt.sales: Close
[0m05:30:11.726129 [debug] [Thread-1 (]: Database Error in model sales (models/sales.sql)
  syntax error at or near ";"
  LINE 18: FROM public.sales;
                            ^
  compiled code at target/run/amn_dbt/models/sales.sql
[0m05:30:11.731116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01eb43ff-5c61-4153-959c-5b4bc8b440bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f967886c7d0>]}
[0m05:30:11.734433 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.sales ............................. [[31mERROR[0m in 0.11s]
[0m05:30:11.738604 [debug] [Thread-1 (]: Finished running node model.amn_dbt.sales
[0m05:30:11.744255 [debug] [Thread-4 (]: Marking all children of 'model.amn_dbt.sales' to be skipped because of status 'error'.  Reason: Database Error in model sales (models/sales.sql)
  syntax error at or near ";"
  LINE 18: FROM public.sales;
                            ^
  compiled code at target/run/amn_dbt/models/sales.sql.
[0m05:30:11.751789 [debug] [Thread-1 (]: Began running node model.amn_dbt.profit_and_margin
[0m05:30:11.754283 [info ] [Thread-1 (]: 3 of 4 SKIP relation public.profit_and_margin .................................. [[33mSKIP[0m]
[0m05:30:11.758074 [debug] [Thread-1 (]: Finished running node model.amn_dbt.profit_and_margin
[0m05:30:11.762139 [debug] [Thread-1 (]: Began running node model.amn_dbt.least_profitability
[0m05:30:11.765760 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.least_profitability ................................ [[33mSKIP[0m]
[0m05:30:11.769518 [debug] [Thread-1 (]: Finished running node model.amn_dbt.least_profitability
[0m05:30:11.775199 [debug] [MainThread]: Using postgres connection "master"
[0m05:30:11.778680 [debug] [MainThread]: On master: BEGIN
[0m05:30:11.781722 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:30:11.806181 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m05:30:11.809219 [debug] [MainThread]: On master: COMMIT
[0m05:30:11.812148 [debug] [MainThread]: Using postgres connection "master"
[0m05:30:11.816836 [debug] [MainThread]: On master: COMMIT
[0m05:30:11.819883 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:30:11.823543 [debug] [MainThread]: On master: Close
[0m05:30:11.827135 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:30:11.830685 [debug] [MainThread]: Connection 'model.amn_dbt.sales' was properly closed.
[0m05:30:11.836272 [info ] [MainThread]: 
[0m05:30:11.840969 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m05:30:11.848257 [debug] [MainThread]: Command end result
[0m05:30:12.059535 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m05:30:12.074401 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m05:30:12.100912 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m05:30:12.103312 [info ] [MainThread]: 
[0m05:30:12.107199 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m05:30:12.111169 [info ] [MainThread]: 
[0m05:30:12.117093 [error] [MainThread]:   Database Error in model sales (models/sales.sql)
  syntax error at or near ";"
  LINE 18: FROM public.sales;
                            ^
  compiled code at target/run/amn_dbt/models/sales.sql
[0m05:30:12.120604 [info ] [MainThread]: 
[0m05:30:12.125455 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 TOTAL=4
[0m05:30:12.133719 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.060451, "process_in_blocks": "1752", "process_kernel_time": 0.987575, "process_mem_max_rss": "111824", "process_out_blocks": "0", "process_user_time": 9.21065}
[0m05:30:12.138018 [debug] [MainThread]: Command `dbt run` failed at 05:30:12.137503 after 5.07 seconds
[0m05:30:12.141424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f967c768f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f967c3cfa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f967a7a5cd0>]}
[0m05:30:12.144707 [debug] [MainThread]: Flushing usage events
[0m05:30:12.958840 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:30:26.115905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc273078590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc272754560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2727bf3b0>]}


============================== 05:30:26.121954 | c9568a56-c688-4d6f-b6d4-efb79d2514b4 ==============================
[0m05:30:26.121954 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:30:26.124813 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:30:26.508522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9568a56-c688-4d6f-b6d4-efb79d2514b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2734fcf20>]}
[0m05:30:26.621655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9568a56-c688-4d6f-b6d4-efb79d2514b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2722eda90>]}
[0m05:30:26.624521 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:30:26.819119 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:30:27.063380 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:30:27.065393 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:30:27.122883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9568a56-c688-4d6f-b6d4-efb79d2514b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2722cbe60>]}
[0m05:30:27.315613 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m05:30:27.327300 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m05:30:27.365481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9568a56-c688-4d6f-b6d4-efb79d2514b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc27082c500>]}
[0m05:30:27.368669 [info ] [MainThread]: Found 4 models, 429 macros
[0m05:30:27.371626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9568a56-c688-4d6f-b6d4-efb79d2514b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc270a79460>]}
[0m05:30:27.379565 [info ] [MainThread]: 
[0m05:30:27.383117 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:30:27.386105 [info ] [MainThread]: 
[0m05:30:27.390577 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:30:27.405762 [debug] [ThreadPool]: Acquiring new postgres connection 'list_amn_datawarehouse'
[0m05:30:27.512205 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse"
[0m05:30:27.514470 [debug] [ThreadPool]: On list_amn_datawarehouse: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse"} */

    select distinct nspname from pg_namespace
  
[0m05:30:27.516263 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:30:27.532373 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.016 seconds
[0m05:30:27.536190 [debug] [ThreadPool]: On list_amn_datawarehouse: Close
[0m05:30:27.541609 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_amn_datawarehouse, now list_amn_datawarehouse_public)
[0m05:30:27.554869 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m05:30:27.556880 [debug] [ThreadPool]: On list_amn_datawarehouse_public: BEGIN
[0m05:30:27.558950 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:30:27.572148 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m05:30:27.574444 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m05:30:27.577039 [debug] [ThreadPool]: On list_amn_datawarehouse_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse_public"} */
select
      'amn_datawarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m05:30:27.585748 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m05:30:27.589352 [debug] [ThreadPool]: On list_amn_datawarehouse_public: ROLLBACK
[0m05:30:27.591527 [debug] [ThreadPool]: On list_amn_datawarehouse_public: Close
[0m05:30:27.605180 [debug] [MainThread]: Using postgres connection "master"
[0m05:30:27.607867 [debug] [MainThread]: On master: BEGIN
[0m05:30:27.610321 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:30:27.624712 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m05:30:27.627430 [debug] [MainThread]: Using postgres connection "master"
[0m05:30:27.630788 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:30:27.641133 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m05:30:27.645845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9568a56-c688-4d6f-b6d4-efb79d2514b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc270a79460>]}
[0m05:30:27.648303 [debug] [MainThread]: On master: ROLLBACK
[0m05:30:27.651056 [debug] [MainThread]: Using postgres connection "master"
[0m05:30:27.654626 [debug] [MainThread]: On master: BEGIN
[0m05:30:27.658158 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:30:27.661816 [debug] [MainThread]: On master: COMMIT
[0m05:30:27.664643 [debug] [MainThread]: Using postgres connection "master"
[0m05:30:27.667141 [debug] [MainThread]: On master: COMMIT
[0m05:30:27.671801 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m05:30:27.674430 [debug] [MainThread]: On master: Close
[0m05:30:27.680086 [debug] [Thread-1 (]: Began running node model.amn_dbt.purchase_prices
[0m05:30:27.682769 [info ] [Thread-1 (]: 1 of 4 START sql table model public.purchase_prices ............................ [RUN]
[0m05:30:27.687853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_amn_datawarehouse_public, now model.amn_dbt.purchase_prices)
[0m05:30:27.691034 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.purchase_prices
[0m05:30:27.711676 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.purchase_prices"
[0m05:30:27.727450 [debug] [Thread-1 (]: Began executing node model.amn_dbt.purchase_prices
[0m05:30:27.829696 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.purchase_prices"
[0m05:30:27.843165 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:30:27.845058 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: BEGIN
[0m05:30:27.846959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:30:27.859778 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m05:30:27.862475 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:30:27.865680 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */

  
    

  create  table "amn_datawarehouse"."public"."purchase_prices__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    Brand,
    PurchasePrice
FROM public.purchase_prices
  );
  
[0m05:30:27.872287 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m05:30:27.885086 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:30:27.887511 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
alter table "amn_datawarehouse"."public"."purchase_prices" rename to "purchase_prices__dbt_backup"
[0m05:30:27.890603 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:30:27.900261 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:30:27.903575 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
alter table "amn_datawarehouse"."public"."purchase_prices__dbt_tmp" rename to "purchase_prices"
[0m05:30:27.906514 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:30:27.951610 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: COMMIT
[0m05:30:27.954042 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:30:27.955986 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: COMMIT
[0m05:30:27.960818 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m05:30:27.977404 [debug] [Thread-1 (]: Applying DROP to: "amn_datawarehouse"."public"."purchase_prices__dbt_backup"
[0m05:30:27.994087 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:30:27.996857 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
drop table if exists "amn_datawarehouse"."public"."purchase_prices__dbt_backup" cascade
[0m05:30:28.002383 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m05:30:28.008627 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: Close
[0m05:30:28.013584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9568a56-c688-4d6f-b6d4-efb79d2514b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2741367e0>]}
[0m05:30:28.016290 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.purchase_prices ....................... [[32mSELECT 0[0m in 0.32s]
[0m05:30:28.019337 [debug] [Thread-1 (]: Finished running node model.amn_dbt.purchase_prices
[0m05:30:28.022688 [debug] [Thread-1 (]: Began running node model.amn_dbt.sales
[0m05:30:28.026122 [info ] [Thread-1 (]: 2 of 4 START sql table model public.sales ...................................... [RUN]
[0m05:30:28.029015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.amn_dbt.purchase_prices, now model.amn_dbt.sales)
[0m05:30:28.031448 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.sales
[0m05:30:28.037411 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.sales"
[0m05:30:28.050677 [debug] [Thread-1 (]: Began executing node model.amn_dbt.sales
[0m05:30:28.059453 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.sales"
[0m05:30:28.072412 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:30:28.074651 [debug] [Thread-1 (]: On model.amn_dbt.sales: BEGIN
[0m05:30:28.076753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:30:28.094116 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m05:30:28.097137 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:30:28.099533 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */

  
    

  create  table "amn_datawarehouse"."public"."sales__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    inventoryid,
    store,
    salesdescription AS SalesDescription, 
    salesprice,
    brand
FROM public.sales;
  );
  
[0m05:30:28.104561 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 18: FROM public.sales;
                          ^

[0m05:30:28.107064 [debug] [Thread-1 (]: On model.amn_dbt.sales: ROLLBACK
[0m05:30:28.109514 [debug] [Thread-1 (]: On model.amn_dbt.sales: Close
[0m05:30:28.121566 [debug] [Thread-1 (]: Database Error in model sales (models/sales.sql)
  syntax error at or near ";"
  LINE 18: FROM public.sales;
                            ^
  compiled code at target/run/amn_dbt/models/sales.sql
[0m05:30:28.124210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9568a56-c688-4d6f-b6d4-efb79d2514b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc26fa66b40>]}
[0m05:30:28.128523 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.sales ............................. [[31mERROR[0m in 0.10s]
[0m05:30:28.132435 [debug] [Thread-1 (]: Finished running node model.amn_dbt.sales
[0m05:30:28.136599 [debug] [Thread-4 (]: Marking all children of 'model.amn_dbt.sales' to be skipped because of status 'error'.  Reason: Database Error in model sales (models/sales.sql)
  syntax error at or near ";"
  LINE 18: FROM public.sales;
                            ^
  compiled code at target/run/amn_dbt/models/sales.sql.
[0m05:30:28.142310 [debug] [Thread-1 (]: Began running node model.amn_dbt.profit_and_margin
[0m05:30:28.145213 [info ] [Thread-1 (]: 3 of 4 SKIP relation public.profit_and_margin .................................. [[33mSKIP[0m]
[0m05:30:28.148935 [debug] [Thread-1 (]: Finished running node model.amn_dbt.profit_and_margin
[0m05:30:28.154851 [debug] [Thread-1 (]: Began running node model.amn_dbt.least_profitability
[0m05:30:28.158561 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.least_profitability ................................ [[33mSKIP[0m]
[0m05:30:28.162438 [debug] [Thread-1 (]: Finished running node model.amn_dbt.least_profitability
[0m05:30:28.168049 [debug] [MainThread]: Using postgres connection "master"
[0m05:30:28.171712 [debug] [MainThread]: On master: BEGIN
[0m05:30:28.174560 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:30:28.195907 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m05:30:28.198647 [debug] [MainThread]: On master: COMMIT
[0m05:30:28.200992 [debug] [MainThread]: Using postgres connection "master"
[0m05:30:28.206070 [debug] [MainThread]: On master: COMMIT
[0m05:30:28.210416 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:30:28.213504 [debug] [MainThread]: On master: Close
[0m05:30:28.216864 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:30:28.221088 [debug] [MainThread]: Connection 'model.amn_dbt.sales' was properly closed.
[0m05:30:28.224151 [info ] [MainThread]: 
[0m05:30:28.228070 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m05:30:28.234230 [debug] [MainThread]: Command end result
[0m05:30:28.342375 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m05:30:28.354977 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m05:30:28.384361 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m05:30:28.387427 [info ] [MainThread]: 
[0m05:30:28.391383 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m05:30:28.397494 [info ] [MainThread]: 
[0m05:30:28.403629 [error] [MainThread]:   Database Error in model sales (models/sales.sql)
  syntax error at or near ";"
  LINE 18: FROM public.sales;
                            ^
  compiled code at target/run/amn_dbt/models/sales.sql
[0m05:30:28.412059 [info ] [MainThread]: 
[0m05:30:28.417609 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 TOTAL=4
[0m05:30:28.427062 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.4641979, "process_in_blocks": "0", "process_kernel_time": 0.521092, "process_mem_max_rss": "107360", "process_out_blocks": "0", "process_user_time": 4.319055}
[0m05:30:28.430567 [debug] [MainThread]: Command `dbt run` failed at 05:30:28.430131 after 2.47 seconds
[0m05:30:28.433188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc273017890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc26f9e2cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc26fbcd130>]}
[0m05:30:28.436738 [debug] [MainThread]: Flushing usage events
[0m05:30:29.140445 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:32:02.753737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a3e0cdb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a3fae8170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a3e0ccbc0>]}


============================== 05:32:02.771429 | f4959028-3015-4911-a1ae-b606d22382a4 ==============================
[0m05:32:02.771429 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:32:02.792087 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:32:03.650626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4959028-3015-4911-a1ae-b606d22382a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a3dbeaf90>]}
[0m05:32:03.936229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4959028-3015-4911-a1ae-b606d22382a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a3dbcf920>]}
[0m05:32:03.941010 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:32:04.315169 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:32:04.769860 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:32:04.773353 [debug] [MainThread]: Partial parsing: updated file: amn_dbt://models/sales.sql
[0m05:32:05.771198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4959028-3015-4911-a1ae-b606d22382a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a3c2e3800>]}
[0m05:32:05.921824 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m05:32:05.935026 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m05:32:05.976121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4959028-3015-4911-a1ae-b606d22382a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a3bef2b70>]}
[0m05:32:05.978626 [info ] [MainThread]: Found 4 models, 429 macros
[0m05:32:05.981151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4959028-3015-4911-a1ae-b606d22382a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a3c017da0>]}
[0m05:32:05.989126 [info ] [MainThread]: 
[0m05:32:05.992784 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:32:05.995739 [info ] [MainThread]: 
[0m05:32:05.998885 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:32:06.015179 [debug] [ThreadPool]: Acquiring new postgres connection 'list_amn_datawarehouse'
[0m05:32:06.131311 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse"
[0m05:32:06.133574 [debug] [ThreadPool]: On list_amn_datawarehouse: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse"} */

    select distinct nspname from pg_namespace
  
[0m05:32:06.135851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:32:06.155281 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.019 seconds
[0m05:32:06.158947 [debug] [ThreadPool]: On list_amn_datawarehouse: Close
[0m05:32:06.164500 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_amn_datawarehouse, now list_amn_datawarehouse_public)
[0m05:32:06.180393 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m05:32:06.182452 [debug] [ThreadPool]: On list_amn_datawarehouse_public: BEGIN
[0m05:32:06.184605 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:32:06.198193 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m05:32:06.200970 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m05:32:06.203494 [debug] [ThreadPool]: On list_amn_datawarehouse_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse_public"} */
select
      'amn_datawarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m05:32:06.212872 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m05:32:06.216596 [debug] [ThreadPool]: On list_amn_datawarehouse_public: ROLLBACK
[0m05:32:06.218905 [debug] [ThreadPool]: On list_amn_datawarehouse_public: Close
[0m05:32:06.232433 [debug] [MainThread]: Using postgres connection "master"
[0m05:32:06.234695 [debug] [MainThread]: On master: BEGIN
[0m05:32:06.238461 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:32:06.252067 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m05:32:06.254916 [debug] [MainThread]: Using postgres connection "master"
[0m05:32:06.257787 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:32:06.265872 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m05:32:06.269936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4959028-3015-4911-a1ae-b606d22382a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a3c016b70>]}
[0m05:32:06.272002 [debug] [MainThread]: On master: ROLLBACK
[0m05:32:06.274203 [debug] [MainThread]: Using postgres connection "master"
[0m05:32:06.276010 [debug] [MainThread]: On master: BEGIN
[0m05:32:06.279014 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:32:06.281840 [debug] [MainThread]: On master: COMMIT
[0m05:32:06.284775 [debug] [MainThread]: Using postgres connection "master"
[0m05:32:06.287444 [debug] [MainThread]: On master: COMMIT
[0m05:32:06.290479 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m05:32:06.300055 [debug] [MainThread]: On master: Close
[0m05:32:06.332525 [debug] [Thread-1 (]: Began running node model.amn_dbt.purchase_prices
[0m05:32:06.336145 [info ] [Thread-1 (]: 1 of 4 START sql table model public.purchase_prices ............................ [RUN]
[0m05:32:06.339292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_amn_datawarehouse_public, now model.amn_dbt.purchase_prices)
[0m05:32:06.342428 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.purchase_prices
[0m05:32:06.392091 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.purchase_prices"
[0m05:32:06.420190 [debug] [Thread-1 (]: Began executing node model.amn_dbt.purchase_prices
[0m05:32:06.512236 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.purchase_prices"
[0m05:32:06.525364 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:32:06.527240 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: BEGIN
[0m05:32:06.529051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:32:06.541940 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m05:32:06.544549 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:32:06.547265 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */

  
    

  create  table "amn_datawarehouse"."public"."purchase_prices__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    Brand,
    PurchasePrice
FROM public.purchase_prices
  );
  
[0m05:32:06.555139 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m05:32:06.575001 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:32:06.577879 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
alter table "amn_datawarehouse"."public"."purchase_prices" rename to "purchase_prices__dbt_backup"
[0m05:32:06.580704 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:32:06.587525 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:32:06.589809 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
alter table "amn_datawarehouse"."public"."purchase_prices__dbt_tmp" rename to "purchase_prices"
[0m05:32:06.593122 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:32:06.641281 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: COMMIT
[0m05:32:06.643338 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:32:06.645245 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: COMMIT
[0m05:32:06.658925 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m05:32:06.672148 [debug] [Thread-1 (]: Applying DROP to: "amn_datawarehouse"."public"."purchase_prices__dbt_backup"
[0m05:32:06.683324 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:32:06.685716 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
drop table if exists "amn_datawarehouse"."public"."purchase_prices__dbt_backup" cascade
[0m05:32:06.691670 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m05:32:06.697843 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: Close
[0m05:32:06.702482 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4959028-3015-4911-a1ae-b606d22382a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a3f866240>]}
[0m05:32:06.705248 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.purchase_prices ....................... [[32mSELECT 0[0m in 0.36s]
[0m05:32:06.708229 [debug] [Thread-1 (]: Finished running node model.amn_dbt.purchase_prices
[0m05:32:06.710497 [debug] [Thread-1 (]: Began running node model.amn_dbt.sales
[0m05:32:06.712942 [info ] [Thread-1 (]: 2 of 4 START sql table model public.sales ...................................... [RUN]
[0m05:32:06.715844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.amn_dbt.purchase_prices, now model.amn_dbt.sales)
[0m05:32:06.718204 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.sales
[0m05:32:06.723299 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.sales"
[0m05:32:06.736446 [debug] [Thread-1 (]: Began executing node model.amn_dbt.sales
[0m05:32:06.746671 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.sales"
[0m05:32:06.761293 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:32:06.763645 [debug] [Thread-1 (]: On model.amn_dbt.sales: BEGIN
[0m05:32:06.766217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:32:06.781227 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m05:32:06.783433 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:32:06.786076 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */

  
    

  create  table "amn_datawarehouse"."public"."sales__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    inventoryid,
    store,
    salesdescription AS SalesDescription, 
    salesprice,
    brand
FROM public.sales
  );
  
[0m05:32:06.793118 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m05:32:06.799920 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:32:06.802049 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */
alter table "amn_datawarehouse"."public"."sales" rename to "sales__dbt_backup"
[0m05:32:06.804630 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:32:06.812499 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:32:06.815381 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */
alter table "amn_datawarehouse"."public"."sales__dbt_tmp" rename to "sales"
[0m05:32:06.819352 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:32:06.825620 [debug] [Thread-1 (]: On model.amn_dbt.sales: COMMIT
[0m05:32:06.828070 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:32:06.830048 [debug] [Thread-1 (]: On model.amn_dbt.sales: COMMIT
[0m05:32:06.836974 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m05:32:06.844070 [debug] [Thread-1 (]: Applying DROP to: "amn_datawarehouse"."public"."sales__dbt_backup"
[0m05:32:06.846760 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:32:06.848650 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */
drop table if exists "amn_datawarehouse"."public"."sales__dbt_backup" cascade
[0m05:32:06.854575 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m05:32:06.858633 [debug] [Thread-1 (]: On model.amn_dbt.sales: Close
[0m05:32:06.861347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4959028-3015-4911-a1ae-b606d22382a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a39f956a0>]}
[0m05:32:06.864122 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.sales ................................. [[32mSELECT 0[0m in 0.15s]
[0m05:32:06.867020 [debug] [Thread-1 (]: Finished running node model.amn_dbt.sales
[0m05:32:06.870400 [debug] [Thread-1 (]: Began running node model.amn_dbt.profit_and_margin
[0m05:32:06.872765 [info ] [Thread-1 (]: 3 of 4 START sql table model public.profit_and_margin .......................... [RUN]
[0m05:32:06.876303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.amn_dbt.sales, now model.amn_dbt.profit_and_margin)
[0m05:32:06.878460 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.profit_and_margin
[0m05:32:06.890486 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.profit_and_margin"
[0m05:32:06.907808 [debug] [Thread-1 (]: Began executing node model.amn_dbt.profit_and_margin
[0m05:32:06.927151 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.profit_and_margin"
[0m05:32:06.944804 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m05:32:06.947846 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: BEGIN
[0m05:32:06.950618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:32:06.968587 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m05:32:06.971620 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m05:32:06.974655 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.profit_and_margin"} */

  
    

  create  table "amn_datawarehouse"."public"."profit_and_margin__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    s.InventoryId,
    s.Store,
    s.SalesDescription, 
    s.SalesPrice,
    COALESCE(p.PurchasePrice, 0) AS PurchasePrice,
    (s.SalesPrice - COALESCE(p.PurchasePrice, 0)) AS Profit,
    (s.SalesPrice - COALESCE(p.PurchasePrice, 0)) / NULLIF(s.SalesPrice, 0) * 100 AS ProfitMargin
FROM 
    "amn_datawarehouse"."public"."sales" AS s 
LEFT JOIN 
    "amn_datawarehouse"."public"."purchase_prices" AS p
    ON s.Brand = p.Brand;
  );
  
[0m05:32:06.979066 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 24:     ON s.Brand = p.Brand;
                                 ^

[0m05:32:06.982928 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: ROLLBACK
[0m05:32:06.986972 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: Close
[0m05:32:07.004587 [debug] [Thread-1 (]: Database Error in model profit_and_margin (models/profit_and_margin.sql)
  syntax error at or near ";"
  LINE 24:     ON s.Brand = p.Brand;
                                   ^
  compiled code at target/run/amn_dbt/models/profit_and_margin.sql
[0m05:32:07.008195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4959028-3015-4911-a1ae-b606d22382a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a3bf11a60>]}
[0m05:32:07.014186 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.profit_and_margin ................. [[31mERROR[0m in 0.13s]
[0m05:32:07.018414 [debug] [Thread-1 (]: Finished running node model.amn_dbt.profit_and_margin
[0m05:32:07.022174 [debug] [Thread-4 (]: Marking all children of 'model.amn_dbt.profit_and_margin' to be skipped because of status 'error'.  Reason: Database Error in model profit_and_margin (models/profit_and_margin.sql)
  syntax error at or near ";"
  LINE 24:     ON s.Brand = p.Brand;
                                   ^
  compiled code at target/run/amn_dbt/models/profit_and_margin.sql.
[0m05:32:07.029820 [debug] [Thread-1 (]: Began running node model.amn_dbt.least_profitability
[0m05:32:07.032761 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.least_profitability ................................ [[33mSKIP[0m]
[0m05:32:07.037117 [debug] [Thread-1 (]: Finished running node model.amn_dbt.least_profitability
[0m05:32:07.044468 [debug] [MainThread]: Using postgres connection "master"
[0m05:32:07.047750 [debug] [MainThread]: On master: BEGIN
[0m05:32:07.049774 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:32:07.068440 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m05:32:07.071397 [debug] [MainThread]: On master: COMMIT
[0m05:32:07.074174 [debug] [MainThread]: Using postgres connection "master"
[0m05:32:07.078348 [debug] [MainThread]: On master: COMMIT
[0m05:32:07.082191 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:32:07.085162 [debug] [MainThread]: On master: Close
[0m05:32:07.089179 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:32:07.092993 [debug] [MainThread]: Connection 'model.amn_dbt.profit_and_margin' was properly closed.
[0m05:32:07.097356 [info ] [MainThread]: 
[0m05:32:07.100812 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.10 seconds (1.10s).
[0m05:32:07.107416 [debug] [MainThread]: Command end result
[0m05:32:07.273193 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m05:32:07.290889 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m05:32:07.329854 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m05:32:07.332195 [info ] [MainThread]: 
[0m05:32:07.335938 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m05:32:07.339324 [info ] [MainThread]: 
[0m05:32:07.345453 [error] [MainThread]:   Database Error in model profit_and_margin (models/profit_and_margin.sql)
  syntax error at or near ";"
  LINE 24:     ON s.Brand = p.Brand;
                                   ^
  compiled code at target/run/amn_dbt/models/profit_and_margin.sql
[0m05:32:07.348888 [info ] [MainThread]: 
[0m05:32:07.352311 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m05:32:07.357585 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.9941707, "process_in_blocks": "0", "process_kernel_time": 1.578934, "process_mem_max_rss": "110696", "process_out_blocks": "0", "process_user_time": 9.665911}
[0m05:32:07.362421 [debug] [MainThread]: Command `dbt run` failed at 05:32:07.361957 after 5.00 seconds
[0m05:32:07.365113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a3dcb82c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a3c06af00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a3bf998b0>]}
[0m05:32:07.368208 [debug] [MainThread]: Flushing usage events
[0m05:32:08.199143 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:33:09.427349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9522859ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f952285a570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f952285aa50>]}


============================== 05:33:09.442734 | 7be84cde-3bb1-4615-93b8-3f40e1369f2c ==============================
[0m05:33:09.442734 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:33:09.446741 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m05:33:10.659918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7be84cde-3bb1-4615-93b8-3f40e1369f2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95222e26f0>]}
[0m05:33:10.964044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7be84cde-3bb1-4615-93b8-3f40e1369f2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f952222f5c0>]}
[0m05:33:10.973974 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:33:11.324239 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:33:11.800459 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:33:11.803792 [debug] [MainThread]: Partial parsing: updated file: amn_dbt://models/profit_and_margin.sql
[0m05:33:12.536212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7be84cde-3bb1-4615-93b8-3f40e1369f2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95207b7710>]}
[0m05:33:12.674810 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m05:33:12.686516 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m05:33:12.737058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7be84cde-3bb1-4615-93b8-3f40e1369f2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95206b6b10>]}
[0m05:33:12.740267 [info ] [MainThread]: Found 4 models, 429 macros
[0m05:33:12.744272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7be84cde-3bb1-4615-93b8-3f40e1369f2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95206e39b0>]}
[0m05:33:12.754654 [info ] [MainThread]: 
[0m05:33:12.757463 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:33:12.760696 [info ] [MainThread]: 
[0m05:33:12.765444 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:33:12.784673 [debug] [ThreadPool]: Acquiring new postgres connection 'list_amn_datawarehouse'
[0m05:33:12.956615 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse"
[0m05:33:12.959354 [debug] [ThreadPool]: On list_amn_datawarehouse: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse"} */

    select distinct nspname from pg_namespace
  
[0m05:33:12.961687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:33:13.003691 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.042 seconds
[0m05:33:13.016811 [debug] [ThreadPool]: On list_amn_datawarehouse: Close
[0m05:33:13.027594 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_amn_datawarehouse, now list_amn_datawarehouse_public)
[0m05:33:13.053358 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m05:33:13.055124 [debug] [ThreadPool]: On list_amn_datawarehouse_public: BEGIN
[0m05:33:13.056725 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:33:13.073117 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m05:33:13.075762 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m05:33:13.078356 [debug] [ThreadPool]: On list_amn_datawarehouse_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse_public"} */
select
      'amn_datawarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m05:33:13.090820 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m05:33:13.098837 [debug] [ThreadPool]: On list_amn_datawarehouse_public: ROLLBACK
[0m05:33:13.103464 [debug] [ThreadPool]: On list_amn_datawarehouse_public: Close
[0m05:33:13.139804 [debug] [MainThread]: Using postgres connection "master"
[0m05:33:13.144927 [debug] [MainThread]: On master: BEGIN
[0m05:33:13.149179 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:33:13.172311 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m05:33:13.175351 [debug] [MainThread]: Using postgres connection "master"
[0m05:33:13.179550 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:33:13.193682 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m05:33:13.199409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7be84cde-3bb1-4615-93b8-3f40e1369f2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9520632000>]}
[0m05:33:13.202576 [debug] [MainThread]: On master: ROLLBACK
[0m05:33:13.207121 [debug] [MainThread]: Using postgres connection "master"
[0m05:33:13.210244 [debug] [MainThread]: On master: BEGIN
[0m05:33:13.213432 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:33:13.218413 [debug] [MainThread]: On master: COMMIT
[0m05:33:13.220924 [debug] [MainThread]: Using postgres connection "master"
[0m05:33:13.223510 [debug] [MainThread]: On master: COMMIT
[0m05:33:13.226832 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:33:13.228719 [debug] [MainThread]: On master: Close
[0m05:33:13.235111 [debug] [Thread-1 (]: Began running node model.amn_dbt.purchase_prices
[0m05:33:13.237463 [info ] [Thread-1 (]: 1 of 4 START sql table model public.purchase_prices ............................ [RUN]
[0m05:33:13.240317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_amn_datawarehouse_public, now model.amn_dbt.purchase_prices)
[0m05:33:13.243025 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.purchase_prices
[0m05:33:13.263115 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.purchase_prices"
[0m05:33:13.276269 [debug] [Thread-1 (]: Began executing node model.amn_dbt.purchase_prices
[0m05:33:13.368100 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.purchase_prices"
[0m05:33:13.379154 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:33:13.381014 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: BEGIN
[0m05:33:13.382899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:33:13.397543 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m05:33:13.400474 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:33:13.403967 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */

  
    

  create  table "amn_datawarehouse"."public"."purchase_prices__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    Brand,
    PurchasePrice
FROM public.purchase_prices
  );
  
[0m05:33:13.411500 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m05:33:13.428061 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:33:13.430378 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
alter table "amn_datawarehouse"."public"."purchase_prices" rename to "purchase_prices__dbt_backup"
[0m05:33:13.433692 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:33:13.442094 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:33:13.444405 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
alter table "amn_datawarehouse"."public"."purchase_prices__dbt_tmp" rename to "purchase_prices"
[0m05:33:13.447801 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:33:13.505911 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: COMMIT
[0m05:33:13.508678 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:33:13.511450 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: COMMIT
[0m05:33:13.518813 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m05:33:13.538007 [debug] [Thread-1 (]: Applying DROP to: "amn_datawarehouse"."public"."purchase_prices__dbt_backup"
[0m05:33:13.552365 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:33:13.554835 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
drop table if exists "amn_datawarehouse"."public"."purchase_prices__dbt_backup" cascade
[0m05:33:13.560642 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m05:33:13.567012 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: Close
[0m05:33:13.571512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7be84cde-3bb1-4615-93b8-3f40e1369f2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9520ac00b0>]}
[0m05:33:13.574306 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.purchase_prices ....................... [[32mSELECT 0[0m in 0.33s]
[0m05:33:13.578103 [debug] [Thread-1 (]: Finished running node model.amn_dbt.purchase_prices
[0m05:33:13.581501 [debug] [Thread-1 (]: Began running node model.amn_dbt.sales
[0m05:33:13.585706 [info ] [Thread-1 (]: 2 of 4 START sql table model public.sales ...................................... [RUN]
[0m05:33:13.589763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.amn_dbt.purchase_prices, now model.amn_dbt.sales)
[0m05:33:13.593364 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.sales
[0m05:33:13.602652 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.sales"
[0m05:33:13.616823 [debug] [Thread-1 (]: Began executing node model.amn_dbt.sales
[0m05:33:13.625571 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.sales"
[0m05:33:13.637326 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:33:13.639942 [debug] [Thread-1 (]: On model.amn_dbt.sales: BEGIN
[0m05:33:13.643180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:33:13.657519 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m05:33:13.660569 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:33:13.663713 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */

  
    

  create  table "amn_datawarehouse"."public"."sales__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    inventoryid,
    store,
    salesdescription AS SalesDescription, 
    salesprice,
    brand
FROM public.sales
  );
  
[0m05:33:13.670257 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.003 seconds
[0m05:33:13.679043 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:33:13.682904 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */
alter table "amn_datawarehouse"."public"."sales" rename to "sales__dbt_backup"
[0m05:33:13.685931 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:33:13.694183 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:33:13.696527 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */
alter table "amn_datawarehouse"."public"."sales__dbt_tmp" rename to "sales"
[0m05:33:13.700360 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:33:13.705574 [debug] [Thread-1 (]: On model.amn_dbt.sales: COMMIT
[0m05:33:13.708213 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:33:13.710398 [debug] [Thread-1 (]: On model.amn_dbt.sales: COMMIT
[0m05:33:13.762418 [debug] [Thread-1 (]: SQL status: COMMIT in 0.050 seconds
[0m05:33:13.771006 [debug] [Thread-1 (]: Applying DROP to: "amn_datawarehouse"."public"."sales__dbt_backup"
[0m05:33:13.774075 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:33:13.776020 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */
drop table if exists "amn_datawarehouse"."public"."sales__dbt_backup" cascade
[0m05:33:13.781762 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m05:33:13.785719 [debug] [Thread-1 (]: On model.amn_dbt.sales: Close
[0m05:33:13.787972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7be84cde-3bb1-4615-93b8-3f40e1369f2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f951a88df70>]}
[0m05:33:13.790378 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.sales ................................. [[32mSELECT 0[0m in 0.20s]
[0m05:33:13.793408 [debug] [Thread-1 (]: Finished running node model.amn_dbt.sales
[0m05:33:13.797523 [debug] [Thread-1 (]: Began running node model.amn_dbt.profit_and_margin
[0m05:33:13.800008 [info ] [Thread-1 (]: 3 of 4 START sql table model public.profit_and_margin .......................... [RUN]
[0m05:33:13.803047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.amn_dbt.sales, now model.amn_dbt.profit_and_margin)
[0m05:33:13.805676 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.profit_and_margin
[0m05:33:13.817320 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.profit_and_margin"
[0m05:33:13.829394 [debug] [Thread-1 (]: Began executing node model.amn_dbt.profit_and_margin
[0m05:33:13.839144 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.profit_and_margin"
[0m05:33:13.853495 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m05:33:13.855358 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: BEGIN
[0m05:33:13.857552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:33:13.881897 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m05:33:13.886208 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m05:33:13.890642 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.profit_and_margin"} */

  
    

  create  table "amn_datawarehouse"."public"."profit_and_margin__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    s.InventoryId,
    s.Store,
    s.SalesDescription, 
    s.SalesPrice,
    COALESCE(p.PurchasePrice, 0) AS PurchasePrice,
    (s.SalesPrice - COALESCE(p.PurchasePrice, 0)) AS Profit,
    (s.SalesPrice - COALESCE(p.PurchasePrice, 0)) / NULLIF(s.SalesPrice, 0) * 100 AS ProfitMargin
FROM 
    "amn_datawarehouse"."public"."sales" AS s 
LEFT JOIN 
    "amn_datawarehouse"."public"."purchase_prices" AS p
    ON s.Brand = p.Brand
  );
  
[0m05:33:13.899881 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m05:33:13.908951 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m05:33:13.911845 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.profit_and_margin"} */
alter table "amn_datawarehouse"."public"."profit_and_margin__dbt_tmp" rename to "profit_and_margin"
[0m05:33:13.915899 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:33:13.920936 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: COMMIT
[0m05:33:13.923745 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m05:33:13.926268 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: COMMIT
[0m05:33:13.934168 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m05:33:13.941164 [debug] [Thread-1 (]: Applying DROP to: "amn_datawarehouse"."public"."profit_and_margin__dbt_backup"
[0m05:33:13.943915 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m05:33:13.945681 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.profit_and_margin"} */
drop table if exists "amn_datawarehouse"."public"."profit_and_margin__dbt_backup" cascade
[0m05:33:13.948186 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m05:33:13.952948 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: Close
[0m05:33:13.955195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7be84cde-3bb1-4615-93b8-3f40e1369f2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9518f61ee0>]}
[0m05:33:13.957742 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.profit_and_margin ..................... [[32mSELECT 0[0m in 0.15s]
[0m05:33:13.961101 [debug] [Thread-1 (]: Finished running node model.amn_dbt.profit_and_margin
[0m05:33:13.965668 [debug] [Thread-1 (]: Began running node model.amn_dbt.least_profitability
[0m05:33:13.969517 [info ] [Thread-1 (]: 4 of 4 START sql table model public.least_profitability ........................ [RUN]
[0m05:33:13.972742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.amn_dbt.profit_and_margin, now model.amn_dbt.least_profitability)
[0m05:33:13.976488 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.least_profitability
[0m05:33:13.986992 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.least_profitability"
[0m05:33:14.002959 [debug] [Thread-1 (]: Began executing node model.amn_dbt.least_profitability
[0m05:33:14.012678 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.least_profitability"
[0m05:33:14.025671 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.least_profitability"
[0m05:33:14.028024 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: BEGIN
[0m05:33:14.030018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:33:14.044659 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m05:33:14.047498 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.least_profitability"
[0m05:33:14.050806 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.least_profitability"} */

  
    

  create  table "amn_datawarehouse"."public"."least_profitability__dbt_tmp"
  
  
    as
  
  (
    WITH profit_data AS (
    SELECT 
        InventoryId,
        Store,
        SalesDescription,
        SalesPrice,
        PurchasePrice,
        Profit,
        ProfitMargin
    FROM "amn_datawarehouse"."public"."profit_and_margin"
)
SELECT 
    InventoryId,
    Store,
    SalesDescription,
    SalesPrice,
    PurchasePrice,
    Profit,
    ProfitMargin
FROM 
    profit_data
ORDER BY 
    Profit ASC
LIMIT 10;
  );
  
[0m05:33:14.055228 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 35: LIMIT 10;
                 ^

[0m05:33:14.058166 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: ROLLBACK
[0m05:33:14.062514 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: Close
[0m05:33:14.073207 [debug] [Thread-1 (]: Database Error in model least_profitability (models/least_profitability.sql)
  syntax error at or near ";"
  LINE 35: LIMIT 10;
                   ^
  compiled code at target/run/amn_dbt/models/least_profitability.sql
[0m05:33:14.076232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7be84cde-3bb1-4615-93b8-3f40e1369f2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9518f3f5c0>]}
[0m05:33:14.078818 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public.least_profitability ............... [[31mERROR[0m in 0.10s]
[0m05:33:14.083003 [debug] [Thread-1 (]: Finished running node model.amn_dbt.least_profitability
[0m05:33:14.086987 [debug] [Thread-4 (]: Marking all children of 'model.amn_dbt.least_profitability' to be skipped because of status 'error'.  Reason: Database Error in model least_profitability (models/least_profitability.sql)
  syntax error at or near ";"
  LINE 35: LIMIT 10;
                   ^
  compiled code at target/run/amn_dbt/models/least_profitability.sql.
[0m05:33:14.093746 [debug] [MainThread]: Using postgres connection "master"
[0m05:33:14.130579 [debug] [MainThread]: On master: BEGIN
[0m05:33:14.179610 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:33:14.210184 [debug] [MainThread]: SQL status: BEGIN in 0.030 seconds
[0m05:33:14.221108 [debug] [MainThread]: On master: COMMIT
[0m05:33:14.224058 [debug] [MainThread]: Using postgres connection "master"
[0m05:33:14.228445 [debug] [MainThread]: On master: COMMIT
[0m05:33:14.231903 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m05:33:14.235213 [debug] [MainThread]: On master: Close
[0m05:33:14.238540 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:33:14.240885 [debug] [MainThread]: Connection 'model.amn_dbt.least_profitability' was properly closed.
[0m05:33:14.243641 [info ] [MainThread]: 
[0m05:33:14.246701 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.48 seconds (1.48s).
[0m05:33:14.254461 [debug] [MainThread]: Command end result
[0m05:33:14.353295 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m05:33:14.367628 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m05:33:14.395357 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m05:33:14.397704 [info ] [MainThread]: 
[0m05:33:14.402481 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m05:33:14.406189 [info ] [MainThread]: 
[0m05:33:14.409695 [error] [MainThread]:   Database Error in model least_profitability (models/least_profitability.sql)
  syntax error at or near ";"
  LINE 35: LIMIT 10;
                   ^
  compiled code at target/run/amn_dbt/models/least_profitability.sql
[0m05:33:14.412950 [info ] [MainThread]: 
[0m05:33:14.417952 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m05:33:14.423415 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.583539, "process_in_blocks": "0", "process_kernel_time": 2.554476, "process_mem_max_rss": "112944", "process_out_blocks": "0", "process_user_time": 16.646322}
[0m05:33:14.426863 [debug] [MainThread]: Command `dbt run` failed at 05:33:14.426451 after 5.59 seconds
[0m05:33:14.429100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95223c3830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95228f7a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f951a91a330>]}
[0m05:33:14.431829 [debug] [MainThread]: Flushing usage events
[0m05:33:15.204506 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:34:33.776036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb6ac5cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb6ac5a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb6ac7710>]}


============================== 05:34:33.819889 | 8bbe6b95-0aac-497f-b1a2-9528c641121b ==============================
[0m05:34:33.819889 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:34:33.828391 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m05:34:34.968508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8bbe6b95-0aac-497f-b1a2-9528c641121b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb65a61b0>]}
[0m05:34:35.274113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8bbe6b95-0aac-497f-b1a2-9528c641121b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb65cb5f0>]}
[0m05:34:35.289268 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:34:35.665544 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:34:36.741998 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:34:36.756092 [debug] [MainThread]: Partial parsing: updated file: amn_dbt://models/least_profitability.sql
[0m05:34:38.369195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8bbe6b95-0aac-497f-b1a2-9528c641121b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb4d48410>]}
[0m05:34:38.534104 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m05:34:38.550013 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m05:34:38.589154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8bbe6b95-0aac-497f-b1a2-9528c641121b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb4982bd0>]}
[0m05:34:38.591481 [info ] [MainThread]: Found 4 models, 429 macros
[0m05:34:38.594329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bbe6b95-0aac-497f-b1a2-9528c641121b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb49a1b50>]}
[0m05:34:38.601642 [info ] [MainThread]: 
[0m05:34:38.604384 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:34:38.607081 [info ] [MainThread]: 
[0m05:34:38.611007 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:34:38.624929 [debug] [ThreadPool]: Acquiring new postgres connection 'list_amn_datawarehouse'
[0m05:34:38.712031 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse"
[0m05:34:38.714195 [debug] [ThreadPool]: On list_amn_datawarehouse: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse"} */

    select distinct nspname from pg_namespace
  
[0m05:34:38.724473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:34:38.764624 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.048 seconds
[0m05:34:38.770036 [debug] [ThreadPool]: On list_amn_datawarehouse: Close
[0m05:34:38.776425 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_amn_datawarehouse, now list_amn_datawarehouse_public)
[0m05:34:38.800837 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m05:34:38.803072 [debug] [ThreadPool]: On list_amn_datawarehouse_public: BEGIN
[0m05:34:38.804939 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:34:38.818889 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m05:34:38.821626 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m05:34:38.824295 [debug] [ThreadPool]: On list_amn_datawarehouse_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse_public"} */
select
      'amn_datawarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m05:34:38.831946 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m05:34:38.836424 [debug] [ThreadPool]: On list_amn_datawarehouse_public: ROLLBACK
[0m05:34:38.838615 [debug] [ThreadPool]: On list_amn_datawarehouse_public: Close
[0m05:34:38.854193 [debug] [MainThread]: Using postgres connection "master"
[0m05:34:38.856005 [debug] [MainThread]: On master: BEGIN
[0m05:34:38.857994 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:34:38.876079 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m05:34:38.879311 [debug] [MainThread]: Using postgres connection "master"
[0m05:34:38.883007 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:34:38.893311 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m05:34:38.897607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bbe6b95-0aac-497f-b1a2-9528c641121b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb48f6390>]}
[0m05:34:38.901600 [debug] [MainThread]: On master: ROLLBACK
[0m05:34:38.904238 [debug] [MainThread]: Using postgres connection "master"
[0m05:34:38.906992 [debug] [MainThread]: On master: BEGIN
[0m05:34:38.910591 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:34:38.913441 [debug] [MainThread]: On master: COMMIT
[0m05:34:38.916491 [debug] [MainThread]: Using postgres connection "master"
[0m05:34:38.918816 [debug] [MainThread]: On master: COMMIT
[0m05:34:38.921584 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:34:38.924086 [debug] [MainThread]: On master: Close
[0m05:34:38.928812 [debug] [Thread-1 (]: Began running node model.amn_dbt.purchase_prices
[0m05:34:38.931557 [info ] [Thread-1 (]: 1 of 4 START sql table model public.purchase_prices ............................ [RUN]
[0m05:34:38.934860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_amn_datawarehouse_public, now model.amn_dbt.purchase_prices)
[0m05:34:38.937200 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.purchase_prices
[0m05:34:38.956398 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.purchase_prices"
[0m05:34:38.967331 [debug] [Thread-1 (]: Began executing node model.amn_dbt.purchase_prices
[0m05:34:39.120160 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.purchase_prices"
[0m05:34:39.134865 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:34:39.139903 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: BEGIN
[0m05:34:39.144295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:34:39.163662 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m05:34:39.166685 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:34:39.169554 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */

  
    

  create  table "amn_datawarehouse"."public"."purchase_prices__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    Brand,
    PurchasePrice
FROM public.purchase_prices
  );
  
[0m05:34:39.176084 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m05:34:39.192893 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:34:39.194783 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
alter table "amn_datawarehouse"."public"."purchase_prices" rename to "purchase_prices__dbt_backup"
[0m05:34:39.197746 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:34:39.206124 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:34:39.208367 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
alter table "amn_datawarehouse"."public"."purchase_prices__dbt_tmp" rename to "purchase_prices"
[0m05:34:39.210795 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m05:34:39.259959 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: COMMIT
[0m05:34:39.261805 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:34:39.263485 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: COMMIT
[0m05:34:39.273227 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m05:34:39.286747 [debug] [Thread-1 (]: Applying DROP to: "amn_datawarehouse"."public"."purchase_prices__dbt_backup"
[0m05:34:39.299049 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:34:39.300885 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
drop table if exists "amn_datawarehouse"."public"."purchase_prices__dbt_backup" cascade
[0m05:34:39.306492 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m05:34:39.311900 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: Close
[0m05:34:39.317409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bbe6b95-0aac-497f-b1a2-9528c641121b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb69a41a0>]}
[0m05:34:39.319906 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.purchase_prices ....................... [[32mSELECT 0[0m in 0.38s]
[0m05:34:39.323101 [debug] [Thread-1 (]: Finished running node model.amn_dbt.purchase_prices
[0m05:34:39.326200 [debug] [Thread-1 (]: Began running node model.amn_dbt.sales
[0m05:34:39.328523 [info ] [Thread-1 (]: 2 of 4 START sql table model public.sales ...................................... [RUN]
[0m05:34:39.331490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.amn_dbt.purchase_prices, now model.amn_dbt.sales)
[0m05:34:39.334226 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.sales
[0m05:34:39.340873 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.sales"
[0m05:34:39.353118 [debug] [Thread-1 (]: Began executing node model.amn_dbt.sales
[0m05:34:39.360603 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.sales"
[0m05:34:39.373304 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:34:39.375299 [debug] [Thread-1 (]: On model.amn_dbt.sales: BEGIN
[0m05:34:39.377117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:34:39.392457 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m05:34:39.395448 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:34:39.398456 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */

  
    

  create  table "amn_datawarehouse"."public"."sales__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    inventoryid,
    store,
    salesdescription AS SalesDescription, 
    salesprice,
    brand
FROM public.sales
  );
  
[0m05:34:39.405595 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m05:34:39.416628 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:34:39.422099 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */
alter table "amn_datawarehouse"."public"."sales" rename to "sales__dbt_backup"
[0m05:34:39.425708 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:34:39.439497 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:34:39.441574 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */
alter table "amn_datawarehouse"."public"."sales__dbt_tmp" rename to "sales"
[0m05:34:39.444228 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:34:39.450298 [debug] [Thread-1 (]: On model.amn_dbt.sales: COMMIT
[0m05:34:39.455153 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:34:39.460494 [debug] [Thread-1 (]: On model.amn_dbt.sales: COMMIT
[0m05:34:39.466399 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m05:34:39.474830 [debug] [Thread-1 (]: Applying DROP to: "amn_datawarehouse"."public"."sales__dbt_backup"
[0m05:34:39.477349 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:34:39.479263 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */
drop table if exists "amn_datawarehouse"."public"."sales__dbt_backup" cascade
[0m05:34:39.484408 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m05:34:39.488357 [debug] [Thread-1 (]: On model.amn_dbt.sales: Close
[0m05:34:39.490533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bbe6b95-0aac-497f-b1a2-9528c641121b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcba5159820>]}
[0m05:34:39.493247 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.sales ................................. [[32mSELECT 0[0m in 0.16s]
[0m05:34:39.496264 [debug] [Thread-1 (]: Finished running node model.amn_dbt.sales
[0m05:34:39.500178 [debug] [Thread-1 (]: Began running node model.amn_dbt.profit_and_margin
[0m05:34:39.502973 [info ] [Thread-1 (]: 3 of 4 START sql table model public.profit_and_margin .......................... [RUN]
[0m05:34:39.505841 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.amn_dbt.sales, now model.amn_dbt.profit_and_margin)
[0m05:34:39.508009 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.profit_and_margin
[0m05:34:39.517966 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.profit_and_margin"
[0m05:34:39.529501 [debug] [Thread-1 (]: Began executing node model.amn_dbt.profit_and_margin
[0m05:34:39.537079 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.profit_and_margin"
[0m05:34:39.547746 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m05:34:39.549563 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: BEGIN
[0m05:34:39.551723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:34:39.564170 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m05:34:39.566486 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m05:34:39.568621 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.profit_and_margin"} */

  
    

  create  table "amn_datawarehouse"."public"."profit_and_margin__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    s.InventoryId,
    s.Store,
    s.SalesDescription, 
    s.SalesPrice,
    COALESCE(p.PurchasePrice, 0) AS PurchasePrice,
    (s.SalesPrice - COALESCE(p.PurchasePrice, 0)) AS Profit,
    (s.SalesPrice - COALESCE(p.PurchasePrice, 0)) / NULLIF(s.SalesPrice, 0) * 100 AS ProfitMargin
FROM 
    "amn_datawarehouse"."public"."sales" AS s 
LEFT JOIN 
    "amn_datawarehouse"."public"."purchase_prices" AS p
    ON s.Brand = p.Brand
  );
  
[0m05:34:39.575465 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m05:34:39.582192 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m05:34:39.584329 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.profit_and_margin"} */
alter table "amn_datawarehouse"."public"."profit_and_margin" rename to "profit_and_margin__dbt_backup"
[0m05:34:39.587015 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:34:39.593470 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m05:34:39.595492 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.profit_and_margin"} */
alter table "amn_datawarehouse"."public"."profit_and_margin__dbt_tmp" rename to "profit_and_margin"
[0m05:34:39.597855 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:34:39.602222 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: COMMIT
[0m05:34:39.604110 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m05:34:39.605913 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: COMMIT
[0m05:34:39.611235 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m05:34:39.616822 [debug] [Thread-1 (]: Applying DROP to: "amn_datawarehouse"."public"."profit_and_margin__dbt_backup"
[0m05:34:39.619256 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m05:34:39.621073 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.profit_and_margin"} */
drop table if exists "amn_datawarehouse"."public"."profit_and_margin__dbt_backup" cascade
[0m05:34:39.625597 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m05:34:39.629169 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: Close
[0m05:34:39.631325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bbe6b95-0aac-497f-b1a2-9528c641121b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcba517bcb0>]}
[0m05:34:39.633760 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.profit_and_margin ..................... [[32mSELECT 0[0m in 0.13s]
[0m05:34:39.636483 [debug] [Thread-1 (]: Finished running node model.amn_dbt.profit_and_margin
[0m05:34:39.639993 [debug] [Thread-1 (]: Began running node model.amn_dbt.least_profitability
[0m05:34:39.642447 [info ] [Thread-1 (]: 4 of 4 START sql table model public.least_profitability ........................ [RUN]
[0m05:34:39.644815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.amn_dbt.profit_and_margin, now model.amn_dbt.least_profitability)
[0m05:34:39.647200 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.least_profitability
[0m05:34:39.655327 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.least_profitability"
[0m05:34:39.665254 [debug] [Thread-1 (]: Began executing node model.amn_dbt.least_profitability
[0m05:34:39.673519 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.least_profitability"
[0m05:34:39.684349 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.least_profitability"
[0m05:34:39.686666 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: BEGIN
[0m05:34:39.689140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:34:39.702451 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m05:34:39.705135 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.least_profitability"
[0m05:34:39.707529 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.least_profitability"} */

  
    

  create  table "amn_datawarehouse"."public"."least_profitability__dbt_tmp"
  
  
    as
  
  (
    WITH profit_data AS (
    SELECT 
        InventoryId,
        Store,
        SalesDescription,
        SalesPrice,
        PurchasePrice,
        Profit,
        ProfitMargin
    FROM "amn_datawarehouse"."public"."profit_and_margin"
)
SELECT 
    InventoryId,
    Store,
    SalesDescription,
    SalesPrice,
    PurchasePrice,
    Profit,
    ProfitMargin
FROM 
    profit_data
ORDER BY 
    Profit ASC
LIMIT 10
  );
  
[0m05:34:39.713577 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m05:34:39.721321 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.least_profitability"
[0m05:34:39.723562 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.least_profitability"} */
alter table "amn_datawarehouse"."public"."least_profitability__dbt_tmp" rename to "least_profitability"
[0m05:34:39.726424 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:34:39.730453 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: COMMIT
[0m05:34:39.732859 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.least_profitability"
[0m05:34:39.734871 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: COMMIT
[0m05:34:39.739800 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m05:34:39.748004 [debug] [Thread-1 (]: Applying DROP to: "amn_datawarehouse"."public"."least_profitability__dbt_backup"
[0m05:34:39.750813 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.least_profitability"
[0m05:34:39.752790 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.least_profitability"} */
drop table if exists "amn_datawarehouse"."public"."least_profitability__dbt_backup" cascade
[0m05:34:39.755159 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m05:34:39.758878 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: Close
[0m05:34:39.761078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bbe6b95-0aac-497f-b1a2-9528c641121b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb4d64590>]}
[0m05:34:39.763484 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.least_profitability ................... [[32mSELECT 0[0m in 0.12s]
[0m05:34:39.766281 [debug] [Thread-1 (]: Finished running node model.amn_dbt.least_profitability
[0m05:34:39.770610 [debug] [MainThread]: Using postgres connection "master"
[0m05:34:39.772651 [debug] [MainThread]: On master: BEGIN
[0m05:34:39.774630 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:34:39.787427 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m05:34:39.789828 [debug] [MainThread]: On master: COMMIT
[0m05:34:39.792074 [debug] [MainThread]: Using postgres connection "master"
[0m05:34:39.794377 [debug] [MainThread]: On master: COMMIT
[0m05:34:39.797274 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:34:39.799342 [debug] [MainThread]: On master: Close
[0m05:34:39.801282 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:34:39.802682 [debug] [MainThread]: Connection 'model.amn_dbt.least_profitability' was properly closed.
[0m05:34:39.804596 [info ] [MainThread]: 
[0m05:34:39.806676 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.19 seconds (1.19s).
[0m05:34:39.812252 [debug] [MainThread]: Command end result
[0m05:34:39.884410 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m05:34:39.896608 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m05:34:39.919901 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m05:34:39.921835 [info ] [MainThread]: 
[0m05:34:39.924366 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:34:39.927058 [info ] [MainThread]: 
[0m05:34:39.929918 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m05:34:39.935265 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.443105, "process_in_blocks": "0", "process_kernel_time": 1.24271, "process_mem_max_rss": "112328", "process_out_blocks": "0", "process_user_time": 12.336906}
[0m05:34:39.938519 [debug] [MainThread]: Command `dbt run` succeeded at 05:34:39.938107 after 7.45 seconds
[0m05:34:39.940986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb6ac5cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcba6a8b5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcba6a8b3b0>]}
[0m05:34:39.943053 [debug] [MainThread]: Flushing usage events
[0m05:34:40.720065 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:35:06.800874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3a44ca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3a7c94c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3a44c1d0>]}


============================== 05:35:06.806643 | 9dd50cf7-4d44-4da0-95c0-a05669ded135 ==============================
[0m05:35:06.806643 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:35:06.809045 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:35:07.082363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9dd50cf7-4d44-4da0-95c0-a05669ded135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3aca0920>]}
[0m05:35:07.172991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9dd50cf7-4d44-4da0-95c0-a05669ded135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3a0b3770>]}
[0m05:35:07.175546 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:35:07.300886 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:35:07.485130 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:35:07.486857 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:35:07.535913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9dd50cf7-4d44-4da0-95c0-a05669ded135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b38872d80>]}
[0m05:35:07.670954 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m05:35:07.680958 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m05:35:07.713761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9dd50cf7-4d44-4da0-95c0-a05669ded135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b385409e0>]}
[0m05:35:07.716096 [info ] [MainThread]: Found 4 models, 429 macros
[0m05:35:07.718323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dd50cf7-4d44-4da0-95c0-a05669ded135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3862fef0>]}
[0m05:35:07.724645 [info ] [MainThread]: 
[0m05:35:07.727439 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:35:07.729669 [info ] [MainThread]: 
[0m05:35:07.732642 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:35:07.743518 [debug] [ThreadPool]: Acquiring new postgres connection 'list_amn_datawarehouse'
[0m05:35:07.818499 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse"
[0m05:35:07.820068 [debug] [ThreadPool]: On list_amn_datawarehouse: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse"} */

    select distinct nspname from pg_namespace
  
[0m05:35:07.821364 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:35:07.833827 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.012 seconds
[0m05:35:07.837048 [debug] [ThreadPool]: On list_amn_datawarehouse: Close
[0m05:35:07.840368 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_amn_datawarehouse, now list_amn_datawarehouse_public)
[0m05:35:07.851055 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m05:35:07.852772 [debug] [ThreadPool]: On list_amn_datawarehouse_public: BEGIN
[0m05:35:07.854378 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:35:07.864884 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m05:35:07.866878 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m05:35:07.869059 [debug] [ThreadPool]: On list_amn_datawarehouse_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse_public"} */
select
      'amn_datawarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m05:35:07.875395 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m05:35:07.878828 [debug] [ThreadPool]: On list_amn_datawarehouse_public: ROLLBACK
[0m05:35:07.880770 [debug] [ThreadPool]: On list_amn_datawarehouse_public: Close
[0m05:35:07.890964 [debug] [MainThread]: Using postgres connection "master"
[0m05:35:07.892627 [debug] [MainThread]: On master: BEGIN
[0m05:35:07.894957 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:35:07.906780 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m05:35:07.909501 [debug] [MainThread]: Using postgres connection "master"
[0m05:35:07.912554 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:35:07.919098 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m05:35:07.922512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dd50cf7-4d44-4da0-95c0-a05669ded135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3884ae40>]}
[0m05:35:07.925104 [debug] [MainThread]: On master: ROLLBACK
[0m05:35:07.927144 [debug] [MainThread]: Using postgres connection "master"
[0m05:35:07.928896 [debug] [MainThread]: On master: BEGIN
[0m05:35:07.930949 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:35:07.932901 [debug] [MainThread]: On master: COMMIT
[0m05:35:07.935029 [debug] [MainThread]: Using postgres connection "master"
[0m05:35:07.936884 [debug] [MainThread]: On master: COMMIT
[0m05:35:07.938965 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:35:07.941154 [debug] [MainThread]: On master: Close
[0m05:35:07.944959 [debug] [Thread-1 (]: Began running node model.amn_dbt.purchase_prices
[0m05:35:07.947111 [info ] [Thread-1 (]: 1 of 4 START sql table model public.purchase_prices ............................ [RUN]
[0m05:35:07.949640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_amn_datawarehouse_public, now model.amn_dbt.purchase_prices)
[0m05:35:07.951722 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.purchase_prices
[0m05:35:07.967819 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.purchase_prices"
[0m05:35:07.980326 [debug] [Thread-1 (]: Began executing node model.amn_dbt.purchase_prices
[0m05:35:08.049138 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.purchase_prices"
[0m05:35:08.060971 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:35:08.062473 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: BEGIN
[0m05:35:08.064012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:35:08.074861 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m05:35:08.077027 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:35:08.079122 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */

  
    

  create  table "amn_datawarehouse"."public"."purchase_prices__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    Brand,
    PurchasePrice
FROM public.purchase_prices
  );
  
[0m05:35:08.084104 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.003 seconds
[0m05:35:08.096404 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:35:08.098508 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
alter table "amn_datawarehouse"."public"."purchase_prices" rename to "purchase_prices__dbt_backup"
[0m05:35:08.100949 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:35:08.107119 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:35:08.109343 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
alter table "amn_datawarehouse"."public"."purchase_prices__dbt_tmp" rename to "purchase_prices"
[0m05:35:08.112174 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:35:08.146818 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: COMMIT
[0m05:35:08.148824 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:35:08.150630 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: COMMIT
[0m05:35:08.155113 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m05:35:08.168090 [debug] [Thread-1 (]: Applying DROP to: "amn_datawarehouse"."public"."purchase_prices__dbt_backup"
[0m05:35:08.178440 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:35:08.180787 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
drop table if exists "amn_datawarehouse"."public"."purchase_prices__dbt_backup" cascade
[0m05:35:08.185927 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m05:35:08.191132 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: Close
[0m05:35:08.195214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dd50cf7-4d44-4da0-95c0-a05669ded135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3abe2090>]}
[0m05:35:08.197990 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.purchase_prices ....................... [[32mSELECT 0[0m in 0.24s]
[0m05:35:08.200834 [debug] [Thread-1 (]: Finished running node model.amn_dbt.purchase_prices
[0m05:35:08.203889 [debug] [Thread-1 (]: Began running node model.amn_dbt.sales
[0m05:35:08.206748 [info ] [Thread-1 (]: 2 of 4 START sql table model public.sales ...................................... [RUN]
[0m05:35:08.209558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.amn_dbt.purchase_prices, now model.amn_dbt.sales)
[0m05:35:08.212278 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.sales
[0m05:35:08.217580 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.sales"
[0m05:35:08.227695 [debug] [Thread-1 (]: Began executing node model.amn_dbt.sales
[0m05:35:08.234489 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.sales"
[0m05:35:08.246515 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:35:08.248631 [debug] [Thread-1 (]: On model.amn_dbt.sales: BEGIN
[0m05:35:08.250964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:35:08.264186 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m05:35:08.266849 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:35:08.269294 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */

  
    

  create  table "amn_datawarehouse"."public"."sales__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    inventoryid,
    store,
    salesdescription AS SalesDescription, 
    salesprice,
    brand
FROM public.sales
  );
  
[0m05:35:08.275838 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m05:35:08.283293 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:35:08.285458 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */
alter table "amn_datawarehouse"."public"."sales" rename to "sales__dbt_backup"
[0m05:35:08.288323 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:35:08.295439 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:35:08.297726 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */
alter table "amn_datawarehouse"."public"."sales__dbt_tmp" rename to "sales"
[0m05:35:08.302446 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:35:08.308138 [debug] [Thread-1 (]: On model.amn_dbt.sales: COMMIT
[0m05:35:08.310350 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:35:08.314660 [debug] [Thread-1 (]: On model.amn_dbt.sales: COMMIT
[0m05:35:08.319394 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m05:35:08.325429 [debug] [Thread-1 (]: Applying DROP to: "amn_datawarehouse"."public"."sales__dbt_backup"
[0m05:35:08.328786 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:35:08.330732 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */
drop table if exists "amn_datawarehouse"."public"."sales__dbt_backup" cascade
[0m05:35:08.335542 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m05:35:08.339538 [debug] [Thread-1 (]: On model.amn_dbt.sales: Close
[0m05:35:08.342042 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dd50cf7-4d44-4da0-95c0-a05669ded135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3884be30>]}
[0m05:35:08.345053 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.sales ................................. [[32mSELECT 0[0m in 0.13s]
[0m05:35:08.348597 [debug] [Thread-1 (]: Finished running node model.amn_dbt.sales
[0m05:35:08.352662 [debug] [Thread-1 (]: Began running node model.amn_dbt.profit_and_margin
[0m05:35:08.356039 [info ] [Thread-1 (]: 3 of 4 START sql table model public.profit_and_margin .......................... [RUN]
[0m05:35:08.359644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.amn_dbt.sales, now model.amn_dbt.profit_and_margin)
[0m05:35:08.362998 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.profit_and_margin
[0m05:35:08.373722 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.profit_and_margin"
[0m05:35:08.386628 [debug] [Thread-1 (]: Began executing node model.amn_dbt.profit_and_margin
[0m05:35:08.397860 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.profit_and_margin"
[0m05:35:08.410806 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m05:35:08.413737 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: BEGIN
[0m05:35:08.415551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:35:08.428555 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m05:35:08.431056 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m05:35:08.433277 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.profit_and_margin"} */

  
    

  create  table "amn_datawarehouse"."public"."profit_and_margin__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    s.InventoryId,
    s.Store,
    s.SalesDescription, 
    s.SalesPrice,
    COALESCE(p.PurchasePrice, 0) AS PurchasePrice,
    (s.SalesPrice - COALESCE(p.PurchasePrice, 0)) AS Profit,
    (s.SalesPrice - COALESCE(p.PurchasePrice, 0)) / NULLIF(s.SalesPrice, 0) * 100 AS ProfitMargin
FROM 
    "amn_datawarehouse"."public"."sales" AS s 
LEFT JOIN 
    "amn_datawarehouse"."public"."purchase_prices" AS p
    ON s.Brand = p.Brand
  );
  
[0m05:35:08.440279 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m05:35:08.447504 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m05:35:08.449195 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.profit_and_margin"} */
alter table "amn_datawarehouse"."public"."profit_and_margin" rename to "profit_and_margin__dbt_backup"
[0m05:35:08.451482 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m05:35:08.458583 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m05:35:08.460808 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.profit_and_margin"} */
alter table "amn_datawarehouse"."public"."profit_and_margin__dbt_tmp" rename to "profit_and_margin"
[0m05:35:08.463579 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:35:08.467735 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: COMMIT
[0m05:35:08.469426 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m05:35:08.470920 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: COMMIT
[0m05:35:08.474596 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m05:35:08.480377 [debug] [Thread-1 (]: Applying DROP to: "amn_datawarehouse"."public"."profit_and_margin__dbt_backup"
[0m05:35:08.482836 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m05:35:08.484541 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.profit_and_margin"} */
drop table if exists "amn_datawarehouse"."public"."profit_and_margin__dbt_backup" cascade
[0m05:35:08.489813 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m05:35:08.493387 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: Close
[0m05:35:08.495982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dd50cf7-4d44-4da0-95c0-a05669ded135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b376e00b0>]}
[0m05:35:08.498891 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.profit_and_margin ..................... [[32mSELECT 0[0m in 0.14s]
[0m05:35:08.501649 [debug] [Thread-1 (]: Finished running node model.amn_dbt.profit_and_margin
[0m05:35:08.504999 [debug] [Thread-1 (]: Began running node model.amn_dbt.least_profitability
[0m05:35:08.507150 [info ] [Thread-1 (]: 4 of 4 START sql table model public.least_profitability ........................ [RUN]
[0m05:35:08.509934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.amn_dbt.profit_and_margin, now model.amn_dbt.least_profitability)
[0m05:35:08.512794 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.least_profitability
[0m05:35:08.521753 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.least_profitability"
[0m05:35:08.534721 [debug] [Thread-1 (]: Began executing node model.amn_dbt.least_profitability
[0m05:35:08.542044 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.least_profitability"
[0m05:35:08.556780 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.least_profitability"
[0m05:35:08.558551 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: BEGIN
[0m05:35:08.560474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:35:08.574014 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m05:35:08.577070 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.least_profitability"
[0m05:35:08.580276 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.least_profitability"} */

  
    

  create  table "amn_datawarehouse"."public"."least_profitability__dbt_tmp"
  
  
    as
  
  (
    WITH profit_data AS (
    SELECT 
        InventoryId,
        Store,
        SalesDescription,
        SalesPrice,
        PurchasePrice,
        Profit,
        ProfitMargin
    FROM "amn_datawarehouse"."public"."profit_and_margin"
)
SELECT 
    InventoryId,
    Store,
    SalesDescription,
    SalesPrice,
    PurchasePrice,
    Profit,
    ProfitMargin
FROM 
    profit_data
ORDER BY 
    Profit ASC
LIMIT 10
  );
  
[0m05:35:08.586455 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m05:35:08.593554 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.least_profitability"
[0m05:35:08.595977 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.least_profitability"} */
alter table "amn_datawarehouse"."public"."least_profitability" rename to "least_profitability__dbt_backup"
[0m05:35:08.599014 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:35:08.605384 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.least_profitability"
[0m05:35:08.607489 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.least_profitability"} */
alter table "amn_datawarehouse"."public"."least_profitability__dbt_tmp" rename to "least_profitability"
[0m05:35:08.610296 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:35:08.618553 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: COMMIT
[0m05:35:08.620996 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.least_profitability"
[0m05:35:08.623214 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: COMMIT
[0m05:35:08.632767 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m05:35:08.638479 [debug] [Thread-1 (]: Applying DROP to: "amn_datawarehouse"."public"."least_profitability__dbt_backup"
[0m05:35:08.640847 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.least_profitability"
[0m05:35:08.642779 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.least_profitability"} */
drop table if exists "amn_datawarehouse"."public"."least_profitability__dbt_backup" cascade
[0m05:35:08.647894 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m05:35:08.651544 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: Close
[0m05:35:08.653657 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dd50cf7-4d44-4da0-95c0-a05669ded135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b35e0c680>]}
[0m05:35:08.656226 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.least_profitability ................... [[32mSELECT 0[0m in 0.14s]
[0m05:35:08.659670 [debug] [Thread-1 (]: Finished running node model.amn_dbt.least_profitability
[0m05:35:08.665039 [debug] [MainThread]: Using postgres connection "master"
[0m05:35:08.667509 [debug] [MainThread]: On master: BEGIN
[0m05:35:08.669266 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:35:08.682453 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m05:35:08.684551 [debug] [MainThread]: On master: COMMIT
[0m05:35:08.687016 [debug] [MainThread]: Using postgres connection "master"
[0m05:35:08.690174 [debug] [MainThread]: On master: COMMIT
[0m05:35:08.692622 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:35:08.695088 [debug] [MainThread]: On master: Close
[0m05:35:08.697037 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:35:08.698872 [debug] [MainThread]: Connection 'model.amn_dbt.least_profitability' was properly closed.
[0m05:35:08.701346 [info ] [MainThread]: 
[0m05:35:08.703886 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.97 seconds (0.97s).
[0m05:35:08.708806 [debug] [MainThread]: Command end result
[0m05:35:08.783997 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m05:35:08.794006 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m05:35:08.822617 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m05:35:08.825454 [info ] [MainThread]: 
[0m05:35:08.829648 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:35:08.834031 [info ] [MainThread]: 
[0m05:35:08.837718 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m05:35:08.845219 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.182283, "process_in_blocks": "0", "process_kernel_time": 0.295193, "process_mem_max_rss": "107384", "process_out_blocks": "0", "process_user_time": 3.443919}
[0m05:35:08.848749 [debug] [MainThread]: Command `dbt run` succeeded at 05:35:08.848279 after 2.19 seconds
[0m05:35:08.851480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3a7c94c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b387b4380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b377b24b0>]}
[0m05:35:08.853998 [debug] [MainThread]: Flushing usage events
[0m05:35:09.536578 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:46:11.877529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1595bba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd15aa97740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd159148560>]}


============================== 05:46:11.929086 | b3a93b26-b1f0-4730-a25b-45cbf7ceeda9 ==============================
[0m05:46:11.929086 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:46:11.939640 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:46:13.649949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3a93b26-b1f0-4730-a25b-45cbf7ceeda9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1590bae70>]}
[0m05:46:14.323800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3a93b26-b1f0-4730-a25b-45cbf7ceeda9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1590d7110>]}
[0m05:46:14.346217 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:46:15.299962 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:46:16.563012 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:46:16.568564 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:46:16.905835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3a93b26-b1f0-4730-a25b-45cbf7ceeda9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1578754c0>]}
[0m05:46:17.609830 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m05:46:17.656118 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m05:46:17.900277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3a93b26-b1f0-4730-a25b-45cbf7ceeda9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1575206e0>]}
[0m05:46:17.915717 [info ] [MainThread]: Found 4 models, 429 macros
[0m05:46:17.920666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3a93b26-b1f0-4730-a25b-45cbf7ceeda9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1575e5940>]}
[0m05:46:17.957454 [info ] [MainThread]: 
[0m05:46:17.973735 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:46:17.994140 [info ] [MainThread]: 
[0m05:46:18.006860 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:46:18.093406 [debug] [ThreadPool]: Acquiring new postgres connection 'list_amn_datawarehouse'
[0m05:46:18.636173 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse"
[0m05:46:18.641887 [debug] [ThreadPool]: On list_amn_datawarehouse: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse"} */

    select distinct nspname from pg_namespace
  
[0m05:46:18.645518 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:46:18.799127 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.153 seconds
[0m05:46:18.815476 [debug] [ThreadPool]: On list_amn_datawarehouse: Close
[0m05:46:18.829631 [debug] [ThreadPool]: Acquiring new postgres connection 'list_amn_datawarehouse_public'
[0m05:46:18.860301 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m05:46:18.884426 [debug] [ThreadPool]: On list_amn_datawarehouse_public: BEGIN
[0m05:46:18.895565 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:46:18.957586 [debug] [ThreadPool]: SQL status: BEGIN in 0.062 seconds
[0m05:46:18.968031 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m05:46:18.971413 [debug] [ThreadPool]: On list_amn_datawarehouse_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse_public"} */
select
      'amn_datawarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m05:46:18.996021 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.020 seconds
[0m05:46:19.029881 [debug] [ThreadPool]: On list_amn_datawarehouse_public: ROLLBACK
[0m05:46:19.033929 [debug] [ThreadPool]: On list_amn_datawarehouse_public: Close
[0m05:46:19.126421 [debug] [MainThread]: Using postgres connection "master"
[0m05:46:19.143073 [debug] [MainThread]: On master: BEGIN
[0m05:46:19.155632 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:46:19.223194 [debug] [MainThread]: SQL status: BEGIN in 0.068 seconds
[0m05:46:19.234192 [debug] [MainThread]: Using postgres connection "master"
[0m05:46:19.239214 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:46:19.332526 [debug] [MainThread]: SQL status: SELECT 0 in 0.031 seconds
[0m05:46:19.346177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3a93b26-b1f0-4730-a25b-45cbf7ceeda9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1578574a0>]}
[0m05:46:19.357630 [debug] [MainThread]: On master: ROLLBACK
[0m05:46:19.365771 [debug] [MainThread]: Using postgres connection "master"
[0m05:46:19.370926 [debug] [MainThread]: On master: BEGIN
[0m05:46:19.376492 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m05:46:19.390045 [debug] [MainThread]: On master: COMMIT
[0m05:46:19.398295 [debug] [MainThread]: Using postgres connection "master"
[0m05:46:19.404085 [debug] [MainThread]: On master: COMMIT
[0m05:46:19.409318 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m05:46:19.423150 [debug] [MainThread]: On master: Close
[0m05:46:19.450613 [debug] [Thread-1 (]: Began running node model.amn_dbt.purchase_prices
[0m05:46:19.464179 [info ] [Thread-1 (]: 1 of 4 START sql table model public.purchase_prices ............................ [RUN]
[0m05:46:19.471259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_amn_datawarehouse_public, now model.amn_dbt.purchase_prices)
[0m05:46:19.485686 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.purchase_prices
[0m05:46:19.551846 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.purchase_prices"
[0m05:46:19.589794 [debug] [Thread-1 (]: Began executing node model.amn_dbt.purchase_prices
[0m05:46:19.976506 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.purchase_prices"
[0m05:46:20.031915 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:46:20.039184 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: BEGIN
[0m05:46:20.043321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:46:20.108478 [debug] [Thread-1 (]: SQL status: BEGIN in 0.065 seconds
[0m05:46:20.114222 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:46:20.128922 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */

  
    

  create  table "amn_datawarehouse"."public"."purchase_prices__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    Brand,
    PurchasePrice
FROM public.purchase_prices
  );
  
[0m05:46:20.193922 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.040 seconds
[0m05:46:20.257091 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:46:20.272037 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
alter table "amn_datawarehouse"."public"."purchase_prices" rename to "purchase_prices__dbt_backup"
[0m05:46:20.305004 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m05:46:20.398627 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:46:20.411042 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
alter table "amn_datawarehouse"."public"."purchase_prices__dbt_tmp" rename to "purchase_prices"
[0m05:46:20.425407 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:46:20.601821 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: COMMIT
[0m05:46:20.613195 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:46:20.617448 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: COMMIT
[0m05:46:20.631709 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m05:46:20.733005 [debug] [Thread-1 (]: Applying DROP to: "amn_datawarehouse"."public"."purchase_prices__dbt_backup"
[0m05:46:20.850928 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:46:20.856324 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
drop table if exists "amn_datawarehouse"."public"."purchase_prices__dbt_backup" cascade
[0m05:46:20.893870 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.029 seconds
[0m05:46:20.948538 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: Close
[0m05:46:21.034182 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3a93b26-b1f0-4730-a25b-45cbf7ceeda9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd15ae2a5a0>]}
[0m05:46:21.042594 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.purchase_prices ....................... [[32mSELECT 0[0m in 1.55s]
[0m05:46:21.055799 [debug] [Thread-1 (]: Finished running node model.amn_dbt.purchase_prices
[0m05:46:21.066593 [debug] [Thread-1 (]: Began running node model.amn_dbt.sales
[0m05:46:21.083896 [info ] [Thread-1 (]: 2 of 4 START sql table model public.sales ...................................... [RUN]
[0m05:46:21.117778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.amn_dbt.purchase_prices, now model.amn_dbt.sales)
[0m05:46:21.123393 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.sales
[0m05:46:21.159660 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.sales"
[0m05:46:21.243586 [debug] [Thread-1 (]: Began executing node model.amn_dbt.sales
[0m05:46:21.396863 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.sales"
[0m05:46:21.492860 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:46:21.525978 [debug] [Thread-1 (]: On model.amn_dbt.sales: BEGIN
[0m05:46:21.536915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:46:21.595025 [debug] [Thread-1 (]: SQL status: BEGIN in 0.058 seconds
[0m05:46:21.603941 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:46:21.614326 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */

  
    

  create  table "amn_datawarehouse"."public"."sales__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    inventoryid,
    store,
    salesdescription AS SalesDescription, 
    salesprice,
    brand
FROM public.sales
  );
  
[0m05:46:21.649233 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.030 seconds
[0m05:46:21.695370 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:46:21.746419 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */
alter table "amn_datawarehouse"."public"."sales" rename to "sales__dbt_backup"
[0m05:46:21.768072 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:46:21.791174 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:46:21.813638 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */
alter table "amn_datawarehouse"."public"."sales__dbt_tmp" rename to "sales"
[0m05:46:21.830334 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:46:21.859626 [debug] [Thread-1 (]: On model.amn_dbt.sales: COMMIT
[0m05:46:21.873355 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:46:21.886899 [debug] [Thread-1 (]: On model.amn_dbt.sales: COMMIT
[0m05:46:21.903022 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m05:46:21.930084 [debug] [Thread-1 (]: Applying DROP to: "amn_datawarehouse"."public"."sales__dbt_backup"
[0m05:46:21.939349 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:46:21.952622 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */
drop table if exists "amn_datawarehouse"."public"."sales__dbt_backup" cascade
[0m05:46:21.992681 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.021 seconds
[0m05:46:22.012889 [debug] [Thread-1 (]: On model.amn_dbt.sales: Close
[0m05:46:22.017827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3a93b26-b1f0-4730-a25b-45cbf7ceeda9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1568c1490>]}
[0m05:46:22.029671 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.sales ................................. [[32mSELECT 0[0m in 0.90s]
[0m05:46:22.057188 [debug] [Thread-1 (]: Finished running node model.amn_dbt.sales
[0m05:46:22.066985 [debug] [Thread-1 (]: Began running node model.amn_dbt.profit_and_margin
[0m05:46:22.078680 [info ] [Thread-1 (]: 3 of 4 START sql table model public.profit_and_margin .......................... [RUN]
[0m05:46:22.109296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.amn_dbt.sales, now model.amn_dbt.profit_and_margin)
[0m05:46:22.122070 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.profit_and_margin
[0m05:46:22.151011 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.profit_and_margin"
[0m05:46:22.200806 [debug] [Thread-1 (]: Began executing node model.amn_dbt.profit_and_margin
[0m05:46:22.249999 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.profit_and_margin"
[0m05:46:22.282904 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m05:46:22.303405 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: BEGIN
[0m05:46:22.321470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:46:22.372177 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m05:46:22.377809 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m05:46:22.395757 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.profit_and_margin"} */

  
    

  create  table "amn_datawarehouse"."public"."profit_and_margin__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    s.InventoryId,
    s.Store,
    s.SalesDescription, 
    s.SalesPrice,
    COALESCE(p.PurchasePrice, 0) AS PurchasePrice,
    (s.SalesPrice - COALESCE(p.PurchasePrice, 0)) AS Profit,
    (s.SalesPrice - COALESCE(p.PurchasePrice, 0)) / NULLIF(s.SalesPrice, 0) * 100 AS ProfitMargin
FROM 
    "amn_datawarehouse"."public"."sales" AS s 
LEFT JOIN 
    "amn_datawarehouse"."public"."purchase_prices" AS p
    ON s.Brand = p.Brand
  );
  
[0m05:46:22.421431 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.016 seconds
[0m05:46:22.487875 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m05:46:22.492997 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.profit_and_margin"} */
alter table "amn_datawarehouse"."public"."profit_and_margin" rename to "profit_and_margin__dbt_backup"
[0m05:46:22.498841 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:46:22.520875 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m05:46:22.524777 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.profit_and_margin"} */
alter table "amn_datawarehouse"."public"."profit_and_margin__dbt_tmp" rename to "profit_and_margin"
[0m05:46:22.530029 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:46:22.542365 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: COMMIT
[0m05:46:22.551675 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m05:46:22.555988 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: COMMIT
[0m05:46:22.564929 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m05:46:22.592067 [debug] [Thread-1 (]: Applying DROP to: "amn_datawarehouse"."public"."profit_and_margin__dbt_backup"
[0m05:46:22.606043 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m05:46:22.615648 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.profit_and_margin"} */
drop table if exists "amn_datawarehouse"."public"."profit_and_margin__dbt_backup" cascade
[0m05:46:22.632503 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.013 seconds
[0m05:46:22.641124 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: Close
[0m05:46:22.658058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3a93b26-b1f0-4730-a25b-45cbf7ceeda9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1568ae810>]}
[0m05:46:22.670989 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.profit_and_margin ..................... [[32mSELECT 0[0m in 0.55s]
[0m05:46:22.677684 [debug] [Thread-1 (]: Finished running node model.amn_dbt.profit_and_margin
[0m05:46:22.683283 [debug] [Thread-1 (]: Began running node model.amn_dbt.least_profitability
[0m05:46:22.722948 [info ] [Thread-1 (]: 4 of 4 START sql table model public.least_profitability ........................ [RUN]
[0m05:46:22.742700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.amn_dbt.profit_and_margin, now model.amn_dbt.least_profitability)
[0m05:46:22.751254 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.least_profitability
[0m05:46:22.781996 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.least_profitability"
[0m05:46:22.832901 [debug] [Thread-1 (]: Began executing node model.amn_dbt.least_profitability
[0m05:46:22.870093 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.least_profitability"
[0m05:46:22.911383 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.least_profitability"
[0m05:46:22.915546 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: BEGIN
[0m05:46:22.926400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:46:22.959641 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m05:46:22.975276 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.least_profitability"
[0m05:46:22.987834 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.least_profitability"} */

  
    

  create  table "amn_datawarehouse"."public"."least_profitability__dbt_tmp"
  
  
    as
  
  (
    WITH profit_data AS (
    SELECT 
        InventoryId,
        Store,
        SalesDescription,
        SalesPrice,
        PurchasePrice,
        Profit,
        ProfitMargin
    FROM "amn_datawarehouse"."public"."profit_and_margin"
)
SELECT 
    InventoryId,
    Store,
    SalesDescription,
    SalesPrice,
    PurchasePrice,
    Profit,
    ProfitMargin
FROM 
    profit_data
ORDER BY 
    Profit ASC
LIMIT 10
  );
  
[0m05:46:23.050859 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.030 seconds
[0m05:46:23.110347 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.least_profitability"
[0m05:46:23.126387 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.least_profitability"} */
alter table "amn_datawarehouse"."public"."least_profitability" rename to "least_profitability__dbt_backup"
[0m05:46:23.135100 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:46:23.169112 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.least_profitability"
[0m05:46:23.182673 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.least_profitability"} */
alter table "amn_datawarehouse"."public"."least_profitability__dbt_tmp" rename to "least_profitability"
[0m05:46:23.190073 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m05:46:23.205264 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: COMMIT
[0m05:46:23.211077 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.least_profitability"
[0m05:46:23.216577 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: COMMIT
[0m05:46:23.236240 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m05:46:23.255231 [debug] [Thread-1 (]: Applying DROP to: "amn_datawarehouse"."public"."least_profitability__dbt_backup"
[0m05:46:23.260631 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.least_profitability"
[0m05:46:23.266962 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.least_profitability"} */
drop table if exists "amn_datawarehouse"."public"."least_profitability__dbt_backup" cascade
[0m05:46:23.279329 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m05:46:23.288321 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: Close
[0m05:46:23.292645 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3a93b26-b1f0-4730-a25b-45cbf7ceeda9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd154de5100>]}
[0m05:46:23.307369 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.least_profitability ................... [[32mSELECT 0[0m in 0.55s]
[0m05:46:23.313456 [debug] [Thread-1 (]: Finished running node model.amn_dbt.least_profitability
[0m05:46:23.328377 [debug] [MainThread]: Using postgres connection "master"
[0m05:46:23.334938 [debug] [MainThread]: On master: BEGIN
[0m05:46:23.338324 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:46:23.379092 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m05:46:23.383149 [debug] [MainThread]: On master: COMMIT
[0m05:46:23.390441 [debug] [MainThread]: Using postgres connection "master"
[0m05:46:23.395102 [debug] [MainThread]: On master: COMMIT
[0m05:46:23.399034 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:46:23.408603 [debug] [MainThread]: On master: Close
[0m05:46:23.412423 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:46:23.415746 [debug] [MainThread]: Connection 'list_amn_datawarehouse' was properly closed.
[0m05:46:23.424439 [debug] [MainThread]: Connection 'model.amn_dbt.least_profitability' was properly closed.
[0m05:46:23.429996 [info ] [MainThread]: 
[0m05:46:23.435303 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 5.42 seconds (5.42s).
[0m05:46:23.449516 [debug] [MainThread]: Command end result
[0m05:46:23.616408 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m05:46:23.629716 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m05:46:23.662855 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m05:46:23.665890 [info ] [MainThread]: 
[0m05:46:23.669625 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:46:23.673918 [info ] [MainThread]: 
[0m05:46:23.678125 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m05:46:23.685973 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.626, "process_in_blocks": "13432", "process_kernel_time": 4.558171, "process_mem_max_rss": "107648", "process_out_blocks": "0", "process_user_time": 14.351273}
[0m05:46:23.690167 [debug] [MainThread]: Command `dbt run` succeeded at 05:46:23.689460 after 12.63 seconds
[0m05:46:23.694355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd159418410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1591a95b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd156752f00>]}
[0m05:46:23.698293 [debug] [MainThread]: Flushing usage events
[0m05:46:24.456144 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:51:18.204973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4533cc4080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4533cc5160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4533cc55b0>]}


============================== 05:51:18.227474 | 98ffe0b2-3b22-4c19-b76a-0e6971520524 ==============================
[0m05:51:18.227474 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:51:18.233359 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:51:19.043508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98ffe0b2-3b22-4c19-b76a-0e6971520524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4533c045f0>]}
[0m05:51:19.322337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98ffe0b2-3b22-4c19-b76a-0e6971520524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4533d69340>]}
[0m05:51:19.327126 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:51:19.626017 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:51:20.138722 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:51:20.142492 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:51:20.317236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98ffe0b2-3b22-4c19-b76a-0e6971520524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45324232f0>]}
[0m05:51:20.645339 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m05:51:20.667018 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m05:51:20.814646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98ffe0b2-3b22-4c19-b76a-0e6971520524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4532368410>]}
[0m05:51:20.818078 [info ] [MainThread]: Found 4 models, 429 macros
[0m05:51:20.822733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98ffe0b2-3b22-4c19-b76a-0e6971520524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4532436f30>]}
[0m05:51:20.835684 [info ] [MainThread]: 
[0m05:51:20.840677 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:51:20.845485 [info ] [MainThread]: 
[0m05:51:20.851859 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:51:20.880098 [debug] [ThreadPool]: Acquiring new postgres connection 'list_amn_datawarehouse'
[0m05:51:21.072973 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse"
[0m05:51:21.075663 [debug] [ThreadPool]: On list_amn_datawarehouse: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse"} */

    select distinct nspname from pg_namespace
  
[0m05:51:21.078280 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:51:21.106094 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.028 seconds
[0m05:51:21.112488 [debug] [ThreadPool]: On list_amn_datawarehouse: Close
[0m05:51:21.119692 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_amn_datawarehouse, now list_amn_datawarehouse_public)
[0m05:51:21.147915 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m05:51:21.150837 [debug] [ThreadPool]: On list_amn_datawarehouse_public: BEGIN
[0m05:51:21.154334 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:51:21.173693 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m05:51:21.177547 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m05:51:21.181249 [debug] [ThreadPool]: On list_amn_datawarehouse_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse_public"} */
select
      'amn_datawarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m05:51:21.193962 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m05:51:21.200954 [debug] [ThreadPool]: On list_amn_datawarehouse_public: ROLLBACK
[0m05:51:21.204062 [debug] [ThreadPool]: On list_amn_datawarehouse_public: Close
[0m05:51:21.224875 [debug] [MainThread]: Using postgres connection "master"
[0m05:51:21.227746 [debug] [MainThread]: On master: BEGIN
[0m05:51:21.230785 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:51:21.253919 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m05:51:21.258778 [debug] [MainThread]: Using postgres connection "master"
[0m05:51:21.264071 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:51:21.285573 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m05:51:21.291578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98ffe0b2-3b22-4c19-b76a-0e6971520524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f453740e8a0>]}
[0m05:51:21.296291 [debug] [MainThread]: On master: ROLLBACK
[0m05:51:21.302408 [debug] [MainThread]: Using postgres connection "master"
[0m05:51:21.306392 [debug] [MainThread]: On master: BEGIN
[0m05:51:21.311391 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:51:21.315586 [debug] [MainThread]: On master: COMMIT
[0m05:51:21.319914 [debug] [MainThread]: Using postgres connection "master"
[0m05:51:21.326021 [debug] [MainThread]: On master: COMMIT
[0m05:51:21.329954 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:51:21.334102 [debug] [MainThread]: On master: Close
[0m05:51:21.342531 [debug] [Thread-1 (]: Began running node model.amn_dbt.purchase_prices
[0m05:51:21.346125 [info ] [Thread-1 (]: 1 of 4 START sql table model public.purchase_prices ............................ [RUN]
[0m05:51:21.350430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_amn_datawarehouse_public, now model.amn_dbt.purchase_prices)
[0m05:51:21.355790 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.purchase_prices
[0m05:51:21.386978 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.purchase_prices"
[0m05:51:21.407539 [debug] [Thread-1 (]: Began executing node model.amn_dbt.purchase_prices
[0m05:51:21.558384 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.purchase_prices"
[0m05:51:21.570435 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:51:21.573105 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: BEGIN
[0m05:51:21.575005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:51:21.589868 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m05:51:21.592758 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:51:21.595518 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */

  
    

  create  table "amn_datawarehouse"."public"."purchase_prices__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    Brand,
    PurchasePrice
FROM public.purchase_prices
  );
  
[0m05:51:21.603751 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m05:51:21.618457 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:51:21.620548 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
alter table "amn_datawarehouse"."public"."purchase_prices" rename to "purchase_prices__dbt_backup"
[0m05:51:21.623132 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:51:21.630635 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:51:21.632811 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
alter table "amn_datawarehouse"."public"."purchase_prices__dbt_tmp" rename to "purchase_prices"
[0m05:51:21.635411 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:51:21.681256 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: COMMIT
[0m05:51:21.683509 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:51:21.685463 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: COMMIT
[0m05:51:21.689145 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m05:51:21.703074 [debug] [Thread-1 (]: Applying DROP to: "amn_datawarehouse"."public"."purchase_prices__dbt_backup"
[0m05:51:21.715116 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:51:21.717099 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
drop table if exists "amn_datawarehouse"."public"."purchase_prices__dbt_backup" cascade
[0m05:51:21.722879 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m05:51:21.728791 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: Close
[0m05:51:21.734641 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98ffe0b2-3b22-4c19-b76a-0e6971520524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f453131b980>]}
[0m05:51:21.737636 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.purchase_prices ....................... [[32mSELECT 0[0m in 0.38s]
[0m05:51:21.741826 [debug] [Thread-1 (]: Finished running node model.amn_dbt.purchase_prices
[0m05:51:21.745311 [debug] [Thread-1 (]: Began running node model.amn_dbt.sales
[0m05:51:21.749042 [info ] [Thread-1 (]: 2 of 4 START sql table model public.sales ...................................... [RUN]
[0m05:51:21.752285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.amn_dbt.purchase_prices, now model.amn_dbt.sales)
[0m05:51:21.755060 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.sales
[0m05:51:21.761829 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.sales"
[0m05:51:21.775385 [debug] [Thread-1 (]: Began executing node model.amn_dbt.sales
[0m05:51:21.785694 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.sales"
[0m05:51:21.799969 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:51:21.801904 [debug] [Thread-1 (]: On model.amn_dbt.sales: BEGIN
[0m05:51:21.803774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:51:21.818539 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m05:51:21.821064 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:51:21.823784 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */

  
    

  create  table "amn_datawarehouse"."public"."sales__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    inventoryid,
    store,
    salesdescription AS SalesDescription, 
    salesprice,
    brand
FROM public.sales
  );
  
[0m05:51:21.828032 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "salesdescription" does not exist
LINE 15:     salesdescription AS SalesDescription, 
             ^

[0m05:51:21.831115 [debug] [Thread-1 (]: On model.amn_dbt.sales: ROLLBACK
[0m05:51:21.834318 [debug] [Thread-1 (]: On model.amn_dbt.sales: Close
[0m05:51:21.844952 [debug] [Thread-1 (]: Database Error in model sales (models/sales.sql)
  column "salesdescription" does not exist
  LINE 15:     salesdescription AS SalesDescription, 
               ^
  compiled code at target/run/amn_dbt/models/sales.sql
[0m05:51:21.847546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98ffe0b2-3b22-4c19-b76a-0e6971520524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45301a2720>]}
[0m05:51:21.850577 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.sales ............................. [[31mERROR[0m in 0.10s]
[0m05:51:21.855359 [debug] [Thread-1 (]: Finished running node model.amn_dbt.sales
[0m05:51:21.858944 [debug] [Thread-4 (]: Marking all children of 'model.amn_dbt.sales' to be skipped because of status 'error'.  Reason: Database Error in model sales (models/sales.sql)
  column "salesdescription" does not exist
  LINE 15:     salesdescription AS SalesDescription, 
               ^
  compiled code at target/run/amn_dbt/models/sales.sql.
[0m05:51:21.864560 [debug] [Thread-1 (]: Began running node model.amn_dbt.profit_and_margin
[0m05:51:21.866912 [info ] [Thread-1 (]: 3 of 4 SKIP relation public.profit_and_margin .................................. [[33mSKIP[0m]
[0m05:51:21.869517 [debug] [Thread-1 (]: Finished running node model.amn_dbt.profit_and_margin
[0m05:51:21.873803 [debug] [Thread-1 (]: Began running node model.amn_dbt.least_profitability
[0m05:51:21.876853 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.least_profitability ................................ [[33mSKIP[0m]
[0m05:51:21.879784 [debug] [Thread-1 (]: Finished running node model.amn_dbt.least_profitability
[0m05:51:21.885059 [debug] [MainThread]: Using postgres connection "master"
[0m05:51:21.887801 [debug] [MainThread]: On master: BEGIN
[0m05:51:21.889931 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:51:21.904048 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m05:51:21.906760 [debug] [MainThread]: On master: COMMIT
[0m05:51:21.909047 [debug] [MainThread]: Using postgres connection "master"
[0m05:51:21.911237 [debug] [MainThread]: On master: COMMIT
[0m05:51:21.914348 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:51:21.916635 [debug] [MainThread]: On master: Close
[0m05:51:21.918749 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:51:21.920701 [debug] [MainThread]: Connection 'model.amn_dbt.sales' was properly closed.
[0m05:51:21.923220 [info ] [MainThread]: 
[0m05:51:21.926051 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.07 seconds (1.07s).
[0m05:51:21.930300 [debug] [MainThread]: Command end result
[0m05:51:22.029533 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m05:51:22.043563 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m05:51:22.068495 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m05:51:22.070793 [info ] [MainThread]: 
[0m05:51:22.073851 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m05:51:22.076851 [info ] [MainThread]: 
[0m05:51:22.080220 [error] [MainThread]:   Database Error in model sales (models/sales.sql)
  column "salesdescription" does not exist
  LINE 15:     salesdescription AS SalesDescription, 
               ^
  compiled code at target/run/amn_dbt/models/sales.sql
[0m05:51:22.083251 [info ] [MainThread]: 
[0m05:51:22.086206 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 TOTAL=4
[0m05:51:22.090980 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.1460314, "process_in_blocks": "0", "process_kernel_time": 1.248425, "process_mem_max_rss": "108260", "process_out_blocks": "1600", "process_user_time": 10.760235}
[0m05:51:22.093834 [debug] [MainThread]: Command `dbt run` failed at 05:51:22.093374 after 4.15 seconds
[0m05:51:22.097127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f453492fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4533cc4080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f453219bec0>]}
[0m05:51:22.099920 [debug] [MainThread]: Flushing usage events
[0m05:51:22.884811 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:52:52.318609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f423a54aae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f423a787c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f423bc3ce00>]}


============================== 05:52:52.329151 | 743d31b6-cfd1-4df0-a031-aad83405fccb ==============================
[0m05:52:52.329151 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:52:52.332932 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:52:52.718281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '743d31b6-cfd1-4df0-a031-aad83405fccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42387582f0>]}
[0m05:52:52.844252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '743d31b6-cfd1-4df0-a031-aad83405fccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4239f72720>]}
[0m05:52:52.847435 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:52:53.012442 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:52:53.300964 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:52:53.303114 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:52:53.358997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '743d31b6-cfd1-4df0-a031-aad83405fccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42387cdcd0>]}
[0m05:52:53.505269 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m05:52:53.516578 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m05:52:53.569211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '743d31b6-cfd1-4df0-a031-aad83405fccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42384b4860>]}
[0m05:52:53.571656 [info ] [MainThread]: Found 4 models, 429 macros
[0m05:52:53.575074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '743d31b6-cfd1-4df0-a031-aad83405fccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f423a5a4bc0>]}
[0m05:52:53.580960 [info ] [MainThread]: 
[0m05:52:53.583697 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:52:53.586454 [info ] [MainThread]: 
[0m05:52:53.589987 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:52:53.600589 [debug] [ThreadPool]: Acquiring new postgres connection 'list_amn_datawarehouse'
[0m05:52:53.701492 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse"
[0m05:52:53.703475 [debug] [ThreadPool]: On list_amn_datawarehouse: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse"} */

    select distinct nspname from pg_namespace
  
[0m05:52:53.705424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:52:53.739433 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.034 seconds
[0m05:52:53.743138 [debug] [ThreadPool]: On list_amn_datawarehouse: Close
[0m05:52:53.748859 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_amn_datawarehouse, now list_amn_datawarehouse_public)
[0m05:52:53.764036 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m05:52:53.765990 [debug] [ThreadPool]: On list_amn_datawarehouse_public: BEGIN
[0m05:52:53.768080 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:52:53.780921 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m05:52:53.783205 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m05:52:53.785564 [debug] [ThreadPool]: On list_amn_datawarehouse_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse_public"} */
select
      'amn_datawarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m05:52:53.794674 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m05:52:53.798055 [debug] [ThreadPool]: On list_amn_datawarehouse_public: ROLLBACK
[0m05:52:53.800009 [debug] [ThreadPool]: On list_amn_datawarehouse_public: Close
[0m05:52:53.811584 [debug] [MainThread]: Using postgres connection "master"
[0m05:52:53.813463 [debug] [MainThread]: On master: BEGIN
[0m05:52:53.815111 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:52:53.828146 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m05:52:53.830170 [debug] [MainThread]: Using postgres connection "master"
[0m05:52:53.832286 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:52:53.842646 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m05:52:53.846274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '743d31b6-cfd1-4df0-a031-aad83405fccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42387ef440>]}
[0m05:52:53.848185 [debug] [MainThread]: On master: ROLLBACK
[0m05:52:53.850074 [debug] [MainThread]: Using postgres connection "master"
[0m05:52:53.851980 [debug] [MainThread]: On master: BEGIN
[0m05:52:53.854250 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m05:52:53.856333 [debug] [MainThread]: On master: COMMIT
[0m05:52:53.858288 [debug] [MainThread]: Using postgres connection "master"
[0m05:52:53.859978 [debug] [MainThread]: On master: COMMIT
[0m05:52:53.861892 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:52:53.863852 [debug] [MainThread]: On master: Close
[0m05:52:53.868756 [debug] [Thread-1 (]: Began running node model.amn_dbt.purchase_prices
[0m05:52:53.870818 [info ] [Thread-1 (]: 1 of 4 START sql table model public.purchase_prices ............................ [RUN]
[0m05:52:53.873737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_amn_datawarehouse_public, now model.amn_dbt.purchase_prices)
[0m05:52:53.875805 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.purchase_prices
[0m05:52:53.890798 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.purchase_prices"
[0m05:52:53.906819 [debug] [Thread-1 (]: Began executing node model.amn_dbt.purchase_prices
[0m05:52:54.009435 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.purchase_prices"
[0m05:52:54.023520 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:52:54.025587 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: BEGIN
[0m05:52:54.027258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:52:54.042862 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m05:52:54.045689 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:52:54.048088 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */

  
    

  create  table "amn_datawarehouse"."public"."purchase_prices__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    Brand,
    PurchasePrice
FROM public.purchase_prices
  );
  
[0m05:52:54.054112 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m05:52:54.069322 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:52:54.072012 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
alter table "amn_datawarehouse"."public"."purchase_prices" rename to "purchase_prices__dbt_backup"
[0m05:52:54.074904 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:52:54.084171 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:52:54.087041 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
alter table "amn_datawarehouse"."public"."purchase_prices__dbt_tmp" rename to "purchase_prices"
[0m05:52:54.089755 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:52:54.133882 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: COMMIT
[0m05:52:54.136462 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:52:54.138335 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: COMMIT
[0m05:52:54.158717 [debug] [Thread-1 (]: SQL status: COMMIT in 0.019 seconds
[0m05:52:54.173828 [debug] [Thread-1 (]: Applying DROP to: "amn_datawarehouse"."public"."purchase_prices__dbt_backup"
[0m05:52:54.186958 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:52:54.189121 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
drop table if exists "amn_datawarehouse"."public"."purchase_prices__dbt_backup" cascade
[0m05:52:54.218135 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.027 seconds
[0m05:52:54.224316 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: Close
[0m05:52:54.229153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '743d31b6-cfd1-4df0-a031-aad83405fccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f423aace0c0>]}
[0m05:52:54.231723 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.purchase_prices ....................... [[32mSELECT 0[0m in 0.35s]
[0m05:52:54.235125 [debug] [Thread-1 (]: Finished running node model.amn_dbt.purchase_prices
[0m05:52:54.237564 [debug] [Thread-1 (]: Began running node model.amn_dbt.sales
[0m05:52:54.240126 [info ] [Thread-1 (]: 2 of 4 START sql table model public.sales ...................................... [RUN]
[0m05:52:54.242802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.amn_dbt.purchase_prices, now model.amn_dbt.sales)
[0m05:52:54.245200 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.sales
[0m05:52:54.250203 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.sales"
[0m05:52:54.261170 [debug] [Thread-1 (]: Began executing node model.amn_dbt.sales
[0m05:52:54.269430 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.sales"
[0m05:52:54.284700 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:52:54.286877 [debug] [Thread-1 (]: On model.amn_dbt.sales: BEGIN
[0m05:52:54.289203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:52:54.307167 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m05:52:54.309371 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:52:54.311619 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */

  
    

  create  table "amn_datawarehouse"."public"."sales__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    inventoryid,
    store,
    salesdescription AS SalesDescription, 
    salesprice,
    brand
FROM public.sales
  );
  
[0m05:52:54.315778 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "salesdescription" does not exist
LINE 15:     salesdescription AS SalesDescription, 
             ^

[0m05:52:54.318750 [debug] [Thread-1 (]: On model.amn_dbt.sales: ROLLBACK
[0m05:52:54.321155 [debug] [Thread-1 (]: On model.amn_dbt.sales: Close
[0m05:52:54.337943 [debug] [Thread-1 (]: Database Error in model sales (models/sales.sql)
  column "salesdescription" does not exist
  LINE 15:     salesdescription AS SalesDescription, 
               ^
  compiled code at target/run/amn_dbt/models/sales.sql
[0m05:52:54.340827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '743d31b6-cfd1-4df0-a031-aad83405fccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4237931280>]}
[0m05:52:54.343429 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.sales ............................. [[31mERROR[0m in 0.10s]
[0m05:52:54.347376 [debug] [Thread-1 (]: Finished running node model.amn_dbt.sales
[0m05:52:54.350136 [debug] [Thread-4 (]: Marking all children of 'model.amn_dbt.sales' to be skipped because of status 'error'.  Reason: Database Error in model sales (models/sales.sql)
  column "salesdescription" does not exist
  LINE 15:     salesdescription AS SalesDescription, 
               ^
  compiled code at target/run/amn_dbt/models/sales.sql.
[0m05:52:54.354935 [debug] [Thread-1 (]: Began running node model.amn_dbt.profit_and_margin
[0m05:52:54.357485 [info ] [Thread-1 (]: 3 of 4 SKIP relation public.profit_and_margin .................................. [[33mSKIP[0m]
[0m05:52:54.361577 [debug] [Thread-1 (]: Finished running node model.amn_dbt.profit_and_margin
[0m05:52:54.365169 [debug] [Thread-1 (]: Began running node model.amn_dbt.least_profitability
[0m05:52:54.367755 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.least_profitability ................................ [[33mSKIP[0m]
[0m05:52:54.370710 [debug] [Thread-1 (]: Finished running node model.amn_dbt.least_profitability
[0m05:52:54.375182 [debug] [MainThread]: Using postgres connection "master"
[0m05:52:54.377615 [debug] [MainThread]: On master: BEGIN
[0m05:52:54.379487 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:52:54.393527 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m05:52:54.396298 [debug] [MainThread]: On master: COMMIT
[0m05:52:54.398580 [debug] [MainThread]: Using postgres connection "master"
[0m05:52:54.401180 [debug] [MainThread]: On master: COMMIT
[0m05:52:54.406840 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m05:52:54.409311 [debug] [MainThread]: On master: Close
[0m05:52:54.411668 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:52:54.413952 [debug] [MainThread]: Connection 'model.amn_dbt.sales' was properly closed.
[0m05:52:54.416688 [info ] [MainThread]: 
[0m05:52:54.420941 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m05:52:54.425304 [debug] [MainThread]: Command end result
[0m05:52:54.497766 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m05:52:54.509263 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m05:52:54.537755 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m05:52:54.539633 [info ] [MainThread]: 
[0m05:52:54.542398 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m05:52:54.545567 [info ] [MainThread]: 
[0m05:52:54.549613 [error] [MainThread]:   Database Error in model sales (models/sales.sql)
  column "salesdescription" does not exist
  LINE 15:     salesdescription AS SalesDescription, 
               ^
  compiled code at target/run/amn_dbt/models/sales.sql
[0m05:52:54.553045 [info ] [MainThread]: 
[0m05:52:54.556201 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 TOTAL=4
[0m05:52:54.562594 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.4272032, "process_in_blocks": "39880", "process_kernel_time": 0.478884, "process_mem_max_rss": "107192", "process_out_blocks": "0", "process_user_time": 4.004292}
[0m05:52:54.565545 [debug] [MainThread]: Command `dbt run` failed at 05:52:54.564914 after 2.43 seconds
[0m05:52:54.568118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42387ce180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f423a13c9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f423a5a5d90>]}
[0m05:52:54.570997 [debug] [MainThread]: Flushing usage events
[0m05:52:55.341943 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:53:38.729833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac86eb0f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac875e8bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac8772cbc0>]}


============================== 05:53:38.736125 | 275f628a-9168-4509-9904-16ca86f4e4b2 ==============================
[0m05:53:38.736125 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:53:38.738733 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:53:39.017618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '275f628a-9168-4509-9904-16ca86f4e4b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac86ef2de0>]}
[0m05:53:39.108283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '275f628a-9168-4509-9904-16ca86f4e4b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac8552b7d0>]}
[0m05:53:39.110522 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:53:39.234583 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:53:39.418825 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:53:39.420739 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:53:39.465395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '275f628a-9168-4509-9904-16ca86f4e4b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac8536bb60>]}
[0m05:53:39.582667 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m05:53:39.593154 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m05:53:39.632417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '275f628a-9168-4509-9904-16ca86f4e4b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac852b0770>]}
[0m05:53:39.634799 [info ] [MainThread]: Found 4 models, 429 macros
[0m05:53:39.636960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '275f628a-9168-4509-9904-16ca86f4e4b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac8539e540>]}
[0m05:53:39.641957 [info ] [MainThread]: 
[0m05:53:39.644487 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:53:39.646794 [info ] [MainThread]: 
[0m05:53:39.649616 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:53:39.661281 [debug] [ThreadPool]: Acquiring new postgres connection 'list_amn_datawarehouse'
[0m05:53:39.740860 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse"
[0m05:53:39.743240 [debug] [ThreadPool]: On list_amn_datawarehouse: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse"} */

    select distinct nspname from pg_namespace
  
[0m05:53:39.744908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:53:39.760289 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.015 seconds
[0m05:53:39.764167 [debug] [ThreadPool]: On list_amn_datawarehouse: Close
[0m05:53:39.768036 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_amn_datawarehouse, now list_amn_datawarehouse_public)
[0m05:53:39.779937 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m05:53:39.781612 [debug] [ThreadPool]: On list_amn_datawarehouse_public: BEGIN
[0m05:53:39.783085 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:53:39.793851 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m05:53:39.795718 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m05:53:39.797484 [debug] [ThreadPool]: On list_amn_datawarehouse_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse_public"} */
select
      'amn_datawarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m05:53:39.803035 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m05:53:39.806447 [debug] [ThreadPool]: On list_amn_datawarehouse_public: ROLLBACK
[0m05:53:39.808549 [debug] [ThreadPool]: On list_amn_datawarehouse_public: Close
[0m05:53:39.817860 [debug] [MainThread]: Using postgres connection "master"
[0m05:53:39.820016 [debug] [MainThread]: On master: BEGIN
[0m05:53:39.821870 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:53:39.831842 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m05:53:39.833865 [debug] [MainThread]: Using postgres connection "master"
[0m05:53:39.836501 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:53:39.843259 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m05:53:39.846235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '275f628a-9168-4509-9904-16ca86f4e4b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac86e20950>]}
[0m05:53:39.847862 [debug] [MainThread]: On master: ROLLBACK
[0m05:53:39.849719 [debug] [MainThread]: Using postgres connection "master"
[0m05:53:39.851545 [debug] [MainThread]: On master: BEGIN
[0m05:53:39.853683 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:53:39.855560 [debug] [MainThread]: On master: COMMIT
[0m05:53:39.856902 [debug] [MainThread]: Using postgres connection "master"
[0m05:53:39.858444 [debug] [MainThread]: On master: COMMIT
[0m05:53:39.860547 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:53:39.862170 [debug] [MainThread]: On master: Close
[0m05:53:39.866466 [debug] [Thread-1 (]: Began running node model.amn_dbt.purchase_prices
[0m05:53:39.868599 [info ] [Thread-1 (]: 1 of 4 START sql table model public.purchase_prices ............................ [RUN]
[0m05:53:39.871150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_amn_datawarehouse_public, now model.amn_dbt.purchase_prices)
[0m05:53:39.873606 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.purchase_prices
[0m05:53:39.885871 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.purchase_prices"
[0m05:53:39.896780 [debug] [Thread-1 (]: Began executing node model.amn_dbt.purchase_prices
[0m05:53:39.964939 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.purchase_prices"
[0m05:53:39.976549 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:53:39.978135 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: BEGIN
[0m05:53:39.979389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:53:39.990578 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m05:53:39.992917 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:53:39.995031 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */

  
    

  create  table "amn_datawarehouse"."public"."purchase_prices__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    Brand,
    PurchasePrice
FROM public.purchase_prices
  );
  
[0m05:53:40.000653 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.003 seconds
[0m05:53:40.011379 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:53:40.013654 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
alter table "amn_datawarehouse"."public"."purchase_prices" rename to "purchase_prices__dbt_backup"
[0m05:53:40.015879 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m05:53:40.021665 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:53:40.023762 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
alter table "amn_datawarehouse"."public"."purchase_prices__dbt_tmp" rename to "purchase_prices"
[0m05:53:40.025934 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m05:53:40.058661 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: COMMIT
[0m05:53:40.060661 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:53:40.062600 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: COMMIT
[0m05:53:40.066240 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m05:53:40.077730 [debug] [Thread-1 (]: Applying DROP to: "amn_datawarehouse"."public"."purchase_prices__dbt_backup"
[0m05:53:40.087061 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:53:40.089094 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
drop table if exists "amn_datawarehouse"."public"."purchase_prices__dbt_backup" cascade
[0m05:53:40.093607 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m05:53:40.098453 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: Close
[0m05:53:40.102193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '275f628a-9168-4509-9904-16ca86f4e4b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac8794e060>]}
[0m05:53:40.104612 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.purchase_prices ....................... [[32mSELECT 0[0m in 0.23s]
[0m05:53:40.107270 [debug] [Thread-1 (]: Finished running node model.amn_dbt.purchase_prices
[0m05:53:40.109491 [debug] [Thread-1 (]: Began running node model.amn_dbt.sales
[0m05:53:40.111537 [info ] [Thread-1 (]: 2 of 4 START sql table model public.sales ...................................... [RUN]
[0m05:53:40.113638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.amn_dbt.purchase_prices, now model.amn_dbt.sales)
[0m05:53:40.115758 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.sales
[0m05:53:40.120031 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.sales"
[0m05:53:40.128988 [debug] [Thread-1 (]: Began executing node model.amn_dbt.sales
[0m05:53:40.134907 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.sales"
[0m05:53:40.146778 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:53:40.148373 [debug] [Thread-1 (]: On model.amn_dbt.sales: BEGIN
[0m05:53:40.149633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:53:40.164222 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m05:53:40.166540 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:53:40.168915 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */

  
    

  create  table "amn_datawarehouse"."public"."sales__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    inventoryid,
    store,
    salesdescription AS SalesDescription, 
    salesprice,
    brand
FROM public.sales
  );
  
[0m05:53:40.173509 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "salesdescription" does not exist
LINE 15:     salesdescription AS SalesDescription, 
             ^

[0m05:53:40.175967 [debug] [Thread-1 (]: On model.amn_dbt.sales: ROLLBACK
[0m05:53:40.178553 [debug] [Thread-1 (]: On model.amn_dbt.sales: Close
[0m05:53:40.186898 [debug] [Thread-1 (]: Database Error in model sales (models/sales.sql)
  column "salesdescription" does not exist
  LINE 15:     salesdescription AS SalesDescription, 
               ^
  compiled code at target/run/amn_dbt/models/sales.sql
[0m05:53:40.189484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '275f628a-9168-4509-9904-16ca86f4e4b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac845272f0>]}
[0m05:53:40.192134 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.sales ............................. [[31mERROR[0m in 0.08s]
[0m05:53:40.195477 [debug] [Thread-1 (]: Finished running node model.amn_dbt.sales
[0m05:53:40.197804 [debug] [Thread-4 (]: Marking all children of 'model.amn_dbt.sales' to be skipped because of status 'error'.  Reason: Database Error in model sales (models/sales.sql)
  column "salesdescription" does not exist
  LINE 15:     salesdescription AS SalesDescription, 
               ^
  compiled code at target/run/amn_dbt/models/sales.sql.
[0m05:53:40.201875 [debug] [Thread-1 (]: Began running node model.amn_dbt.profit_and_margin
[0m05:53:40.204289 [info ] [Thread-1 (]: 3 of 4 SKIP relation public.profit_and_margin .................................. [[33mSKIP[0m]
[0m05:53:40.206545 [debug] [Thread-1 (]: Finished running node model.amn_dbt.profit_and_margin
[0m05:53:40.209724 [debug] [Thread-1 (]: Began running node model.amn_dbt.least_profitability
[0m05:53:40.212064 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.least_profitability ................................ [[33mSKIP[0m]
[0m05:53:40.214977 [debug] [Thread-1 (]: Finished running node model.amn_dbt.least_profitability
[0m05:53:40.219336 [debug] [MainThread]: Using postgres connection "master"
[0m05:53:40.221495 [debug] [MainThread]: On master: BEGIN
[0m05:53:40.223051 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:53:40.235053 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m05:53:40.237295 [debug] [MainThread]: On master: COMMIT
[0m05:53:40.239493 [debug] [MainThread]: Using postgres connection "master"
[0m05:53:40.241118 [debug] [MainThread]: On master: COMMIT
[0m05:53:40.243502 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:53:40.245714 [debug] [MainThread]: On master: Close
[0m05:53:40.247833 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:53:40.249768 [debug] [MainThread]: Connection 'model.amn_dbt.sales' was properly closed.
[0m05:53:40.252056 [info ] [MainThread]: 
[0m05:53:40.255507 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m05:53:40.260715 [debug] [MainThread]: Command end result
[0m05:53:40.344467 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m05:53:40.353980 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m05:53:40.379483 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m05:53:40.381213 [info ] [MainThread]: 
[0m05:53:40.384303 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m05:53:40.386951 [info ] [MainThread]: 
[0m05:53:40.389886 [error] [MainThread]:   Database Error in model sales (models/sales.sql)
  column "salesdescription" does not exist
  LINE 15:     salesdescription AS SalesDescription, 
               ^
  compiled code at target/run/amn_dbt/models/sales.sql
[0m05:53:40.392728 [info ] [MainThread]: 
[0m05:53:40.395280 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 TOTAL=4
[0m05:53:40.398941 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.8077005, "process_in_blocks": "6880", "process_kernel_time": 0.419041, "process_mem_max_rss": "107968", "process_out_blocks": "0", "process_user_time": 2.923316}
[0m05:53:40.401543 [debug] [MainThread]: Command `dbt run` failed at 05:53:40.401057 after 1.81 seconds
[0m05:53:40.403559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac86eb0fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac86e23860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac875e8bf0>]}
[0m05:53:40.405926 [debug] [MainThread]: Flushing usage events
[0m05:53:41.103520 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:54:16.261623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c659e53d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c6577bec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c6734a420>]}


============================== 05:54:16.267170 | c1b51b4a-9887-420b-ba4f-731e67cc186a ==============================
[0m05:54:16.267170 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:54:16.269797 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:54:16.554336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1b51b4a-9887-420b-ba4f-731e67cc186a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c654aeba0>]}
[0m05:54:16.647471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1b51b4a-9887-420b-ba4f-731e67cc186a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c6548ce30>]}
[0m05:54:16.649761 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:54:16.797748 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:54:17.044704 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:54:17.046556 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:54:17.101010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1b51b4a-9887-420b-ba4f-731e67cc186a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c63c2d2b0>]}
[0m05:54:17.239855 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m05:54:17.257488 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m05:54:17.305837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1b51b4a-9887-420b-ba4f-731e67cc186a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c638f4320>]}
[0m05:54:17.308331 [info ] [MainThread]: Found 4 models, 429 macros
[0m05:54:17.310948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1b51b4a-9887-420b-ba4f-731e67cc186a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c638e9fa0>]}
[0m05:54:17.317554 [info ] [MainThread]: 
[0m05:54:17.320261 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:54:17.322777 [info ] [MainThread]: 
[0m05:54:17.325991 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:54:17.338617 [debug] [ThreadPool]: Acquiring new postgres connection 'list_amn_datawarehouse'
[0m05:54:17.404898 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse"
[0m05:54:17.406906 [debug] [ThreadPool]: On list_amn_datawarehouse: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse"} */

    select distinct nspname from pg_namespace
  
[0m05:54:17.408300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:54:17.420475 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.012 seconds
[0m05:54:17.423259 [debug] [ThreadPool]: On list_amn_datawarehouse: Close
[0m05:54:17.426414 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_amn_datawarehouse, now list_amn_datawarehouse_public)
[0m05:54:17.437096 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m05:54:17.438752 [debug] [ThreadPool]: On list_amn_datawarehouse_public: BEGIN
[0m05:54:17.440176 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:54:17.453278 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m05:54:17.455800 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m05:54:17.458276 [debug] [ThreadPool]: On list_amn_datawarehouse_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse_public"} */
select
      'amn_datawarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m05:54:17.466528 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m05:54:17.470709 [debug] [ThreadPool]: On list_amn_datawarehouse_public: ROLLBACK
[0m05:54:17.473308 [debug] [ThreadPool]: On list_amn_datawarehouse_public: Close
[0m05:54:17.487259 [debug] [MainThread]: Using postgres connection "master"
[0m05:54:17.489771 [debug] [MainThread]: On master: BEGIN
[0m05:54:17.491704 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:54:17.502592 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m05:54:17.504808 [debug] [MainThread]: Using postgres connection "master"
[0m05:54:17.507356 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:54:17.514056 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m05:54:17.517519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1b51b4a-9887-420b-ba4f-731e67cc186a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c68c528a0>]}
[0m05:54:17.519626 [debug] [MainThread]: On master: ROLLBACK
[0m05:54:17.521785 [debug] [MainThread]: Using postgres connection "master"
[0m05:54:17.523574 [debug] [MainThread]: On master: BEGIN
[0m05:54:17.525621 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m05:54:17.527564 [debug] [MainThread]: On master: COMMIT
[0m05:54:17.529625 [debug] [MainThread]: Using postgres connection "master"
[0m05:54:17.531878 [debug] [MainThread]: On master: COMMIT
[0m05:54:17.534529 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:54:17.536422 [debug] [MainThread]: On master: Close
[0m05:54:17.540980 [debug] [Thread-1 (]: Began running node model.amn_dbt.purchase_prices
[0m05:54:17.543807 [info ] [Thread-1 (]: 1 of 4 START sql table model public.purchase_prices ............................ [RUN]
[0m05:54:17.546664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_amn_datawarehouse_public, now model.amn_dbt.purchase_prices)
[0m05:54:17.548787 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.purchase_prices
[0m05:54:17.562637 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.purchase_prices"
[0m05:54:17.574324 [debug] [Thread-1 (]: Began executing node model.amn_dbt.purchase_prices
[0m05:54:17.659416 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.purchase_prices"
[0m05:54:17.669112 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:54:17.670595 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: BEGIN
[0m05:54:17.671805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:54:17.681358 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m05:54:17.683731 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:54:17.685886 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */

  
    

  create  table "amn_datawarehouse"."public"."purchase_prices__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    Brand,
    PurchasePrice
FROM public.purchase_prices
  );
  
[0m05:54:17.691170 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.003 seconds
[0m05:54:17.701299 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:54:17.703076 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
alter table "amn_datawarehouse"."public"."purchase_prices" rename to "purchase_prices__dbt_backup"
[0m05:54:17.705351 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m05:54:17.710905 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:54:17.712412 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
alter table "amn_datawarehouse"."public"."purchase_prices__dbt_tmp" rename to "purchase_prices"
[0m05:54:17.714336 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m05:54:17.749344 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: COMMIT
[0m05:54:17.751287 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:54:17.752840 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: COMMIT
[0m05:54:17.760907 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m05:54:17.772199 [debug] [Thread-1 (]: Applying DROP to: "amn_datawarehouse"."public"."purchase_prices__dbt_backup"
[0m05:54:17.780836 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m05:54:17.782608 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
drop table if exists "amn_datawarehouse"."public"."purchase_prices__dbt_backup" cascade
[0m05:54:17.787424 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m05:54:17.792230 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: Close
[0m05:54:17.795679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1b51b4a-9887-420b-ba4f-731e67cc186a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c671fe4b0>]}
[0m05:54:17.797828 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.purchase_prices ....................... [[32mSELECT 0[0m in 0.25s]
[0m05:54:17.800488 [debug] [Thread-1 (]: Finished running node model.amn_dbt.purchase_prices
[0m05:54:17.802361 [debug] [Thread-1 (]: Began running node model.amn_dbt.sales
[0m05:54:17.804351 [info ] [Thread-1 (]: 2 of 4 START sql table model public.sales ...................................... [RUN]
[0m05:54:17.806932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.amn_dbt.purchase_prices, now model.amn_dbt.sales)
[0m05:54:17.808974 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.sales
[0m05:54:17.814425 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.sales"
[0m05:54:17.822307 [debug] [Thread-1 (]: Began executing node model.amn_dbt.sales
[0m05:54:17.828201 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.sales"
[0m05:54:17.840098 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:54:17.842004 [debug] [Thread-1 (]: On model.amn_dbt.sales: BEGIN
[0m05:54:17.843659 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:54:17.853591 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m05:54:17.855698 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:54:17.857820 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */

  
    

  create  table "amn_datawarehouse"."public"."sales__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    inventoryid,
    store,
    salesdescription AS SalesDescription, 
    salesprice,
    brand
FROM public.sales
  );
  
[0m05:54:17.863242 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.003 seconds
[0m05:54:17.871467 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:54:17.873087 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */
alter table "amn_datawarehouse"."public"."sales" rename to "sales__dbt_backup"
[0m05:54:17.875411 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m05:54:17.880467 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:54:17.882630 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */
alter table "amn_datawarehouse"."public"."sales__dbt_tmp" rename to "sales"
[0m05:54:17.885168 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:54:17.889221 [debug] [Thread-1 (]: On model.amn_dbt.sales: COMMIT
[0m05:54:17.890726 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:54:17.892256 [debug] [Thread-1 (]: On model.amn_dbt.sales: COMMIT
[0m05:54:17.895675 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m05:54:17.900803 [debug] [Thread-1 (]: Applying DROP to: "amn_datawarehouse"."public"."sales__dbt_backup"
[0m05:54:17.903050 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m05:54:17.904992 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */
drop table if exists "amn_datawarehouse"."public"."sales__dbt_backup" cascade
[0m05:54:17.910299 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m05:54:17.913489 [debug] [Thread-1 (]: On model.amn_dbt.sales: Close
[0m05:54:17.915476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1b51b4a-9887-420b-ba4f-731e67cc186a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c62c86f00>]}
[0m05:54:17.917839 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.sales ................................. [[32mSELECT 0[0m in 0.11s]
[0m05:54:17.920159 [debug] [Thread-1 (]: Finished running node model.amn_dbt.sales
[0m05:54:17.923217 [debug] [Thread-1 (]: Began running node model.amn_dbt.profit_and_margin
[0m05:54:17.925140 [info ] [Thread-1 (]: 3 of 4 START sql table model public.profit_and_margin .......................... [RUN]
[0m05:54:17.927482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.amn_dbt.sales, now model.amn_dbt.profit_and_margin)
[0m05:54:17.929065 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.profit_and_margin
[0m05:54:17.936067 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.profit_and_margin"
[0m05:54:17.943938 [debug] [Thread-1 (]: Began executing node model.amn_dbt.profit_and_margin
[0m05:54:17.949910 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.profit_and_margin"
[0m05:54:17.961461 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m05:54:17.963789 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: BEGIN
[0m05:54:17.965441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:54:17.978382 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m05:54:17.980499 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m05:54:17.983497 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.profit_and_margin"} */

  
    

  create  table "amn_datawarehouse"."public"."profit_and_margin__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    s.InventoryId,
    s.Store,
    s.SalesDescription, 
    s.SalesPrice,
    COALESCE(p.PurchasePrice, 0) AS PurchasePrice,
    (s.SalesPrice - COALESCE(p.PurchasePrice, 0)) AS Profit,
    (s.SalesPrice - COALESCE(p.PurchasePrice, 0)) / NULLIF(s.SalesPrice, 0) * 100 AS ProfitMargin
FROM 
    "amn_datawarehouse"."public"."sales" AS s 
LEFT JOIN 
    "amn_datawarehouse"."public"."purchase_prices" AS p
    ON s.Brand = p.Brand
  );
  
[0m05:54:17.991523 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m05:54:17.997369 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m05:54:17.999431 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.profit_and_margin"} */
alter table "amn_datawarehouse"."public"."profit_and_margin__dbt_tmp" rename to "profit_and_margin"
[0m05:54:18.002006 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m05:54:18.005363 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: COMMIT
[0m05:54:18.007197 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m05:54:18.008999 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: COMMIT
[0m05:54:18.013194 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m05:54:18.017977 [debug] [Thread-1 (]: Applying DROP to: "amn_datawarehouse"."public"."profit_and_margin__dbt_backup"
[0m05:54:18.020076 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m05:54:18.021738 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.profit_and_margin"} */
drop table if exists "amn_datawarehouse"."public"."profit_and_margin__dbt_backup" cascade
[0m05:54:18.023751 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m05:54:18.026840 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: Close
[0m05:54:18.028799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1b51b4a-9887-420b-ba4f-731e67cc186a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c611a48c0>]}
[0m05:54:18.030770 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.profit_and_margin ..................... [[32mSELECT 0[0m in 0.10s]
[0m05:54:18.033583 [debug] [Thread-1 (]: Finished running node model.amn_dbt.profit_and_margin
[0m05:54:18.036449 [debug] [Thread-1 (]: Began running node model.amn_dbt.least_profitability
[0m05:54:18.038886 [info ] [Thread-1 (]: 4 of 4 START sql table model public.least_profitability ........................ [RUN]
[0m05:54:18.041804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.amn_dbt.profit_and_margin, now model.amn_dbt.least_profitability)
[0m05:54:18.043809 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.least_profitability
[0m05:54:18.049761 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.least_profitability"
[0m05:54:18.058773 [debug] [Thread-1 (]: Began executing node model.amn_dbt.least_profitability
[0m05:54:18.067266 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.least_profitability"
[0m05:54:18.077948 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.least_profitability"
[0m05:54:18.081547 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: BEGIN
[0m05:54:18.084260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:54:18.097241 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m05:54:18.100079 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.least_profitability"
[0m05:54:18.102752 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.least_profitability"} */

  
    

  create  table "amn_datawarehouse"."public"."least_profitability__dbt_tmp"
  
  
    as
  
  (
    WITH profit_data AS (
    SELECT 
        InventoryId,
        Store,
        SalesDescription,
        SalesPrice,
        PurchasePrice,
        Profit,
        ProfitMargin
    FROM "amn_datawarehouse"."public"."profit_and_margin"
)
SELECT 
    InventoryId,
    Store,
    SalesDescription,
    SalesPrice,
    PurchasePrice,
    Profit,
    ProfitMargin
FROM 
    profit_data
ORDER BY 
    Profit ASC
LIMIT 10
  );
  
[0m05:54:18.109113 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m05:54:18.115690 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.least_profitability"
[0m05:54:18.117859 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.least_profitability"} */
alter table "amn_datawarehouse"."public"."least_profitability__dbt_tmp" rename to "least_profitability"
[0m05:54:18.120069 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:54:18.123408 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: COMMIT
[0m05:54:18.125120 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.least_profitability"
[0m05:54:18.126844 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: COMMIT
[0m05:54:18.131030 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m05:54:18.136223 [debug] [Thread-1 (]: Applying DROP to: "amn_datawarehouse"."public"."least_profitability__dbt_backup"
[0m05:54:18.138277 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.least_profitability"
[0m05:54:18.139954 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.least_profitability"} */
drop table if exists "amn_datawarehouse"."public"."least_profitability__dbt_backup" cascade
[0m05:54:18.142286 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m05:54:18.145493 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: Close
[0m05:54:18.147822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1b51b4a-9887-420b-ba4f-731e67cc186a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c611b9790>]}
[0m05:54:18.150729 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.least_profitability ................... [[32mSELECT 0[0m in 0.11s]
[0m05:54:18.154026 [debug] [Thread-1 (]: Finished running node model.amn_dbt.least_profitability
[0m05:54:18.159057 [debug] [MainThread]: Using postgres connection "master"
[0m05:54:18.161066 [debug] [MainThread]: On master: BEGIN
[0m05:54:18.162438 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:54:18.172096 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m05:54:18.174393 [debug] [MainThread]: On master: COMMIT
[0m05:54:18.176562 [debug] [MainThread]: Using postgres connection "master"
[0m05:54:18.179320 [debug] [MainThread]: On master: COMMIT
[0m05:54:18.182347 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:54:18.184827 [debug] [MainThread]: On master: Close
[0m05:54:18.186970 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:54:18.188528 [debug] [MainThread]: Connection 'model.amn_dbt.least_profitability' was properly closed.
[0m05:54:18.190223 [info ] [MainThread]: 
[0m05:54:18.192685 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m05:54:18.197629 [debug] [MainThread]: Command end result
[0m05:54:18.258836 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m05:54:18.266988 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m05:54:18.281286 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m05:54:18.283246 [info ] [MainThread]: 
[0m05:54:18.285499 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:54:18.287849 [info ] [MainThread]: 
[0m05:54:18.290674 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m05:54:18.296433 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.172214, "process_in_blocks": "488", "process_kernel_time": 0.306498, "process_mem_max_rss": "106640", "process_out_blocks": "0", "process_user_time": 3.322048}
[0m05:54:18.299544 [debug] [MainThread]: Command `dbt run` succeeded at 05:54:18.299085 after 2.18 seconds
[0m05:54:18.302562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c659e53d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c6747c4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c62b9b980>]}
[0m05:54:18.304460 [debug] [MainThread]: Flushing usage events
[0m05:54:19.053881 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:00:10.920502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6750c2a5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6750d90830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f674f8427e0>]}


============================== 06:00:11.040555 | d843571c-ce1f-4a93-8883-3877d4ab6d37 ==============================
[0m06:00:11.040555 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:00:11.054507 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:00:15.132454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd843571c-ce1f-4a93-8883-3877d4ab6d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f674edaeb10>]}
[0m06:00:15.760444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd843571c-ce1f-4a93-8883-3877d4ab6d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f674edde3c0>]}
[0m06:00:15.787251 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:00:16.571310 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:00:19.359324 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:00:19.370019 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:00:19.630386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd843571c-ce1f-4a93-8883-3877d4ab6d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f674d297f80>]}
[0m06:00:20.458535 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m06:00:20.554617 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m06:00:20.819361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd843571c-ce1f-4a93-8883-3877d4ab6d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f674d1f8980>]}
[0m06:00:20.825124 [info ] [MainThread]: Found 4 models, 429 macros
[0m06:00:20.853110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd843571c-ce1f-4a93-8883-3877d4ab6d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f674edaf2f0>]}
[0m06:00:20.882373 [info ] [MainThread]: 
[0m06:00:20.894727 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:00:20.906664 [info ] [MainThread]: 
[0m06:00:20.913046 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:00:20.954660 [debug] [ThreadPool]: Acquiring new postgres connection 'list_amn_datawarehouse'
[0m06:00:21.515137 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse"
[0m06:00:21.544064 [debug] [ThreadPool]: On list_amn_datawarehouse: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse"} */

    select distinct nspname from pg_namespace
  
[0m06:00:21.634731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:00:21.970713 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.336 seconds
[0m06:00:21.993846 [debug] [ThreadPool]: On list_amn_datawarehouse: Close
[0m06:00:22.046604 [debug] [ThreadPool]: Acquiring new postgres connection 'list_amn_datawarehouse_public'
[0m06:00:22.146354 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m06:00:22.167534 [debug] [ThreadPool]: On list_amn_datawarehouse_public: BEGIN
[0m06:00:22.176763 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:00:22.224080 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m06:00:22.252642 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m06:00:22.277896 [debug] [ThreadPool]: On list_amn_datawarehouse_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse_public"} */
select
      'amn_datawarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m06:00:22.368443 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.061 seconds
[0m06:00:22.411915 [debug] [ThreadPool]: On list_amn_datawarehouse_public: ROLLBACK
[0m06:00:22.443475 [debug] [ThreadPool]: On list_amn_datawarehouse_public: Close
[0m06:00:22.507171 [debug] [MainThread]: Using postgres connection "master"
[0m06:00:22.531477 [debug] [MainThread]: On master: BEGIN
[0m06:00:22.563224 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:00:22.660206 [debug] [MainThread]: SQL status: BEGIN in 0.097 seconds
[0m06:00:22.702470 [debug] [MainThread]: Using postgres connection "master"
[0m06:00:22.740357 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:00:22.812625 [debug] [MainThread]: SQL status: SELECT 0 in 0.053 seconds
[0m06:00:22.875978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd843571c-ce1f-4a93-8883-3877d4ab6d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f674d257f80>]}
[0m06:00:22.891031 [debug] [MainThread]: On master: ROLLBACK
[0m06:00:22.903872 [debug] [MainThread]: Using postgres connection "master"
[0m06:00:22.918196 [debug] [MainThread]: On master: BEGIN
[0m06:00:22.931645 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m06:00:22.935713 [debug] [MainThread]: On master: COMMIT
[0m06:00:22.955975 [debug] [MainThread]: Using postgres connection "master"
[0m06:00:22.972527 [debug] [MainThread]: On master: COMMIT
[0m06:00:23.003601 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m06:00:23.029947 [debug] [MainThread]: On master: Close
[0m06:00:23.063234 [debug] [Thread-1 (]: Began running node model.amn_dbt.purchase_prices
[0m06:00:23.073516 [info ] [Thread-1 (]: 1 of 4 START sql table model public.purchase_prices ............................ [RUN]
[0m06:00:23.082392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_amn_datawarehouse_public, now model.amn_dbt.purchase_prices)
[0m06:00:23.116774 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.purchase_prices
[0m06:00:23.213963 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.purchase_prices"
[0m06:00:23.437044 [debug] [Thread-1 (]: Began executing node model.amn_dbt.purchase_prices
[0m06:00:23.825341 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.purchase_prices"
[0m06:00:23.917007 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m06:00:23.935975 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: BEGIN
[0m06:00:23.944756 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:23.990493 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m06:00:24.042365 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m06:00:24.061851 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */

  
    

  create  table "amn_datawarehouse"."public"."purchase_prices__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    Brand,
    PurchasePrice
FROM public.purchase_prices
  );
  
[0m06:00:24.147394 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.044 seconds
[0m06:00:24.191761 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m06:00:24.207550 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
alter table "amn_datawarehouse"."public"."purchase_prices" rename to "purchase_prices__dbt_backup"
[0m06:00:24.229810 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:00:24.255533 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m06:00:24.269053 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
alter table "amn_datawarehouse"."public"."purchase_prices__dbt_tmp" rename to "purchase_prices"
[0m06:00:24.275928 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:00:24.447550 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: COMMIT
[0m06:00:24.451277 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m06:00:24.458265 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: COMMIT
[0m06:00:24.474665 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m06:00:24.521206 [debug] [Thread-1 (]: Applying DROP to: "amn_datawarehouse"."public"."purchase_prices__dbt_backup"
[0m06:00:24.575466 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m06:00:24.584105 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
drop table if exists "amn_datawarehouse"."public"."purchase_prices__dbt_backup" cascade
[0m06:00:24.626618 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.035 seconds
[0m06:00:24.655800 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: Close
[0m06:00:24.680458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd843571c-ce1f-4a93-8883-3877d4ab6d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6750b0a540>]}
[0m06:00:24.692273 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.purchase_prices ....................... [[32mSELECT 0[0m in 1.59s]
[0m06:00:24.706729 [debug] [Thread-1 (]: Finished running node model.amn_dbt.purchase_prices
[0m06:00:24.717420 [debug] [Thread-1 (]: Began running node model.amn_dbt.sales
[0m06:00:24.725162 [info ] [Thread-1 (]: 2 of 4 START sql table model public.sales ...................................... [RUN]
[0m06:00:24.740195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.amn_dbt.purchase_prices, now model.amn_dbt.sales)
[0m06:00:24.758876 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.sales
[0m06:00:24.778927 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.sales"
[0m06:00:24.900610 [debug] [Thread-1 (]: Began executing node model.amn_dbt.sales
[0m06:00:24.986657 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.sales"
[0m06:00:25.078923 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m06:00:25.092276 [debug] [Thread-1 (]: On model.amn_dbt.sales: BEGIN
[0m06:00:25.109281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:25.165922 [debug] [Thread-1 (]: SQL status: BEGIN in 0.056 seconds
[0m06:00:25.191539 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m06:00:25.202050 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */

  
    

  create  table "amn_datawarehouse"."public"."sales__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    inventoryid,
    store,
    salesdescription AS SalesDescription, 
    salesprice,
    brand
FROM public.sales
  );
  
[0m06:00:25.242613 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.017 seconds
[0m06:00:25.273825 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m06:00:25.292490 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */
alter table "amn_datawarehouse"."public"."sales" rename to "sales__dbt_backup"
[0m06:00:25.310254 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:00:25.358209 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m06:00:25.379247 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */
alter table "amn_datawarehouse"."public"."sales__dbt_tmp" rename to "sales"
[0m06:00:25.385235 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:00:25.402466 [debug] [Thread-1 (]: On model.amn_dbt.sales: COMMIT
[0m06:00:25.420883 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m06:00:25.429460 [debug] [Thread-1 (]: On model.amn_dbt.sales: COMMIT
[0m06:00:25.438982 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m06:00:25.463612 [debug] [Thread-1 (]: Applying DROP to: "amn_datawarehouse"."public"."sales__dbt_backup"
[0m06:00:25.486641 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m06:00:25.501049 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */
drop table if exists "amn_datawarehouse"."public"."sales__dbt_backup" cascade
[0m06:00:25.515638 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m06:00:25.534973 [debug] [Thread-1 (]: On model.amn_dbt.sales: Close
[0m06:00:25.552623 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd843571c-ce1f-4a93-8883-3877d4ab6d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f674c599340>]}
[0m06:00:25.567872 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.sales ................................. [[32mSELECT 0[0m in 0.81s]
[0m06:00:25.574332 [debug] [Thread-1 (]: Finished running node model.amn_dbt.sales
[0m06:00:25.583376 [debug] [Thread-1 (]: Began running node model.amn_dbt.profit_and_margin
[0m06:00:25.589469 [info ] [Thread-1 (]: 3 of 4 START sql table model public.profit_and_margin .......................... [RUN]
[0m06:00:25.619367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.amn_dbt.sales, now model.amn_dbt.profit_and_margin)
[0m06:00:25.628841 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.profit_and_margin
[0m06:00:25.670996 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.profit_and_margin"
[0m06:00:25.827893 [debug] [Thread-1 (]: Began executing node model.amn_dbt.profit_and_margin
[0m06:00:25.861130 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.profit_and_margin"
[0m06:00:25.973023 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m06:00:25.977892 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: BEGIN
[0m06:00:25.991299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:26.036132 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m06:00:26.061346 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m06:00:26.076043 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.profit_and_margin"} */

  
    

  create  table "amn_datawarehouse"."public"."profit_and_margin__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    s.InventoryId,
    s.Store,
    s.SalesDescription, 
    s.SalesPrice,
    COALESCE(p.PurchasePrice, 0) AS PurchasePrice,
    (s.SalesPrice - COALESCE(p.PurchasePrice, 0)) AS Profit,
    (s.SalesPrice - COALESCE(p.PurchasePrice, 0)) / NULLIF(s.SalesPrice, 0) * 100 AS ProfitMargin
FROM 
    "amn_datawarehouse"."public"."sales" AS s 
LEFT JOIN 
    "amn_datawarehouse"."public"."purchase_prices" AS p
    ON s.Brand = p.Brand
  );
  
[0m06:00:26.104121 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.019 seconds
[0m06:00:26.142383 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m06:00:26.158805 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.profit_and_margin"} */
alter table "amn_datawarehouse"."public"."profit_and_margin" rename to "profit_and_margin__dbt_backup"
[0m06:00:26.183757 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:00:26.235035 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m06:00:26.243658 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.profit_and_margin"} */
alter table "amn_datawarehouse"."public"."profit_and_margin__dbt_tmp" rename to "profit_and_margin"
[0m06:00:26.262703 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:00:26.306637 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: COMMIT
[0m06:00:26.312061 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m06:00:26.319426 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: COMMIT
[0m06:00:26.344899 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m06:00:26.389206 [debug] [Thread-1 (]: Applying DROP to: "amn_datawarehouse"."public"."profit_and_margin__dbt_backup"
[0m06:00:26.423082 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m06:00:26.444630 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.profit_and_margin"} */
drop table if exists "amn_datawarehouse"."public"."profit_and_margin__dbt_backup" cascade
[0m06:00:26.463867 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m06:00:26.495599 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: Close
[0m06:00:26.536984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd843571c-ce1f-4a93-8883-3877d4ab6d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f674c4a02f0>]}
[0m06:00:26.559044 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.profit_and_margin ..................... [[32mSELECT 0[0m in 0.92s]
[0m06:00:26.596955 [debug] [Thread-1 (]: Finished running node model.amn_dbt.profit_and_margin
[0m06:00:26.606300 [debug] [Thread-1 (]: Began running node model.amn_dbt.least_profitability
[0m06:00:26.623632 [info ] [Thread-1 (]: 4 of 4 START sql table model public.least_profitability ........................ [RUN]
[0m06:00:26.634538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.amn_dbt.profit_and_margin, now model.amn_dbt.least_profitability)
[0m06:00:26.651184 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.least_profitability
[0m06:00:26.690329 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.least_profitability"
[0m06:00:26.776205 [debug] [Thread-1 (]: Began executing node model.amn_dbt.least_profitability
[0m06:00:26.811320 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.least_profitability"
[0m06:00:27.113287 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.least_profitability"
[0m06:00:27.138369 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: BEGIN
[0m06:00:27.158029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:27.214634 [debug] [Thread-1 (]: SQL status: BEGIN in 0.060 seconds
[0m06:00:27.243756 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.least_profitability"
[0m06:00:27.262073 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.least_profitability"} */

  
    

  create  table "amn_datawarehouse"."public"."least_profitability__dbt_tmp"
  
  
    as
  
  (
    WITH profit_data AS (
    SELECT 
        InventoryId,
        Store,
        SalesDescription,
        SalesPrice,
        PurchasePrice,
        Profit,
        ProfitMargin
    FROM "amn_datawarehouse"."public"."profit_and_margin"
)
SELECT 
    InventoryId,
    Store,
    SalesDescription,
    SalesPrice,
    PurchasePrice,
    Profit,
    ProfitMargin
FROM 
    profit_data
ORDER BY 
    Profit ASC
LIMIT 10
  );
  
[0m06:00:27.315059 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.019 seconds
[0m06:00:27.381760 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.least_profitability"
[0m06:00:27.388958 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.least_profitability"} */
alter table "amn_datawarehouse"."public"."least_profitability" rename to "least_profitability__dbt_backup"
[0m06:00:27.406308 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:00:27.448860 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.least_profitability"
[0m06:00:27.489886 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.least_profitability"} */
alter table "amn_datawarehouse"."public"."least_profitability__dbt_tmp" rename to "least_profitability"
[0m06:00:27.508058 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:00:27.677001 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: COMMIT
[0m06:00:27.724171 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.least_profitability"
[0m06:00:27.741418 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: COMMIT
[0m06:00:27.794652 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m06:00:27.878953 [debug] [Thread-1 (]: Applying DROP to: "amn_datawarehouse"."public"."least_profitability__dbt_backup"
[0m06:00:27.906706 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.least_profitability"
[0m06:00:27.913716 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.least_profitability"} */
drop table if exists "amn_datawarehouse"."public"."least_profitability__dbt_backup" cascade
[0m06:00:27.959942 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.032 seconds
[0m06:00:27.989601 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: Close
[0m06:00:28.074976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd843571c-ce1f-4a93-8883-3877d4ab6d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f674c586a50>]}
[0m06:00:28.103522 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.least_profitability ................... [[32mSELECT 0[0m in 1.44s]
[0m06:00:28.138543 [debug] [Thread-1 (]: Finished running node model.amn_dbt.least_profitability
[0m06:00:28.169779 [debug] [MainThread]: Using postgres connection "master"
[0m06:00:28.190863 [debug] [MainThread]: On master: BEGIN
[0m06:00:28.222381 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:00:28.288558 [debug] [MainThread]: SQL status: BEGIN in 0.086 seconds
[0m06:00:28.311943 [debug] [MainThread]: On master: COMMIT
[0m06:00:28.315760 [debug] [MainThread]: Using postgres connection "master"
[0m06:00:28.319291 [debug] [MainThread]: On master: COMMIT
[0m06:00:28.330997 [debug] [MainThread]: SQL status: COMMIT in 0.008 seconds
[0m06:00:28.334932 [debug] [MainThread]: On master: Close
[0m06:00:28.340713 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:00:28.354090 [debug] [MainThread]: Connection 'list_amn_datawarehouse' was properly closed.
[0m06:00:28.358773 [debug] [MainThread]: Connection 'model.amn_dbt.least_profitability' was properly closed.
[0m06:00:28.362530 [info ] [MainThread]: 
[0m06:00:28.369834 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 7.45 seconds (7.45s).
[0m06:00:28.395846 [debug] [MainThread]: Command end result
[0m06:00:29.060485 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m06:00:29.155506 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m06:00:29.248644 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m06:00:29.253779 [info ] [MainThread]: 
[0m06:00:29.264965 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:00:29.272417 [info ] [MainThread]: 
[0m06:00:29.300734 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m06:00:29.321001 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.84871, "process_in_blocks": "15168", "process_kernel_time": 5.249054, "process_mem_max_rss": "106860", "process_out_blocks": "0", "process_user_time": 18.240967}
[0m06:00:29.325838 [debug] [MainThread]: Command `dbt run` succeeded at 06:00:29.325286 after 20.85 seconds
[0m06:00:29.338114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f674f01ecf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f674f532270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f674c2ced80>]}
[0m06:00:29.345178 [debug] [MainThread]: Flushing usage events
[0m06:00:32.040997 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:08:26.253740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fced620eb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fced8164cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fced62d1010>]}


============================== 06:08:26.270617 | ad4ef032-32f8-4858-a418-c28a2f6414c7 ==============================
[0m06:08:26.270617 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:08:26.277270 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:08:27.396158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad4ef032-32f8-4858-a418-c28a2f6414c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fced62d21b0>]}
[0m06:08:27.770664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad4ef032-32f8-4858-a418-c28a2f6414c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fced679e5a0>]}
[0m06:08:27.786935 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:08:28.217242 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:08:29.060573 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:08:29.063079 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:08:29.286942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad4ef032-32f8-4858-a418-c28a2f6414c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fced4517b00>]}
[0m06:08:29.695690 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m06:08:29.718732 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m06:08:29.899733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad4ef032-32f8-4858-a418-c28a2f6414c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fced41e4770>]}
[0m06:08:29.903869 [info ] [MainThread]: Found 4 models, 429 macros
[0m06:08:29.910229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad4ef032-32f8-4858-a418-c28a2f6414c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fced42efe00>]}
[0m06:08:29.927745 [info ] [MainThread]: 
[0m06:08:29.931760 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:08:29.941120 [info ] [MainThread]: 
[0m06:08:29.947210 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:08:29.988270 [debug] [ThreadPool]: Acquiring new postgres connection 'list_amn_datawarehouse'
[0m06:08:30.276371 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse"
[0m06:08:30.284139 [debug] [ThreadPool]: On list_amn_datawarehouse: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse"} */

    select distinct nspname from pg_namespace
  
[0m06:08:30.304656 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:08:30.446178 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.142 seconds
[0m06:08:30.453654 [debug] [ThreadPool]: On list_amn_datawarehouse: Close
[0m06:08:30.468430 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_amn_datawarehouse, now list_amn_datawarehouse_public)
[0m06:08:30.514165 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m06:08:30.517713 [debug] [ThreadPool]: On list_amn_datawarehouse_public: BEGIN
[0m06:08:30.520937 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:08:30.551004 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m06:08:30.554890 [debug] [ThreadPool]: Using postgres connection "list_amn_datawarehouse_public"
[0m06:08:30.560386 [debug] [ThreadPool]: On list_amn_datawarehouse_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "list_amn_datawarehouse_public"} */
select
      'amn_datawarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'amn_datawarehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m06:08:30.587907 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.022 seconds
[0m06:08:30.594494 [debug] [ThreadPool]: On list_amn_datawarehouse_public: ROLLBACK
[0m06:08:30.598102 [debug] [ThreadPool]: On list_amn_datawarehouse_public: Close
[0m06:08:30.622504 [debug] [MainThread]: Using postgres connection "master"
[0m06:08:30.625524 [debug] [MainThread]: On master: BEGIN
[0m06:08:30.628622 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:08:30.649186 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m06:08:30.652044 [debug] [MainThread]: Using postgres connection "master"
[0m06:08:30.655838 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:08:30.673423 [debug] [MainThread]: SQL status: SELECT 0 in 0.014 seconds
[0m06:08:30.679750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad4ef032-32f8-4858-a418-c28a2f6414c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fced4243dd0>]}
[0m06:08:30.682117 [debug] [MainThread]: On master: ROLLBACK
[0m06:08:30.684720 [debug] [MainThread]: Using postgres connection "master"
[0m06:08:30.687036 [debug] [MainThread]: On master: BEGIN
[0m06:08:30.693771 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:08:30.697362 [debug] [MainThread]: On master: COMMIT
[0m06:08:30.701186 [debug] [MainThread]: Using postgres connection "master"
[0m06:08:30.704745 [debug] [MainThread]: On master: COMMIT
[0m06:08:30.709588 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m06:08:30.713188 [debug] [MainThread]: On master: Close
[0m06:08:30.720731 [debug] [Thread-1 (]: Began running node model.amn_dbt.purchase_prices
[0m06:08:30.724110 [info ] [Thread-1 (]: 1 of 4 START sql table model public.purchase_prices ............................ [RUN]
[0m06:08:30.728003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_amn_datawarehouse_public, now model.amn_dbt.purchase_prices)
[0m06:08:30.731429 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.purchase_prices
[0m06:08:30.766902 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.purchase_prices"
[0m06:08:30.784102 [debug] [Thread-1 (]: Began executing node model.amn_dbt.purchase_prices
[0m06:08:30.948843 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.purchase_prices"
[0m06:08:30.966443 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m06:08:30.969678 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: BEGIN
[0m06:08:30.972094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:08:30.999361 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m06:08:31.023330 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m06:08:31.026538 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */

  
    

  create  table "amn_datawarehouse"."public"."purchase_prices__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    Brand,
    PurchasePrice
FROM public.purchase_prices
  );
  
[0m06:08:31.041686 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.012 seconds
[0m06:08:31.060166 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m06:08:31.062874 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
alter table "amn_datawarehouse"."public"."purchase_prices" rename to "purchase_prices__dbt_backup"
[0m06:08:31.065970 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:08:31.078883 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m06:08:31.082315 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
alter table "amn_datawarehouse"."public"."purchase_prices__dbt_tmp" rename to "purchase_prices"
[0m06:08:31.085595 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:08:31.168095 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: COMMIT
[0m06:08:31.171022 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m06:08:31.173747 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: COMMIT
[0m06:08:31.189246 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m06:08:31.218696 [debug] [Thread-1 (]: Applying DROP to: "amn_datawarehouse"."public"."purchase_prices__dbt_backup"
[0m06:08:31.243647 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.purchase_prices"
[0m06:08:31.246538 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.purchase_prices"} */
drop table if exists "amn_datawarehouse"."public"."purchase_prices__dbt_backup" cascade
[0m06:08:31.255538 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m06:08:31.267231 [debug] [Thread-1 (]: On model.amn_dbt.purchase_prices: Close
[0m06:08:31.278327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad4ef032-32f8-4858-a418-c28a2f6414c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fced67fa150>]}
[0m06:08:31.286022 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.purchase_prices ....................... [[32mSELECT 0[0m in 0.54s]
[0m06:08:31.291323 [debug] [Thread-1 (]: Finished running node model.amn_dbt.purchase_prices
[0m06:08:31.295688 [debug] [Thread-1 (]: Began running node model.amn_dbt.sales
[0m06:08:31.300136 [info ] [Thread-1 (]: 2 of 4 START sql table model public.sales ...................................... [RUN]
[0m06:08:31.304182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.amn_dbt.purchase_prices, now model.amn_dbt.sales)
[0m06:08:31.308109 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.sales
[0m06:08:31.318822 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.sales"
[0m06:08:31.336712 [debug] [Thread-1 (]: Began executing node model.amn_dbt.sales
[0m06:08:31.351425 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.sales"
[0m06:08:31.366131 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m06:08:31.368864 [debug] [Thread-1 (]: On model.amn_dbt.sales: BEGIN
[0m06:08:31.371788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:08:31.399059 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m06:08:31.404555 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m06:08:31.408811 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */

  
    

  create  table "amn_datawarehouse"."public"."sales__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    inventoryid,
    store,
    salesdescription AS SalesDescription, 
    salesprice,
    brand
FROM public.sales
  );
  
[0m06:08:31.421310 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m06:08:31.439212 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m06:08:31.445410 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */
alter table "amn_datawarehouse"."public"."sales" rename to "sales__dbt_backup"
[0m06:08:31.450668 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:08:31.470547 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m06:08:31.474580 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */
alter table "amn_datawarehouse"."public"."sales__dbt_tmp" rename to "sales"
[0m06:08:31.481293 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:08:31.490290 [debug] [Thread-1 (]: On model.amn_dbt.sales: COMMIT
[0m06:08:31.494482 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m06:08:31.501657 [debug] [Thread-1 (]: On model.amn_dbt.sales: COMMIT
[0m06:08:31.510448 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m06:08:31.524140 [debug] [Thread-1 (]: Applying DROP to: "amn_datawarehouse"."public"."sales__dbt_backup"
[0m06:08:31.529267 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.sales"
[0m06:08:31.532898 [debug] [Thread-1 (]: On model.amn_dbt.sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.sales"} */
drop table if exists "amn_datawarehouse"."public"."sales__dbt_backup" cascade
[0m06:08:31.539281 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m06:08:31.547337 [debug] [Thread-1 (]: On model.amn_dbt.sales: Close
[0m06:08:31.551848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad4ef032-32f8-4858-a418-c28a2f6414c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fced4516ff0>]}
[0m06:08:31.556842 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.sales ................................. [[32mSELECT 0[0m in 0.25s]
[0m06:08:31.566055 [debug] [Thread-1 (]: Finished running node model.amn_dbt.sales
[0m06:08:31.573635 [debug] [Thread-1 (]: Began running node model.amn_dbt.profit_and_margin
[0m06:08:31.578643 [info ] [Thread-1 (]: 3 of 4 START sql table model public.profit_and_margin .......................... [RUN]
[0m06:08:31.585712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.amn_dbt.sales, now model.amn_dbt.profit_and_margin)
[0m06:08:31.594378 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.profit_and_margin
[0m06:08:31.615177 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.profit_and_margin"
[0m06:08:31.633371 [debug] [Thread-1 (]: Began executing node model.amn_dbt.profit_and_margin
[0m06:08:31.651354 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.profit_and_margin"
[0m06:08:31.673467 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m06:08:31.678248 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: BEGIN
[0m06:08:31.682230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:08:31.704859 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m06:08:31.708043 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m06:08:31.714925 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.profit_and_margin"} */

  
    

  create  table "amn_datawarehouse"."public"."profit_and_margin__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    s.InventoryId,
    s.Store,
    s.SalesDescription, 
    s.SalesPrice,
    COALESCE(p.PurchasePrice, 0) AS PurchasePrice,
    (s.SalesPrice - COALESCE(p.PurchasePrice, 0)) AS Profit,
    (s.SalesPrice - COALESCE(p.PurchasePrice, 0)) / NULLIF(s.SalesPrice, 0) * 100 AS ProfitMargin
FROM 
    "amn_datawarehouse"."public"."sales" AS s 
LEFT JOIN 
    "amn_datawarehouse"."public"."purchase_prices" AS p
    ON s.Brand = p.Brand
  );
  
[0m06:08:31.729972 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.010 seconds
[0m06:08:31.749664 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m06:08:31.754826 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.profit_and_margin"} */
alter table "amn_datawarehouse"."public"."profit_and_margin" rename to "profit_and_margin__dbt_backup"
[0m06:08:31.766407 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m06:08:31.793046 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m06:08:31.808787 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.profit_and_margin"} */
alter table "amn_datawarehouse"."public"."profit_and_margin__dbt_tmp" rename to "profit_and_margin"
[0m06:08:31.854056 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m06:08:31.865791 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: COMMIT
[0m06:08:31.872618 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m06:08:31.880449 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: COMMIT
[0m06:08:31.889957 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m06:08:31.938890 [debug] [Thread-1 (]: Applying DROP to: "amn_datawarehouse"."public"."profit_and_margin__dbt_backup"
[0m06:08:31.945810 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.profit_and_margin"
[0m06:08:31.955940 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.profit_and_margin"} */
drop table if exists "amn_datawarehouse"."public"."profit_and_margin__dbt_backup" cascade
[0m06:08:31.989980 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.023 seconds
[0m06:08:32.020253 [debug] [Thread-1 (]: On model.amn_dbt.profit_and_margin: Close
[0m06:08:32.031079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad4ef032-32f8-4858-a418-c28a2f6414c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fced1a8c9b0>]}
[0m06:08:32.054264 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.profit_and_margin ..................... [[32mSELECT 0[0m in 0.45s]
[0m06:08:32.064124 [debug] [Thread-1 (]: Finished running node model.amn_dbt.profit_and_margin
[0m06:08:32.072706 [debug] [Thread-1 (]: Began running node model.amn_dbt.least_profitability
[0m06:08:32.078923 [info ] [Thread-1 (]: 4 of 4 START sql table model public.least_profitability ........................ [RUN]
[0m06:08:32.085971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.amn_dbt.profit_and_margin, now model.amn_dbt.least_profitability)
[0m06:08:32.097415 [debug] [Thread-1 (]: Began compiling node model.amn_dbt.least_profitability
[0m06:08:32.143970 [debug] [Thread-1 (]: Writing injected SQL for node "model.amn_dbt.least_profitability"
[0m06:08:32.168418 [debug] [Thread-1 (]: Began executing node model.amn_dbt.least_profitability
[0m06:08:32.183482 [debug] [Thread-1 (]: Writing runtime sql for node "model.amn_dbt.least_profitability"
[0m06:08:32.220203 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.least_profitability"
[0m06:08:32.230624 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: BEGIN
[0m06:08:32.234214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:08:32.258207 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m06:08:32.262574 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.least_profitability"
[0m06:08:32.265639 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.least_profitability"} */

  
    

  create  table "amn_datawarehouse"."public"."least_profitability__dbt_tmp"
  
  
    as
  
  (
    WITH profit_data AS (
    SELECT 
        InventoryId,
        Store,
        SalesDescription,
        SalesPrice,
        PurchasePrice,
        Profit,
        ProfitMargin
    FROM "amn_datawarehouse"."public"."profit_and_margin"
)
SELECT 
    InventoryId,
    Store,
    SalesDescription,
    SalesPrice,
    PurchasePrice,
    Profit,
    ProfitMargin
FROM 
    profit_data
ORDER BY 
    Profit ASC
LIMIT 10
  );
  
[0m06:08:32.275762 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m06:08:32.291019 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.least_profitability"
[0m06:08:32.294064 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.least_profitability"} */
alter table "amn_datawarehouse"."public"."least_profitability" rename to "least_profitability__dbt_backup"
[0m06:08:32.298080 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:08:32.308154 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.least_profitability"
[0m06:08:32.310927 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.least_profitability"} */
alter table "amn_datawarehouse"."public"."least_profitability__dbt_tmp" rename to "least_profitability"
[0m06:08:32.313798 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:08:32.319553 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: COMMIT
[0m06:08:32.321730 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.least_profitability"
[0m06:08:32.323928 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: COMMIT
[0m06:08:32.333254 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m06:08:32.342203 [debug] [Thread-1 (]: Applying DROP to: "amn_datawarehouse"."public"."least_profitability__dbt_backup"
[0m06:08:32.346062 [debug] [Thread-1 (]: Using postgres connection "model.amn_dbt.least_profitability"
[0m06:08:32.348602 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.amn_dbt.least_profitability"} */
drop table if exists "amn_datawarehouse"."public"."least_profitability__dbt_backup" cascade
[0m06:08:32.354488 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m06:08:32.359155 [debug] [Thread-1 (]: On model.amn_dbt.least_profitability: Close
[0m06:08:32.362828 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad4ef032-32f8-4858-a418-c28a2f6414c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fced1aa99a0>]}
[0m06:08:32.365776 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.least_profitability ................... [[32mSELECT 0[0m in 0.28s]
[0m06:08:32.369055 [debug] [Thread-1 (]: Finished running node model.amn_dbt.least_profitability
[0m06:08:32.373799 [debug] [MainThread]: Using postgres connection "master"
[0m06:08:32.376906 [debug] [MainThread]: On master: BEGIN
[0m06:08:32.379452 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:08:32.395146 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m06:08:32.398252 [debug] [MainThread]: On master: COMMIT
[0m06:08:32.400830 [debug] [MainThread]: Using postgres connection "master"
[0m06:08:32.402890 [debug] [MainThread]: On master: COMMIT
[0m06:08:32.405268 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:08:32.408045 [debug] [MainThread]: On master: Close
[0m06:08:32.411190 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:08:32.413178 [debug] [MainThread]: Connection 'model.amn_dbt.least_profitability' was properly closed.
[0m06:08:32.415375 [info ] [MainThread]: 
[0m06:08:32.417542 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 2.47 seconds (2.47s).
[0m06:08:32.424742 [debug] [MainThread]: Command end result
[0m06:08:32.509721 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m06:08:32.522122 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m06:08:32.546943 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m06:08:32.549622 [info ] [MainThread]: 
[0m06:08:32.553280 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:08:32.557435 [info ] [MainThread]: 
[0m06:08:32.561310 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m06:08:32.567940 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.778587, "process_in_blocks": "100504", "process_kernel_time": 3.824595, "process_mem_max_rss": "106516", "process_out_blocks": "0", "process_user_time": 13.431735}
[0m06:08:32.571152 [debug] [MainThread]: Command `dbt run` succeeded at 06:08:32.570508 after 6.78 seconds
[0m06:08:32.574182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fced67f1df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fced5e37980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fced343cec0>]}
[0m06:08:32.578125 [debug] [MainThread]: Flushing usage events
[0m06:08:33.503899 [debug] [MainThread]: An error was encountered while trying to flush usage events
